(function(){"use strict";var __webpack_modules__={1078:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4645),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),vuex__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3937);__webpack_exports__.A={name:"ControlesCards",data(){return{searchQuery:""}},computed:{...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.L8)("fiches",["allFiches","allParametresFiches","fichesControlCount","showMenu","settings","info","compo"]),...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.L8)("formules",["allCompositions"]),controlCount(){return this.fichesControlCount},filteredFichesControle(){return this.allFiches.filter((e=>!0===e.attente_controle))},filteredFiches(){return this.searchQuery?this.filteredFichesControle.filter((e=>e.prep.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase())||e.id.toString().startsWith(this.searchQuery.toLowerCase())||e.patient.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.filteredFichesControle}},created(){this.loadFiches(),this.loadFormules(),this.loadCompositions(),this.loadParametresFiches()},methods:{...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.i0)("fiches",["loadFiches","loadParametresFiches","toggleInfo","toggleSettings","toggleCompo","toggleControle","toggleMenu","toggleDestruction"]),...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.i0)("formules",["loadCompositions","loadFormules"]),getCalculatedQty(formula,params,qte,unitMeasureString){for(let t of params){let e=t.parametre.nom+" - "+t.parametre.unite;formula=formula.replace(new RegExp(e,"g"),t.valeur_parametre);let o="Quantité - "+unitMeasureString;formula=formula.replace(new RegExp(o,"g"),qte)}try{let result=eval(formula);return isNaN(result)?result:Number(result).toFixed(2)}catch(e){return"Erreur"}},filteredParametres(e){return this.allParametresFiches.filter((t=>t.num_fiche===e))},filteredCompositions(e){return this.allCompositions.filter((t=>t.num_formule===e))},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/fiche/${e}`)}}}},1458:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4645),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),vuex__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3937);__webpack_exports__.A={name:"demandesCards",data(){return{searchQuery:"",repeat:""}},computed:{...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.L8)("demandes",["allDemandes","allParametresDemandes","settings","showMenu","expanded","compo","repeatDialog"]),...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.L8)("dateFormatter",["getFormattedDate"]),...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.L8)("formules",["allCompositions"]),controlCount(){return this.filteredDemandesAttente.length},filteredDemandesAttente(){return this.allDemandes.filter((e=>!1===e.production))},filteredDemandes(){return this.searchQuery?this.filteredDemandesAttente.filter((e=>e.prep.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase())||e.service.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.filteredDemandesAttente}},created(){this.loadDemandes(),this.loadParametresDemandes(),this.loadCompositions()},methods:{...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.i0)("demandes",["loadDemandes","loadParametresDemandes","deleteDemande","toggleInfo","toggleMenu","toggleProduction","toggleSettings","toggleCompo","stopRepeat","toggleRepeat","addRepeat"]),...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.i0)("dateFormatter",["formatDate"]),...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.i0)("formules",["loadCompositions","loadFormules"]),getCalculatedQty(formula,params,qte,unitMeasureString){for(let t of params){let e=t.parametre.nom+" - "+t.parametre.unite;formula=formula.replace(new RegExp(e,"g"),t.valeur_parametre);let o="Quantité - "+unitMeasureString;formula=formula.replace(new RegExp(o,"g"),qte)}try{let result=eval(formula);return isNaN(result)?result:Number(result).toFixed(2)}catch(e){return"Erreur"}},filteredParametres(e){return this.allParametresDemandes.filter((t=>t.num_demande===e))},filteredCompositions(e){return this.allCompositions.filter((t=>t.num_formule===e))},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/supplier/${e}`)}}}},7151:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4645),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),vuex__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3937);__webpack_exports__.A={name:"FichesArchivesCards",data(){return{searchQuery:""}},computed:{...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.L8)("fiches",["allFiches","allParametresFiches","fichesControlCount","showMenu","settings","info","compo"]),...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.L8)("formules",["allCompositions"]),controlCount(){return this.filteredFiches.length},filteredFichesControle(){return this.allFiches.filter((e=>!0===e.controle_valide))},filteredFiches(){return this.searchQuery?this.filteredFichesControle.filter((e=>e.prep.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase())||e.id.toString().startsWith(this.searchQuery.toLowerCase())||e.patient.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.filteredFichesControle}},created(){this.loadFiches(),this.loadFormules(),this.loadCompositions(),this.loadParametresFiches()},methods:{...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.i0)("fiches",["loadFiches","loadParametresFiches","toggleInfo","toggleSettings","toggleCompo","toggleControle","toggleMenu"]),...(0,vuex__WEBPACK_IMPORTED_MODULE_1__.i0)("formules",["loadCompositions","loadFormules"]),getCalculatedQty(formula,params,qte,unitMeasureString){for(let t of params){let e=t.parametre.nom+" - "+t.parametre.unite;formula=formula.replace(new RegExp(e,"g"),t.valeur_parametre);let o="Quantité - "+unitMeasureString;formula=formula.replace(new RegExp(o,"g"),qte)}try{let result=eval(formula);return isNaN(result)?result:Number(result).toFixed(2)}catch(e){return"Erreur"}},filteredParametres(e){return this.allParametresFiches.filter((t=>t.num_fiche===e))},filteredCompositions(e){return this.allCompositions.filter((t=>t.num_formule===e))},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/supplier/${e}`)}}}},8094:function(e,t,o){var a=o(9798),l=o(4220);const s={key:0,class:"center-container"};function i(e,t,o,a,i,r){const n=(0,l.g2)("ParticlesAnimated"),c=(0,l.g2)("font-awesome-icon"),u=(0,l.g2)("q-toolbar-title"),d=(0,l.g2)("q-toolbar"),p=(0,l.g2)("NavBar"),m=(0,l.g2)("q-header"),f=(0,l.g2)("q-btn"),h=(0,l.g2)("router-link"),b=(0,l.g2)("router-view"),g=(0,l.g2)("UserHelper"),k=(0,l.g2)("ContactForm"),_=(0,l.g2)("q-page"),v=(0,l.g2)("q-page-container"),y=(0,l.g2)("FooterBar"),F=(0,l.g2)("q-footer"),w=(0,l.g2)("q-layout");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(n),(0,l.bF)(w,{view:"lHh Lpr lFf"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"q-mt-sm q-ml-sm",style:{position:"fixed",top:"0",left:"0",right:"0","z-index":"1000"}},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.bF)(c,{icon:"fa-solid fa-mortar-pestle",size:"xl",color:"#ffb74d"})]),(0,l.bF)(u,{class:"text-cyan-4",style:{"max-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.eW)("PPH")])),_:1})])),_:1}),e.isLoggedIn?((0,l.uX)(),(0,l.Wv)(m,{key:0,style:{"z-index":"6000"}},{default:(0,l.k6)((()=>[(0,l.bF)(p)])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[r.shouldDisplayButton?((0,l.uX)(),(0,l.CE)("div",s,[(0,l.bF)(h,{to:"/login"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{outline:"",size:"xxl",color:"cyan-4",class:"hover-effect",icon:"start"},{default:(0,l.k6)((()=>[(0,l.eW)(" Start")])),_:1})])),_:1})])):(0,l.Q3)("",!0),(0,l.bF)(b),e.isLoggedIn?((0,l.uX)(),(0,l.Wv)(g,{key:1})):(0,l.Q3)("",!0),(0,l.bF)(k)])),_:1})])),_:1}),e.isLoggedIn?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(F,{key:1,style:{"z-index":"6000"}},{default:(0,l.k6)((()=>[(0,l.bF)(y)])),_:1}))])),_:1})],64)}const r=(0,l.Lk)("div",{id:"particles-js"},null,-1),n=[r];function c(e,t,o,a,s,i){return(0,l.uX)(),(0,l.CE)("div",null,n)}var u=o(3937);o(8693);const d=window.particlesJS;var p={name:"ParticlesAnimated",computed:{...(0,u.aH)("auth",["isLoggedIn"])},watch:{isLoggedIn:"loadParticlesConfig"},mounted(){this.loadParticlesConfig()},methods:{loadParticlesConfig(){const e=this.isLoggedIn?"/particlesjs-config.json":"/guest-particlesjs-config.json";d.load("particles-js",e,(function(){console.log("Particles.js config loaded")}))}}},m=o(1317);const f=(0,m.A)(p,[["render",c]]);var h=f;function b(e,t,o,a,s,i){const r=(0,l.g2)("font-awesome-icon"),n=(0,l.g2)("router-link"),c=(0,l.g2)("q-toolbar-title"),u=(0,l.g2)("FichierBtn"),d=(0,l.g2)("PlanificationBtn"),p=(0,l.g2)("FabricationBtn"),m=(0,l.g2)("TracabiliteBtn"),f=(0,l.g2)("GestionBtn"),h=(0,l.g2)("q-btn-group"),b=(0,l.g2)("q-space"),g=(0,l.g2)("q-btn"),k=(0,l.g2)("q-toolbar");return(0,l.uX)(),(0,l.Wv)(k,{class:"q-pa-md row",style:{"background-color":"#1a2946 !important",opacity:"0.8 !important"}},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/home/"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{icon:"fa-solid fa-mortar-pestle","beat-fade":"",size:"xl",color:i.tokenColor},null,8,["color"])])),_:1}),(0,l.bF)(c,{class:"text-cyan-4",style:{"max-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.eW)("PPH")])),_:1}),(0,l.bF)(h,{flat:""},{default:(0,l.k6)((()=>[(0,l.bF)(u),(0,l.bF)(d),(0,l.bF)(p),(0,l.bF)(m),(0,l.bF)(f)])),_:1}),(0,l.bF)(b),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(g,{flat:"",size:"sm",color:"cyan-4",onClick:e.toggleFullscreen,icon:"minimize"},null,8,["onClick"]),(0,l.bF)(g,{flat:"",size:"sm",color:"cyan-4",onClick:e.toggleFullscreen,icon:"crop_square"},null,8,["onClick"]),e.isLoggedIn?((0,l.uX)(),(0,l.Wv)(g,{key:0,flat:"",size:"sm",color:"orange-4",onClick:e.logout,icon:"logout"},null,8,["onClick"])):(0,l.Q3)("",!0),e.isLoggedIn?((0,l.uX)(),(0,l.Wv)(g,{key:1,flat:"",size:"sm",color:"red-4",onClick:e.close,icon:"close"},null,8,["onClick"])):(0,l.Q3)("",!0)])),_:1})])),_:1})}var g=o(7700);function k(e,t,o,a,s,i){const r=(0,l.g2)("q-item-section"),n=(0,l.g2)("router-link"),c=(0,l.g2)("q-item"),u=(0,l.g2)("q-separator"),d=(0,l.g2)("q-icon"),p=(0,l.g2)("q-list"),m=(0,l.g2)("q-menu"),f=(0,l.g2)("q-btn"),h=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(f,{class:(0,g.C4)({"text-cyan-1":!s.menuOpen,"text-cyan-4":s.menuOpen,"hover-effect":!0}),flat:"",label:"Fichier"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{"transition-show":"jump-down","transition-hide":"jump-up",onShow:t[2]||(t[2]=e=>s.menuOpen=!0),onHide:i.resetMenu},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"bg-blue-grey-4",dense:"",style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"pph-link",to:`/user/${e.userId}`},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Mon compte")])),_:1})])),_:1},8,["to"])])),_:1})),[[h]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"pph-link",to:"/users/"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Utilisateurs")])),_:1})])),_:1})])),_:1})),[[h]]),(0,l.bF)(u),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen,"text-cyan-4":s.submenuOpen,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Paramètres")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(d,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(m,{anchor:"top end",self:"top start",onShow:t[0]||(t[0]=e=>s.submenuOpen=!0),onHide:t[1]||(t[1]=e=>s.submenuOpen=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"pph-link",to:"/etablissement/"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Etablissement")])),_:1})])),_:1})])),_:1})),[[h]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"pph-link",to:"/unites-soin/"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Unités de soin")])),_:1})])),_:1})])),_:1})),[[h]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"pph-link",to:"/users/"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Utilisateurs")])),_:1})])),_:1})])),_:1})),[[h]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"pph-link",to:"/vpph-settings/"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("V-PPH")])),_:1})])),_:1})])),_:1})),[[h]])])),_:1})])),_:1})])),_:1}),(0,l.bF)(u),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{onClick:i.resetApp,class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Réinitialisation")])),_:1},8,["onClick"])])),_:1})),[[h]]),(0,l.bF)(u),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{class:"logout",clickable:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"logout-text text-red-5"},{default:(0,l.k6)((()=>[(0,l.eW)("Fermer")])),_:1})])),_:1})),[[h]])])),_:1})])),_:1},8,["onHide"])])),_:1},8,["class"])])}var _={name:"FichierBtn",data(){return{menuOpen:!1,submenuOpen:!1}},computed:{...(0,u.aH)("auth",{userId:e=>e.user.id})},methods:{...(0,u.i0)("resetData",["resetData"]),resetMenu(){this.menuOpen=!1,this.submenuOpen=!1},resetApp(){console.log("ResetApp"),this.resetData()}}},v=o(6046),y=o(7334),F=o(3117),w=o(8070),C=o(3787),L=o(2596),x=o(3870),A=o(3178),q=o(2110),E=o.n(q);const I=(0,m.A)(_,[["render",k]]);var P=I;function S(e,t,o,a,s,i){const r=(0,l.g2)("q-item-section"),n=(0,l.g2)("router-link"),c=(0,l.g2)("q-item"),u=(0,l.g2)("q-list"),d=(0,l.g2)("q-menu"),p=(0,l.g2)("q-btn"),m=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(p,{class:(0,g.C4)({"text-cyan-1":!s.menuOpen,"text-cyan-4":s.menuOpen,"hover-effect":!0}),flat:"",label:"Planification"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{"transition-show":"jump-down","transition-hide":"jump-up",onShow:t[0]||(t[0]=e=>s.menuOpen=!0),onHide:t[1]||(t[1]=e=>s.menuOpen=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4",dense:"",style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/demande/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Nouvelle demande")])),_:1})])),_:1})])),_:1})),[[m]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/demandes/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Demandes en attentes")])),_:1})])),_:1})])),_:1})),[[m]])])),_:1})])),_:1})])),_:1},8,["class"])])}E()(_,"components",{QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QSeparator:L.A,QIcon:x.A}),E()(_,"directives",{ClosePopup:A.A});var V={name:"PlanificationBtn",data(){return{menuOpen:!1}}};const Q=(0,m.A)(V,[["render",S]]);var M=Q;function T(e,t,o,a,s,i){const r=(0,l.g2)("q-item-section"),n=(0,l.g2)("router-link"),c=(0,l.g2)("q-item"),u=(0,l.g2)("q-list"),d=(0,l.g2)("q-menu"),p=(0,l.g2)("q-btn"),m=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(p,{class:(0,g.C4)({"text-cyan-1":!s.menuOpen,"text-cyan-4":s.menuOpen,"hover-effect":!0}),flat:"",label:"Fabrication"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{"transition-show":"jump-down","transition-hide":"jump-up",onShow:t[0]||(t[0]=e=>s.menuOpen=!0),onHide:t[1]||(t[1]=e=>s.menuOpen=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4",dense:"",style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/fiches/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Fiche de fabrication")])),_:1})])),_:1})])),_:1})),[[m]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/controles/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Libération")])),_:1})])),_:1})])),_:1})),[[m]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/archives/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Terminées")])),_:1})])),_:1})])),_:1})),[[m]])])),_:1})])),_:1})])),_:1},8,["class"])])}E()(V,"components",{QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A}),E()(V,"directives",{ClosePopup:A.A});var W={name:"FabricationBtn",data(){return{menuOpen:!1}}};const D=(0,m.A)(W,[["render",T]]);var R=D;function U(e,t,o,a,s,i){const r=(0,l.g2)("q-item-section"),n=(0,l.g2)("q-icon"),c=(0,l.g2)("q-item"),u=(0,l.g2)("q-list"),d=(0,l.g2)("q-menu"),p=(0,l.g2)("q-btn"),m=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(p,{class:(0,g.C4)({"text-cyan-1":!s.menuOpen,"text-cyan-4":s.menuOpen,"hover-effect":!0}),flat:"",label:"Tracabilite"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{"transition-show":"jump-down","transition-hide":"jump-up",onShow:t[4]||(t[4]=e=>s.menuOpen=!0),onHide:i.resetMenu},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4",dense:"",style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen,"text-cyan-4":s.submenuOpen,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Certificats d'analyse")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(n,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(d,{anchor:"top end",self:"top start",onShow:t[0]||(t[0]=e=>s.submenuOpen=!0),onHide:t[1]||(t[1]=e=>s.submenuOpen=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect-2"},{default:(0,l.k6)((()=>[(0,l.eW)("Télécharger")])),_:1})])),_:1})),[[m]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect-2"},{default:(0,l.k6)((()=>[(0,l.eW)("Rechercher")])),_:1})])),_:1})),[[m]])])),_:1})])),_:1})])),_:1}),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Ordonnancier")])),_:1})])),_:1})),[[m]]),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen2,"text-cyan-4":s.submenuOpen2,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Historiques")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(n,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(d,{anchor:"top end",self:"top start",onShow:t[2]||(t[2]=e=>s.submenuOpen2=!0),onHide:t[3]||(t[3]=e=>s.submenuOpen2=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect-2"},{default:(0,l.k6)((()=>[(0,l.eW)("Patient")])),_:1})])),_:1})),[[m]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect-2"},{default:(0,l.k6)((()=>[(0,l.eW)("Matière première")])),_:1})])),_:1})),[[m]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect-2"},{default:(0,l.k6)((()=>[(0,l.eW)("Préparation")])),_:1})])),_:1})),[[m]])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onHide"])])),_:1},8,["class"])])}E()(W,"components",{QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A}),E()(W,"directives",{ClosePopup:A.A});var N={name:"TracabiliteBtn",data(){return{menuOpen:!1,submenuOpen:!1,submenuOpen2:!1}},methods:{resetMenu(){this.menuOpen=!1,this.submenuOpen=!1,this.submenuOpen2=!1}}};const X=(0,m.A)(N,[["render",U]]);var O=X;function j(e,t,o,a,s,i){const r=(0,l.g2)("q-item-section"),n=(0,l.g2)("router-link"),c=(0,l.g2)("q-item"),u=(0,l.g2)("q-icon"),d=(0,l.g2)("q-list"),p=(0,l.g2)("q-menu"),m=(0,l.g2)("q-btn"),f=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(m,{class:(0,g.C4)({"text-cyan-1":!s.menuOpen,"text-cyan-4":s.menuOpen,"hover-effect":!0}),flat:"",label:"Gestion"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{"transition-show":"jump-down","transition-hide":"jump-up",onShow:t[14]||(t[14]=e=>s.menuOpen=!0),onHide:i.resetMenu},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-4",dense:"",style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/suppliers/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Fournisseurs")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen7,"text-cyan-4":s.submenuOpen7,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Matériel")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(p,{anchor:"top end",self:"top start",onShow:t[0]||(t[0]=e=>s.submenuOpen7=!0),onHide:t[1]||(t[1]=e=>s.submenuOpen7=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/materiel/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Matériel")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/appareils/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Appareils")])),_:1})])),_:1})])),_:1})),[[f]])])),_:1})])),_:1})])),_:1}),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen,"text-cyan-4":s.submenuOpen,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Mat.premières")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(p,{anchor:"top end",self:"top start",onShow:t[2]||(t[2]=e=>s.submenuOpen=!0),onHide:t[3]||(t[3]=e=>s.submenuOpen=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/creation-matiere-premiere/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Créer")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/matieres-premieres/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Préparatoire")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/catalogue/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Catalogue")])),_:1})])),_:1})])),_:1})),[[f]])])),_:1})])),_:1})])),_:1}),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen2,"text-cyan-4":s.submenuOpen2,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Formules")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(p,{anchor:"top end",self:"top start",onShow:t[4]||(t[4]=e=>s.submenuOpen2=!0),onHide:t[5]||(t[5]=e=>s.submenuOpen2=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/nouvelle-formule/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Créer")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/formules/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Formules référencées")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("PPH-Cloud")])),_:1})])),_:1})),[[f]])])),_:1})])),_:1})])),_:1}),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!e.submenuOpen8,"text-cyan-4":e.submenuOpen8,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Controles")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(p,{anchor:"top end",self:"top start",onShow:t[6]||(t[6]=t=>e.submenuOpen8=!0),onHide:t[7]||(t[7]=t=>e.submenuOpen8=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:{name:"CreateControles"},class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Créer")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:{name:"ControlesCards"},class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Contrôles disponibles")])),_:1})])),_:1})])),_:1})),[[f]])])),_:1})])),_:1})])),_:1}),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen4,"text-cyan-4":s.submenuOpen4,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Stock")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(p,{anchor:"top end",self:"top start",onShow:t[8]||(t[8]=e=>s.submenuOpen4=!0),onHide:t[9]||(t[9]=e=>s.submenuOpen4=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/stock-preparatoire/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Péparatoire")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/commande/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Commandes")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/reception/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Livraisons")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/reception/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Historique des livraisons")])),_:1})])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{to:"/reception/",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Inventaire")])),_:1})])),_:1})])),_:1})),[[f]])])),_:1})])),_:1})])),_:1}),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen6,"text-cyan-4":s.submenuOpen6,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Tarification")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(p,{anchor:"top end",self:"top start",onShow:t[10]||(t[10]=e=>s.submenuOpen6=!0),onHide:t[11]||(t[11]=e=>s.submenuOpen6=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Paramètres")])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Générer facture")])),_:1})])),_:1})),[[f]])])),_:1})])),_:1})])),_:1}),(0,l.bF)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:(0,g.C4)({"text-cyan-1":!s.submenuOpen5,"text-cyan-4":s.submenuOpen5,"hover-effect":!0})},{default:(0,l.k6)((()=>[(0,l.eW)("Statistiques")])),_:1},8,["class"]),(0,l.bF)(r,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{name:"keyboard_arrow_right"})])),_:1}),(0,l.bF)(p,{anchor:"top end",self:"top start",onShow:t[12]||(t[12]=e=>s.submenuOpen5=!0),onHide:t[13]||(t[13]=e=>s.submenuOpen5=!1)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Bilan")])),_:1})])),_:1})),[[f]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(c,{clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"text-cyan-1 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Requêtes")])),_:1})])),_:1})),[[f]])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onHide"])])),_:1},8,["class"])])}E()(N,"components",{QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QIcon:x.A}),E()(N,"directives",{ClosePopup:A.A});var $={name:"GestionBtn",data(){return{menuOpen:!1,submenuOpen:!1,submenuOpen2:!1,submenuOpen3:!1,submenuOpen4:!1,submenuOpen5:!1,submenuOpen6:!1,submenuOpen7:!1}},methods:{resetMenu(){this.menuOpen=!1,this.submenuOpen=!1,this.submenuOpen2=!1,this.submenuOpen3=!1,this.submenuOpen4=!1,this.submenuOpen5=!1,this.submenuOpen6=!1,this.submenuOpen7=!1}}};const B=(0,m.A)($,[["render",j]]);var H=B;E()($,"components",{QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QIcon:x.A}),E()($,"directives",{ClosePopup:A.A});var z={components:{FichierBtn:P,PlanificationBtn:M,FabricationBtn:R,TracabiliteBtn:O,GestionBtn:H},computed:{...(0,u.aH)("screen",["isFullscreen"]),...(0,u.aH)("auth",["isLoggedIn"]),...(0,u.aH)("auth",["tokenStatus"]),tokenColor(){switch(this.tokenStatus){case"valid":default:return"#81c784";case"nearExpiry":return"#ffb74d";case"nearInvalid":return"#e57373"}}},methods:{...(0,u.i0)("auth",["logout"]),...(0,u.i0)("screen",["toggleFullscreen"])}},G=o(3364),K=o(4260),Y=o(1181),J=o(2742);const Z=(0,m.A)(z,[["render",b]]);var ee=Z;E()(z,"components",{QToolbar:G.A,QToolbarTitle:K.A,QBtnGroup:Y.A,QSpace:J.A,QBtn:v.A});const te=e=>((0,l.Qi)("data-v-648e772e"),e=e(),(0,l.jt)(),e),oe={class:"row justify-center"},ae={class:"justify-center"},le=te((()=>(0,l.Lk)("div",{color:"cyan-1",class:"q-mx-sm inline-block"},"|",-1))),se=te((()=>(0,l.Lk)("div",{color:"cyan-1",class:"q-mx-sm inline-block"},"|",-1))),ie=te((()=>(0,l.Lk)("div",{color:"cyan-1",class:"q-mx-sm inline-block"},"|",-1)));function re(e,t,o,a,s,i){const r=(0,l.g2)("router-link"),n=(0,l.g2)("q-footer");return(0,l.uX)(),(0,l.Wv)(n,{class:"bg-blue-grey-3"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",oe,[(0,l.Lk)("div",ae,[(0,l.bF)(r,{to:"cgu/",class:"hover-effect pph-link text-cyan-1"},{default:(0,l.k6)((()=>[(0,l.eW)("CGU")])),_:1}),le,(0,l.bF)(r,{to:"mentions/",class:"hover-effect pph-link text-cyan-1"},{default:(0,l.k6)((()=>[(0,l.eW)("Mentions légales")])),_:1}),se,(0,l.bF)(r,{to:"cookies/",class:"hover-effect pph-link text-cyan-1"},{default:(0,l.k6)((()=>[(0,l.eW)("Politique cookies")])),_:1}),ie,(0,l.bF)(r,{to:"confidential/",class:"hover-effect pph-link text-cyan-1"},{default:(0,l.k6)((()=>[(0,l.eW)("Politique de confidentialité")])),_:1})])])])),_:1})}var ne={name:"FooterBar"},ce=o(2270);const ue=(0,m.A)(ne,[["render",re],["__scopeId","data-v-648e772e"]]);var de=ue;function pe(e,t,o,a,s,i){const r=(0,l.g2)("q-fab-action"),n=(0,l.g2)("router-link"),c=(0,l.g2)("q-fab");return(0,l.uX)(),(0,l.Wv)(c,{glossy:"",class:"btn-cyan-pph",icon:"help",direction:"left"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{flat:"","external-label":"","label-position":"top",label:"Contact",color:"cyan-4",onClick:i.toggleForm,icon:"contact_support"},null,8,["onClick"]),(0,l.bF)(r,{flat:"","external-label":"","label-position":"top",label:"Tutoriel",color:"cyan-4",onClick:i.onClick,icon:"play_lesson"},null,8,["onClick"]),(0,l.bF)(n,{to:"/gpt4-api/"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{flat:"","external-label":"","label-position":"top",label:"V-PPH",color:"purple-4",icon:"3p"})])),_:1})])),_:1})}E()(ne,"components",{QFooter:ce.A});var me={name:"UserHelper",computed:{...(0,u.aH)("contact",["showForm"])},methods:{toggleForm(){this.$store.commit("contact/SET_SHOW_FORM",!this.showForm)},onClick(){}}},fe=o(3408),he=o(3674);const be=(0,m.A)(me,[["render",pe],["__scopeId","data-v-094a9d0b"]]);var ge=be;E()(me,"components",{QFab:fe.A,QFabAction:he.A});const ke=e=>((0,l.Qi)("data-v-79c99abe"),e=e(),(0,l.jt)(),e),_e=ke((()=>(0,l.Lk)("span",{class:"text-cyan-4"},"Contactez-nous !",-1))),ve={class:"row justify-center"};function ye(e,t,o,a,s,i){const r=(0,l.g2)("q-toolbar-title"),n=(0,l.g2)("q-btn"),c=(0,l.g2)("q-toolbar"),u=(0,l.g2)("q-input"),d=(0,l.g2)("q-form"),p=(0,l.g2)("q-card-section"),m=(0,l.g2)("q-card"),f=(0,l.g2)("q-dialog"),h=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(f,{modelValue:i.showForm,"onUpdate:modelValue":t[1]||(t[1]=e=>i.showForm=e),persistent:""},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,null,{default:(0,l.k6)((()=>[(0,l.bF)(r,null,{default:(0,l.k6)((()=>[_e])),_:1}),(0,l.bo)((0,l.bF)(n,{flat:"",round:"",icon:"close",class:"hover-effect"},null,512),[[h]])])),_:1}),(0,l.bF)(p,{class:"q-pt-none"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{onSubmit:i.submitForm},{default:(0,l.k6)((()=>[(0,l.bF)(u,{modelValue:i.message,"onUpdate:modelValue":t[0]||(t[0]=e=>i.message=e),label:"Message",icon:"message",required:""},null,8,["modelValue"]),(0,l.Lk)("div",ve,[(0,l.bF)(n,{glossy:"",rounded:"",class:"btn-grey-success-pph q-my-sm",icon:"send",type:"submit"})])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var Fe={computed:{...(0,u.aH)("contact",["contactData"]),...(0,u.L8)("auth",["user"]),message:{get(){return this.contactData.message},set(e){this.$store.commit("contact/SET_CONTACT_DATA",{...this.contactData,message:e})}},showForm:{get(){return this.$store.state.contact.showForm},set(e){this.$store.commit("contact/SET_SHOW_FORM",e)}}},methods:{...(0,u.i0)("contact",["submitContactForm"]),async submitForm(){let e={name:this.user.firstName+" "+this.user.lastName,email:this.user.email,message:this.message};await this.submitContactForm(e)}}},we=o(5505),Ce=o(7422),Le=o(3507),xe=o(8506),Ae=o(9468);const qe=(0,m.A)(Fe,[["render",ye],["__scopeId","data-v-79c99abe"]]);var Ee=qe;E()(Fe,"components",{QDialog:we.A,QCard:Ce.A,QToolbar:G.A,QToolbarTitle:K.A,QBtn:v.A,QCardSection:Le.A,QForm:xe.A,QInput:Ae.A}),E()(Fe,"directives",{ClosePopup:A.A});var Ie={name:"App",data(){return{interval:null,intentionalLogout:!1}},components:{ParticlesAnimated:h,NavBar:ee,FooterBar:de,UserHelper:ge,ContactForm:Ee},computed:{...(0,u.aH)("auth",["isLoggedIn"]),shouldDisplayButton(){return"/"===this.$route.path}},methods:{handleFullscreenChange(){document.fullscreenElement?this.$store.commit("screen/SET_FULLSCREEN",!0):this.$store.commit("screen/SET_FULLSCREEN",!1)},...(0,u.i0)("auth",["checkAuthentication"])},created(){this.isLoggedIn&&(this.checkAuthentication(),this.interval=setInterval(this.checkAuthentication,6e4))},watch:{isLoggedIn(e){e&&!this.interval?this.interval=setInterval(this.checkAuthentication,6e4):!e&&this.interval&&(clearInterval(this.interval),this.interval=null)}},mounted(){document.addEventListener("fullscreenchange",this.handleFullscreenChange)},beforeUnmount(){document.removeEventListener("fullscreenchange",this.handleFullscreenChange),clearInterval(this.interval)}},Pe=o(58),Se=o(9986),Ve=o(6671),Qe=o(9326);const Me=(0,m.A)(Ie,[["render",i]]);var Te=Me;E()(Ie,"components",{QLayout:Pe.A,QToolbar:G.A,QToolbarTitle:K.A,QHeader:Se.A,QPageContainer:Ve.A,QPage:Qe.A,QBtn:v.A,QFooter:ce.A});var We=o(5220),De=(o(4645),o(6597)),Re=o(2830),Ue=o.n(Re);let Ne;Ne="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:8000":"https://pph-backend-4f4fd8d99c88.herokuapp.com/";const Xe=De.A.create({baseURL:Ne,withCredentials:!0}),Oe=()=>{const e=document.cookie.split("; ").find((e=>e.startsWith("refresh_token")));return e?e.split("=")[1]:null},je=(e,t,o)=>{var a="";if(o){var l=new Date;l.setTime(l.getTime()+24*o*60*60*1e3),a="; expires="+l.toUTCString()}document.cookie=e+"="+(t||"")+a+"; path=/"},$e=()=>{je("access_token","",-1),je("refresh_token","",-1)},Be=async e=>{try{const t=await Xe.post("/api/token/refresh/",{refresh:e});if(t.data&&t.data.access)return document.cookie=`access_token=${t.data.access}`,t.data.access}catch(t){return null}};Xe.interceptors.response.use((e=>e),(async e=>{if(e.response&&401===e.response.status){const t=e.config,o=Oe();if(!t._retry&&o){t._retry=!0;const e=await Be(o);if(e)return t.headers["Authorization"]=`Bearer ${e}`,Xe(t)}$e()}return Promise.reject(e)})),Xe.interceptors.request.use((e=>e.data&&e.data.isTrusted?new Promise((()=>{})):e)),Xe.getUserData=function(){return this.get("PPH/current_user/")},Xe.interceptors.request.use((e=>(Ue().start(),e))),Xe.interceptors.response.use((e=>(Ue().done(),e)),(e=>(Ue().done(),Promise.reject(e))));var He=Xe;const ze=()=>({suppliers:[],showMenu:{},expanded:{},currentSupplier:null}),Ge={allSuppliers:e=>e.suppliers,showMenu:e=>e.showMenu,expanded:e=>e.expanded,currentSupplier:e=>e.currentSupplier},Ke={async addSupplier({dispatch:e},{formData:t,url:o}){try{return await He.post(o,t),e("notifications/showNotification",{message:"Fournisseur ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return e("notifications/showNotification",{message:"Erreur lors de l'ajout du fournisseur",type:"error"},{root:!0}),Promise.reject(a)}},async loadSuppliersBalances({commit:e,dispatch:t}){try{const t=await He.get("/PPH/balances-suppliers");e("SET_SUPPLIERS",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des fournisseurs",type:"error"},{root:!0}),console.error(o)}},async updateSupplier({dispatch:e},{id:t,formData:o}){try{return console.log("formDataRecu : ",o),await He.patch(`PPH/suppliers/${t}/`,o),e("loadSuppliers"),e("notifications/showNotification",{message:"Fournisseur modifié",type:"success"},{root:!0}),Promise.resolve()}catch(a){return e("notifications/showNotification",{message:"Erreur lors de la modification du fournisseur",type:"error"},{root:!0}),Promise.reject(a)}},async getSupplierById(e){let t=null;return await He.get(`PPH/suppliers/${e}`).then((e=>{t=e.data})).catch((e=>console.error(e))),t},async fetchSupplierById(e){try{const t=await He.get(`PPH/suppliers/${e}`);return t}catch(t){throw console.error("Erreur lors de la récupération du fournisseur:",t),t}},async loadSuppliers({commit:e,dispatch:t}){try{const t=await He.get("/PPH/suppliers");e("SET_SUPPLIERS",t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des fournisseurs",type:"error"},{root:!0}),console.error(o)}},async toggleActivation({dispatch:e},t){const{supplierId:o,isActive:a}=t;try{a?(await He.patch(`/PPH/suppliers/${o}/`,{is_activate:!1}),e("notifications/showNotification",{message:"Fournisseur désactivé",type:"success"},{root:!0})):(await He.patch(`/PPH/suppliers/${o}/`,{is_activate:!0}),e("notifications/showNotification",{message:"Fournisseur activé",type:"success"},{root:!0})),e("loadSuppliers")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},async deleteSupplier({dispatch:e},t){try{await He.delete(`/PPH/suppliers/${t}`),e("notifications/showNotification",{message:"Fournisseur supprimé",type:"success"},{root:!0}),e("loadSuppliers")}catch(o){e("notifications/showNotification",{message:"Erreur lors de la suppression",type:"error"},{root:!0}),console.error(o)}},toggleMenu({commit:e},t){e("TOGGLE_MENU",t)},toggleInfo({commit:e},t){e("TOGGLE_INFO",t)},getSupplier({commit:e},t){return He.get(`/PPH/suppliers/${t}`).then((t=>(e("SET_CURRENT_SUPPLIER",t.data),t.data)))}},Ye={ADD_SUPPLIER(e,t){e.suppliers.push(t)},SET_SUPPLIERS(e,t){e.suppliers=t},TOGGLE_MENU(e,t){e.showMenu[t]=!e.showMenu[t]},TOGGLE_INFO(e,t){e.expanded[t]=!e.expanded[t]},SET_CURRENT_SUPPLIER(e,t){e.currentSupplier=t}};var Je={namespaced:!0,state:ze,getters:Ge,actions:Ke,mutations:Ye};const Ze=()=>({users:[],functions:[],showMenu:{},expanded:{},currentUser:null}),et={allFunctions:e=>e.functions,allUsers:e=>e.users,showMenu:e=>e.showMenu,expanded:e=>e.expanded,currentUser:e=>e.currentUser},tt={async addUser({dispatch:e},t){try{return await He.post("PPH/users/",t),e("notifications/showNotification",{message:"Utilisateur ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de l'utilisateur.",type:"error"},{root:!0}),Promise.reject(o)}},async updateUser({dispatch:e},{id:t,formData:o}){try{return console.log("formDataRecu",o),await He.patch(`PPH/users/${t}/`,o,{headers:{"Content-Type":"multipart/form-data"}}),e("notifications/showNotification",{message:"Utilisateur modifié",type:"success"},{root:!0}),Promise.resolve()}catch(a){return e("notifications/showNotification",{message:"Erreur lors de la modification de l'utilisateur.",type:"error"},{root:!0}),Promise.reject(a)}},async fetchUserById(e){try{const t=await He.get(`PPH/users/${e}`);return t}catch(t){throw console.error("Erreur lors de la récupération de l'utilisateur:",t),t}},async loadUsers({commit:e,dispatch:t}){try{const t=await He.get("/PPH/users"),o=t.data,a={},l={};o.forEach((e=>{a[e.id]=!1,l[e.id]=!1})),e("SET_USERS",o),e("INIT_MENU",a),e("INIT_INFO",l)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des utilisateurs",type:"error"},{root:!0}),console.error(o)}},async loadFunctions({commit:e,dispatch:t}){try{const t=await He.get("/PPH/user-functions"),o=t.data;e("SET_FUNCTIONS",o)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des utilisateurs",type:"error"},{root:!0}),console.error(o)}},async toggleActivation({dispatch:e},t){const{userId:o,isActive:a}=t;try{a?(await He.patch(`/PPH/users/${o}/`,{is_active:!1}),e("notifications/showNotification",{message:"Utilisateur désactivé",type:"success"},{root:!0})):(await He.patch(`/PPH/users/${o}/`,{is_active:!0}),e("notifications/showNotification",{message:"Utiliisateur activé",type:"success"},{root:!0})),e("loadUsers")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},async deleteUser({dispatch:e},t){try{await He.delete(`/PPH/users/${t}`),e("notifications/showNotification",{message:"Utilisateur supprimé",type:"success"},{root:!0}),e("loadUsers")}catch(o){e("notifications/showNotification",{message:"Erreur lors de la suppression",type:"error"},{root:!0}),console.error(o)}},toggleMenu({commit:e},t){e("TOGGLE_MENU",t)},toggleInfo({commit:e},t){e("TOGGLE_INFO",t)},getUser({commit:e},t){return He.get(`/PPH/users/${t}`).then((t=>(e("SET_CURRENT_USER",t.data),t.data)))}},ot={ADD_USER(e,t){e.users.push(t)},SET_USERS(e,t){e.users=t,t.forEach((t=>{e.showMenu={...e.showMenu,[t.id]:!1},e.expanded={...e.expanded,[t.id]:!1}}))},SET_FUNCTIONS(e,t){e.functions=t},TOGGLE_MENU(e,t){e.showMenu[t]=!e.showMenu[t]},TOGGLE_INFO(e,t){e.expanded[t]=!e.expanded[t]},SET_CURRENT_USER(e,t){e.currentUser=t},INIT_MENU(e,t){e.showMenu=t},INIT_INFO(e,t){e.expanded=t}};var at={namespaced:!0,state:Ze,getters:et,actions:tt,mutations:ot},lt=o(3123);const st={showNotification(e,t){let o={};switch(t.type){case"success":o={color:"green-3",icon:"announcement"};break;case"error":o={color:"red-3",icon:"warning"};break;case"info":o={color:"blue-3",icon:"info"};break}lt.A.create({message:t.message,...o,timeout:t.time?t.time:5e3,position:t.position?t.position:"top-right",...t.options})},async showNotificationsSeq({dispatch:e},t){for(const o of t)await new Promise((t=>{e("showNotification",o),setTimeout(t,2e3)}))},showNotificationBackend(e,t){let o={};switch(t.type){case"success":o={color:"green-3",icon:"announcement"};break;case"error":o={color:"red-3",icon:"warning"};break;case"info":o={color:"blue-3",icon:"info"};break}const a=lt.A.create({message:t.message,...o,timeout:5e3,position:"top-right",...t.options});lt.A.emitter.$emit("notification-displayed",a)}};var it={namespaced:!0,actions:st};const rt=()=>({showForm:!1,contactData:{name:"",email:"",message:""}}),nt=rt(),ct={SET_SHOW_FORM(e,t){e.showForm=t},SET_CONTACT_DATA(e,t){console.log("Updating contactData with payload:",t),e.contactData=t}},ut={toggleForm({commit:e},t){e("SET_SHOW_FORM",t)},async submitContactForm({commit:e,dispatch:t},o){try{let a=await He.post("PPH/contact/",o);return e("SET_CONTACT_DATA",rt().contactData),t("notifications/showNotification",{type:"success",message:"Votre message a bien été envoyé !"},{root:!0}),a}catch(a){console.error("There was an error submitting the contact form:",a),t("notifications/showNotification",{type:"error",message:"Une erreur est survenue lors de l'envoi de votre message. Veuillez réessayer plus tard."},{root:!0})}}};var dt={namespaced:!0,state:nt,mutations:ct,actions:ut};const pt={isLoggedIn:!1,user:{id:null,firstName:null,lastName:null,email:null,function:null},tokenStatus:null},mt={SET_IS_LOGGED_IN(e,t){e.isLoggedIn=t},SET_USER_DATA(e,t){e.user=t},LOGOUT(e){e.isLoggedIn=!1,e.user={firstName:null,lastName:null,email:null,function:null}},SET_TOKEN_STATUS(e,t){e.tokenStatus=t}},ft={requireAuth({dispatch:e,state:t},o){return async(a,l,s)=>{await e("checkAuthentication"),t.isLoggedIn?s():(await e("notifications/showNotification",{message:"Vous devez vous connecter pour accéder à cette page !",type:"info"},{root:!0}),s(o))}},async login({commit:e,dispatch:t},o){try{this.intentionalLogout=!1;let t=await He.post("/api/token/",o);console.log(t.data);let l=await He.get("/PPH/current_user/");e("SET_USER_DATA",l.data),e("SET_IS_LOGGED_IN",!0);try{await document.documentElement.requestFullscreen()}catch(a){console.error("Erreur lors de la demande de mode plein écran:",a)}return!0}catch(l){l.response&&401===l.response.status?t("notifications/showNotification",{message:"Aucun compte actif pour ces identifiants.",type:"error"},{root:!0}):t("notifications/showNotification",{message:"Une erreur est survenue. Veuillez réessayer plus tard ou contatez un administrateur.",type:"error"},{root:!0}),console.error(l);let e=l.response?.data?.detail||"Échec de la connexion. Veuillez vérifier vos identifiants et réessayer.";throw e}},async logout({commit:e,dispatch:t}){try{const o=await He.post("/logout/");if(this.intentionalLogout=!0,200!==o.status)throw new Error("Erreur lors de la déconnexion.");e("LOGOUT"),e("SET_IS_LOGGED_IN",!1),t("notifications/showNotification",{message:"Vous êtes déconnecté !",type:"success"},{root:!0}),Ok.push({name:"Login"}),(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen())}catch(o){console.error("Une erreur s'est produite lors de la déconnexion :",o),t("notifications/showNotification",{message:`Erreur lors de la déconnexion : ${o.message}`,type:"error"},{root:!0})}},async checkAuthentication({commit:e,dispatch:t}){if(!this.intentionalLogout)try{const o=await He.get("PPH/current_user/"),a=o.data;if(a)if(e("SET_USER_DATA",a),e("SET_IS_LOGGED_IN",!0),void 0!==a.tokenExpiry&&null!==a.tokenExpiry){const o=a.tokenExpiry;o<=600&&o>540?(e("SET_TOKEN_STATUS","nearExpiry"),t("notifications/showNotification",{message:"Votre session expirera dans 10 minutes !",type:"info"},{root:!0})):o<=540&&o>60?e("SET_TOKEN_STATUS","nearExpiry"):o<=300&&o>240?(e("SET_TOKEN_STATUS","nearInvalid"),t("notifications/showNotification",{message:"Votre session expirera dans 5 minutes !",type:"info"},{root:!0})):o<=240&&o>60?e("SET_TOKEN_STATUS","nearInvalid"):o<=60?(e("SET_TOKEN_STATUS","invalid"),e("LOGOUT"),Ok.push({name:"Login"}),t("notifications/showNotification",{message:"Votre session a expiré !",type:"info"},{root:!0}),(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen())):e("SET_TOKEN_STATUS","valid")}else e("SET_TOKEN_STATUS","valid");else e("SET_TOKEN_STATUS","invalid"),e("SET_IS_LOGGED_IN",!1)}catch(o){o.response&&401===o.response.status?(e("SET_TOKEN_STATUS","invalid"),e("SET_IS_LOGGED_IN",!1),t("notifications/showNotification",{message:"L'authentification est invalide ou a expiré !",type:"error"},{root:!0})):(console.error("Erreur lors de la vérification du token:",o),t("notifications/showNotification",{message:"Erreur lors de la vérification du token !",type:"error"},{root:!0}))}}};var ht={namespaced:!0,state:pt,mutations:mt,actions:ft};const bt={user:{firstName:null,lastName:null,email:null,userName:null,function:null},isSubmitting:!1},gt={SET_USER_DATA(e,t){e.user=t},UPDATE_FIELD(e,{field:t,value:o}){e.user[t]=o},SET_SUBMITTING(e,t){e.isSubmitting=t}},kt={async fetchUserData({commit:e,dispatch:t}){try{let t=await He.getUserData();e("SET_USER_DATA",t.data)}catch(o){console.error("Erreur lors de la récupération des données de l'utilisateur :",o),t("notifications/showNotification",{type:"error",message:"Une erreur est survenue lors de la récupération de vos données. Veuillez réessayer plus tard."},{root:!0})}},async updateUser({commit:e,state:t,dispatch:o}){e("SET_SUBMITTING",!0);try{await He.post("PPH/user/update/",t.user),o("notifications/showNotification",{message:"Utilisateur enregistré !",type:"success"},{root:!0})}catch(a){}finally{e("SET_SUBMITTING",!1)}}},_t={user:e=>e.user};var vt={state:bt,mutations:gt,actions:kt,getters:_t};const yt={error:null},Ft={SET_ERROR(e,t){e.error=t}},wt={ApiError({commit:e,dispatch:t},o){let a=o.response?.data?.detail||"Une erreur est survenue.";e("SET_ERROR",a),t("notifications/showNotification",{message:a,type:"error"},{root:!0})},async fetchData({commit:e,dispatch:t},o){try{await He.get(o)}catch(a){let o=a.response?.data?.detail||"Une erreur est survenue.";e("SET_ERROR",o),t("notifications/showNotification",{message:o,type:"error"},{root:!0})}}};var Ct={namespaced:!0,state:yt,mutations:Ft,actions:wt};const Lt={isFullscreen:!1},xt={SET_FULLSCREEN(e,t){e.isFullscreen=t}},At={toggleFullscreen({commit:e,state:t}){t.isFullscreen?(document.exitFullscreen(),e("SET_FULLSCREEN",!1)):(document.documentElement.requestFullscreen(),e("SET_FULLSCREEN",!0))}};var qt={namespaced:!0,state:Lt,mutations:xt,actions:At};const Et={userFormData:{last_name:"",first_name:"",user_name:"",email:""},anotherFormData:{field1:"",field2:""}},It={UPDATE_FIELD(e,{formName:t,field:o,value:a}){e[t]&&(e[t][o]=a)}},Pt={updateField({commit:e},{formName:t,field:o,value:a}){e("UPDATE_FIELD",{formName:t,field:o,value:a})}};var St={namespaced:!0,state:Et,mutations:It,actions:Pt};const Vt=!0;let Qt;Qt=Vt?"wss://pph-backend-4f4fd8d99c88.herokuapp.com/ws/notifications/":"ws://localhost:8001/ws/notifications/";var Mt=Qt;const Tt=()=>({receptions:[],cdts:[],formes:[],types:[],unites:[],matieres:[],categoriesMatieres:[],importsCatalogue:[],matieresCatalogue:[],showMenu:{},expanded:{},currentMatiere:null,loadingMatieres:!1}),Wt={loadingMatieres(e){return e.loadingMatieres},allCdts:e=>e.cdts,allFormes:e=>e.formes,allUnites:e=>e.unites,allTypes:e=>e.types,allMatieres:e=>e.matieres,allReceptions:e=>e.receptions,allCategories:e=>e.categoriesMatieres,allImports:e=>e.importsCatalogue,allMatieresCatalogue:e=>e.matieresCatalogue,showMenu:e=>e.showMenu,expanded:e=>e.expanded,currentMatiere:e=>e.currentMatiere,showMenuMat:e=>e.menuMat,matieresCdeCount:e=>{const t=e.matieres.filter((e=>e.cde));return t.length},matieresLivraisonCount:e=>e.matieres.filter((e=>e.attente_livraison)).length},Dt={async addMatiere({dispatch:e,commit:t},o){try{const a=await He.post("PPH/matieres-premieres/",o),l=a.data;return t("ADD_MATIERE",l),e("notifications/showNotification",{message:"Matière première ajoutée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de la matière première",type:"error"},{root:!0}),Promise.reject(a)}},async addReception({dispatch:e,commit:t},o){try{const a=await He.post("PPH/reception/",o,{headers:{"Content-Type":"multipart/form-data"}}),l=a.data;return t("ADD_RECEPTION",l),e("notifications/showNotification",{message:"Réception ajoutée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de la réception",type:"error"},{root:!0}),Promise.reject(a)}},async addCertificat({dispatch:e},{formData:t,id:o}){try{return await He.patch(`PPH/reception/${o}/`,t,{headers:{"Content-Type":"multipart/form-data"}}),e("notifications/showNotification",{message:"Modifications ajoutée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return e("notifications/showNotification",{message:"Erreur lors de la modification",type:"error"},{root:!0}),Promise.reject(a)}},async addType({dispatch:e},t){try{return await He.post("PPH/types-matieres/",t),e("notifications/showNotification",{message:"Type ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout du type de matière première",type:"error"},{root:!0}),Promise.reject(o)}},async addCdt({dispatch:e},t){try{return await He.post("PPH/conditionnement/",t),e("notifications/showNotification",{message:"Conditionnement ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout du conditionnement",type:"error"},{root:!0}),Promise.reject(o)}},async addForme({dispatch:e},t){try{return await He.post("PPH/formes/",t),e("notifications/showNotification",{message:"Forme ajoutée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de la forme de matière première",type:"error"},{root:!0}),Promise.reject(o)}},async addImport({dispatch:e,commit:t},o){return new Promise(((a,l)=>{const s=new WebSocket(Mt);e("spinner/showSpinner",null,{root:!0}),s.onopen=()=>{He.post("PPH/catalogue-import/",o,{headers:{"Content-Type":"multipart/form-data"}}).then((()=>{t("RESET_MATIERES_CATALOGUE"),e("notifications/showNotification",{message:"Demande terminée",type:"success"},{root:!0}),e("spinner/hideSpinner",null,{root:!0}),a()})).catch((t=>{e("spinner/hideSpinner",null,{root:!0}),e("notifications/showNotification",{message:"Impossible d'initialiser l'import",type:"error"},{root:!0}),l(t)})),s.addEventListener("message",(t=>{const o=JSON.parse(t.data);o.notification&&o.notification.message?e("notifications/showNotification",{message:o.notification.message,type:o.notification.notification_type},{root:!0}):e("notifications/showNotification",{message:"Format de notification inattendu",type:"error"},{root:!0})}))}}))},async fetchMatierePremiereById(e){try{const t=await He.get(`PPH/matieres-premieres/${e}`);return t}catch(t){throw console.error("Erreur lors de la récupération de la matière première:",t),t}},async loadMatieresPremieres({commit:e,dispatch:t}){try{console.log("Chargement des matières premières");const t=await He.get("/PPH/matieres-premieres");e("SET_MATIERES",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des matières premières",type:"error"},{root:!0}),console.error(o)}},async loadReceptions({commit:e,dispatch:t}){try{console.log("Chargement des réceptions");const t=await He.get("/PPH/reception");e("SET_RECEPTIONS",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des réceptions",type:"error"},{root:!0}),console.error(o)}},async loadCategoriesMatieres({commit:e,dispatch:t}){try{console.log("Chargement des catégories de matières premières");const t=await He.get("/PPH/categories");e("SET_CATEGORIES",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des catégories matières premières",type:"error"},{root:!0}),console.error(o)}},async loadMatieresPremieresCatalogue({commit:e,dispatch:t}){try{e("SET_LOADING_MATIERES",!0),console.log("Chargement des matières premières");const t=await He.get("/PPH/catalogue");e("SET_MATIERES_CATALOGUE",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des matières premières",type:"error"},{root:!0}),console.error(o)}finally{e("SET_LOADING_MATIERES",!1)}},async loadUnites({commit:e,dispatch:t}){try{const t=await He.get("/PPH/unites-mesure");e("SET_UNITES",t.data),console.log("unites",t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des unités",type:"error"},{root:!0}),console.error(o)}},async loadFormes({commit:e,dispatch:t}){try{const t=await He.get("/PPH/formes");e("SET_FORMES",t.data),console.log("formes",t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des unités",type:"error"},{root:!0}),console.error(o)}},async loadTypes({commit:e,dispatch:t}){try{const t=await He.get("/PPH/types-matieres");e("SET_TYPES",t.data),console.log("types",t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des unités",type:"error"},{root:!0}),console.error(o)}},async loadCdt({commit:e,dispatch:t}){try{const t=await He.get("/PPH/conditionnement");e("SET_CDT",t.data),console.log("cdt",t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des conditionnements",type:"error"},{root:!0}),console.error(o)}},async toggleActivation({dispatch:e},t){const{matiereId:o,isStockee:a}=t;try{a?(await He.patch(`/PPH/matieres-premieres/${o}/`,{stockee:!1}),e("notifications/showNotification",{message:"Matière première rétirée du stock",type:"success"},{root:!0})):(await He.patch(`/PPH/matieres-premieres/${o}/`,{stockee:!0}),e("notifications/showNotification",{message:"Matière première stockée",type:"success"},{root:!0})),e("loadMatieresPremieres")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},async toggleCde({dispatch:e},t){const{matiereId:o,matiereName:a,isCde:l}=t;try{l?(await He.patch(`/PPH/matieres-premieres/${o}/`,{cde:!1}),e("notifications/showNotification",{message:`${a} retirée de la liste de commande`,type:"success"},{root:!0})):(await He.patch(`/PPH/matieres-premieres/${o}/`,{cde:!0}),e("notifications/showNotification",{message:`${a} ajoutée à la liste de commande`,type:"success"},{root:!0})),e("loadMatieresPremieres")}catch(s){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(s)}},async toggleLivraison({dispatch:e},t){const{matiereId:o,isLivraison:a}=t;try{a?(await He.patch(`/PPH/matieres-premieres/${o}/`,{attente_livraison:!1,cde:!0}),e("notifications/showNotification",{message:"Matière première en attente de commande",type:"success"},{root:!0})):(await He.patch(`/PPH/matieres-premieres/${o}/`,{attente_livraison:!0,cde:!1}),e("notifications/showNotification",{message:"Matière première en attente de livraison",type:"success"},{root:!0})),e("loadMatieresPremieres")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},async deleteMatiere({dispatch:e},t){console.log("deleteMatiere appelée avec l'ID :",t);try{await He.delete(`/PPH/matieres-premieres/${t}`),e("notifications/showNotification",{message:"Matière première supprimée",type:"success"},{root:!0}),e("loadMatieresPremieres")}catch(o){e("notifications/showNotification",{message:"Erreur lors de la suppression",type:"error"},{root:!0}),console.error(o)}},toggleMenu({commit:e},t){e("TOGGLE_MENU",t)},toggleInfo({commit:e},t){e("TOGGLE_INFO",t)},toggleMenuMat({commit:e}){e("SET_MENU_MAT",!this.state.menuMat)},getMatiere({commit:e},t){return He.get(`/PPH/matieres-premieres/${t}`).then((t=>(e("SET_CURRENT_MATIERE",t.data),t.data)))}},Rt={ADD_CDT(e,t){e.cdts.push(t)},ADD_MATIERE(e,t){e.matieres.push(t)},ADD_TYPE(e,t){e.type.push(t)},ADD_FORME(e,t){e.forme.push(t)},ADD_IMPORT(e,t){e.importsCatalogue.push(t)},ADD_RECEPTION(e,t){e.receptions.push(t)},SET_LOADING_MATIERES(e,t){e.loadingMatieres=t},RESET_MATIERES_CATALOGUE(e){e.matieresCatalogue=[]},SET_MENU_MAT(e,t){e.menuMat=t},SET_MATIERES(e,t){e.matieres=t},SET_RECEPTIONS(e,t){e.receptions=t},SET_CATEGORIES(e,t){e.categoriesMatieres=t},SET_MATIERES_CATALOGUE(e,t){e.matieresCatalogue=t},SET_UNITES(e,t){e.unites=t},SET_TYPES(e,t){e.types=t},SET_CDT(e,t){e.cdts=t},SET_FORMES(e,t){e.formes=t},TOGGLE_MENU(e,t){e.showMenu[t]=!e.showMenu[t]},TOGGLE_INFO(e,t){e.expanded[t]=!e.expanded[t]},SET_CURRENT_MATIERE(e,t){e.currentMatiere=t}};var Ut={namespaced:!0,state:Tt,getters:Wt,actions:Dt,mutations:Rt};const Nt=()=>({types:[],parametres:[],parametresFormules:[],articlesFormules:[],compositions:[],formules:[],listes:[],showMenu:{},expanded:{},compo:{},settings:{},currentFormuleId:null}),Xt={compo:e=>e.compo,settings:e=>e.settings,expanded:e=>e.expanded,showMenu:e=>e.showMenu,allTypesPrep:e=>e.types,allCompositions:e=>e.compositions,allParametres:e=>e.parametres,allParametresFormules:e=>e.parametresFormules,allArticlesFormules:e=>e.articlesFormules,allFormules:e=>e.formules,allListes:e=>e.listes},Ot={async updateArticles({commit:e,dispatch:t},{formData:o,formuleId:a}){try{const l=await He.put(`PPH/articles-formules/update/${a}/`,o,{headers:{"Content-Type":"application/json"}});return e("SET_ARTICLES_FORMULES",l.data),t("notifications/showNotification",{message:"Articles modifiés avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(l){return t("notifications/showNotification",{message:"Erreur lors de la modification des articles",type:"error"},{root:!0}),Promise.reject(l)}},async updateParametres({dispatch:e},t){try{return console.log("reception de stateData:",t),await He.patch("PPH/parametres-formules/",t,{headers:{"Content-Type":"application/json"}}),e("loadArticlesFormules"),e("notifications/showNotification",{message:"Parametres modifiés avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de la modification des parametres",type:"error"},{root:!0}),Promise.reject(o)}},async updateFormule({dispatch:e},{formData:t,formuleId:o}){try{return await He.patch(`PPH/nouvelle-formule/${o}`,t),e("notifications/showNotification",{message:"Formule modifiée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return e("notifications/showNotification",{message:"Erreur lors de la modification de la formule",type:"error"},{root:!0}),Promise.reject(a)}},async addArticles({dispatch:e},t){try{return console.log("reception de stateData:",t),await He.post("PPH/articles-formules/",t,{headers:{"Content-Type":"application/json"}}),e("notifications/showNotification",{message:"Articles ajoutés avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout des articles",type:"error"},{root:!0}),Promise.reject(o)}},async addParametre({dispatch:e},t){try{return await He.post("PPH/parametres-prep/",t),e("loadParametres"),e("notifications/showNotification",{message:`${t.nom} créé avec succès`,type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de la création du paramètre",type:"error"},{root:!0}),Promise.reject(o)}},async addParametres({commit:e,dispatch:t},o){try{console.log("Envoi de paramData:",o);const a=await He.post("PPH/parametres-formules/",o,{headers:{"Content-Type":"application/json"}});return e("SET_PARAMETRES_FORMULES",a.data),t("notifications/showNotification",{message:"Paramètres ajoutés avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return t("notifications/showNotification",{message:"Erreur lors de l'ajout des paramètres",type:"error"},{root:!0}),Promise.reject(a)}},async addFormule({dispatch:e},t){try{return await He.post("PPH/nouvelle-formule/",t),e("notifications/showNotification",{message:"Formule crée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de la formule",type:"error"},{root:!0}),Promise.reject(o)}},async addComposition({dispatch:e},t){try{return await He.post("PPH/composition/",t),e("notifications/showNotification",{message:"Composition ajoutée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de la composition",type:"error"},{root:!0}),Promise.reject(o)}},async getCompositionsForFormule({dispatch:e},t){try{const e=await He.get(`PPH/composition/filter/${t}`);return Promise.resolve(e.data)}catch(o){return e("notifications/showNotification",{message:"Erreur lors de la récupération des compositions existantes",type:"error"},{root:!0}),Promise.reject(o)}},async loadCompositions({commit:e,dispatch:t}){try{const t=await He.get("/PPH/composition");e("SET_COMPOSITIONS",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des compositions",type:"error"},{root:!0}),console.error(o)}},async loadFormules({commit:e,dispatch:t}){try{const t=await He.get("/PPH/formules");e("SET_FORMULES",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des formules",type:"error"},{root:!0}),console.error(o)}},async loadListes({commit:e,dispatch:t}){try{const t=await He.get("/PPH/liste");e("SET_LISTE",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des listes",type:"error"},{root:!0}),console.error(o)}},async loadTypes({commit:e,dispatch:t}){try{const t=await He.get("/PPH/type-prep");e("SET_TYPE",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des types de préparations",type:"error"},{root:!0}),console.error(o)}},async loadArticlesFormules({commit:e,dispatch:t}){try{const t=await He.get("/PPH/articles-formules");e("SET_ARTICLES_FORMULES",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des articles",type:"error"},{root:!0}),console.error(o)}},async loadParametresFormules({commit:e,dispatch:t}){try{const t=await He.get("/PPH/parametres-formules");e("SET_PARAMETRES_FORMULES",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des paramètres",type:"error"},{root:!0}),console.error(o)}},async loadParametres({commit:e,dispatch:t}){try{const t=await He.get("/PPH/parametres-prep");e("SET_PARAMETRE",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des paramètres",type:"error"},{root:!0}),console.error(o)}},async toggleActivation({dispatch:e},t){const{formuleId:o,isActive:a}=t;try{a?(await He.patch(`/PPH/formules/${o}/`,{is_activate:!1}),e("notifications/showNotification",{message:"Formule désactivée",type:"success"},{root:!0})):(await He.patch(`/PPH/formules/${o}/`,{is_activate:!0}),e("notifications/showNotification",{message:"Formule activée",type:"success"},{root:!0})),e("loadFormules")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},async validFormule({dispatch:e},t){const{formuleId:o,isValid:a}=t;try{a?(await He.patch(`/PPH/formules/${o}/`,{is_valid:!1}),e("notifications/showNotification",{message:"Formule non-validée",type:"success"},{root:!0})):(await He.patch(`/PPH/formules/${o}/`,{is_valid:!0}),e("notifications/showNotification",{message:"Formule validée",type:"success"},{root:!0})),e("loadFormules")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},async toggleCloud({dispatch:e},t){const{formuleId:o,isCloud:a}=t;try{a?(await He.patch(`/PPH/formules/${o}/`,{cloud:!1}),e("notifications/showNotification",{message:"Formule retirée du cloud",type:"success"},{root:!0})):(await He.patch(`/PPH/formules/${o}/`,{cloud:!0}),e("notifications/showNotification",{message:"Formule ajoutée au cloud",type:"success"},{root:!0})),e("loadFormules")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},toggleMenu({commit:e},t){e("TOGGLE_MENU",t)},toggleInfo({commit:e},t){e("TOGGLE_INFO",t)},toggleCompo({commit:e},t){e("TOGGLE_COMPO",t)},toggleSettings({commit:e},t){e("TOGGLE_SETTINGS",t)}},jt={updateName(e,t){e.name=t},updateTypePrep(e,t){e.typePrep=t},ADD_TYPE(e,t){e.types.push(t)},ADD_ARTICLES_FORMULES(e,t){e.articlesFormules.push(...t)},ADD_ARTICLE(e,t){e.articlesFormules.push(t)},ADD_PARAMETRE(e,t){e.parametresFormules.push(t)},SET_COMPOSITIONS(e,t){e.compositions=t},SET_TYPE(e,t){e.types=t},SET_LISTE(e,t){e.listes=t},RESET_ARTICLES_FORMULES(e,t){e.articlesFormules=e.articlesFormules.filter((e=>e.num_formule!==t))},RESET_PARAMETRES_FORMULES(e,t){e.parametresFormules=e.parametresFormules.filter((e=>e.num_formule!==t))},REMOVE_ARTICLE(e,{num_formule:t,articleId:o}){e.articlesFormules=e.articlesFormules.filter((e=>e.num_formule!==t||e.articleId!==o))},REMOVE_PARAMETRE(e,{num_formule:t,parametreId:o}){e.parametresFormules=e.parametresFormules.filter((e=>e.num_formule!==t||e.parametreId!==o))},SET_PARAMETRE(e,t){e.parametres=t},SET_PARAMETRES_FORMULES(e,t){e.parametresFormules=t},SET_ARTICLES_FORMULES(e,t){e.articlesFormules=t},SET_FORMULES(e,t){e.formules=t},TOGGLE_MENU(e,t){e.showMenu[t]=!e.showMenu[t]},TOGGLE_INFO(e,t){e.expanded[t]=!e.expanded[t]},TOGGLE_COMPO(e,t){e.compo[t]=!e.compo[t]},TOGGLE_SETTINGS(e,t){e.settings[t]=!e.settings[t]}};var $t={namespaced:!0,state:Nt,getters:Xt,actions:Ot,mutations:jt};const Bt=()=>({etapes:[]}),Ht={allEtapes:e=>e.etapes},zt={async addEtape({commit:e,dispatch:t},o){try{return await He.post("PPH/etapes/",o),e("ADD_ETAPE",o),t("notifications/showNotification",{message:"Etape ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return t("notifications/showNotification",{message:"Erreur lors de l'ajout de l'étape",type:"error"},{root:!0}),Promise.reject(a)}},async addEtapes({dispatch:e},t){try{return await He.post("PPH/etapes/",t,{headers:{"Content-Type":"application/json"}}),e("notifications/showNotification",{message:"Ajout du mode opératoire",type:"info"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de l'étape",type:"error"},{root:!0}),Promise.reject(o)}},async loadEtapes({commit:e,dispatch:t}){try{const t=await He.get("/PPH/etapes");e("SET_ETAPES",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des étapes",type:"error"},{root:!0}),console.error(o)}}},Gt={ADD_ETAPE(e,t){e.etapes.push(t)},SET_ETAPES(e,t){e.etapes=t}};var Kt={namespaced:!0,state:Bt,getters:Ht,actions:zt,mutations:Gt};const Yt=()=>({voies:[]}),Jt={allVoies:e=>e.voies},Zt={async addVoie({dispatch:e},t){try{return await He.post("PPH/voie/",t),e("notifications/showNotification",{message:"Voie d'administration ajoutée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de la voie d'administration",type:"error"},{root:!0}),Promise.reject(o)}},async loadVoies({commit:e,dispatch:t}){try{const t=await He.get("/PPH/voie");e("SET_VOIE",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des voies",type:"error"},{root:!0}),console.error(o)}}},eo={ADD_VOIE(e,t){e.voies.push(t)},SET_VOIE(e,t){e.voies=t}};var to={namespaced:!0,state:Yt,getters:Jt,actions:Zt,mutations:eo};const oo={demandes:[],parametresDemandes:[],repeatDialog:{},showMenu:{},expanded:{},settings:{},compo:{}},ao={repeatDialog:e=>e.repeatDialog,compo:e=>e.compo,settings:e=>e.settings,expanded:e=>e.expanded,showMenu:e=>e.showMenu,allParametresDemandes:e=>e.parametresDemandes,allDemandes:e=>e.demandes,demandesDates:e=>e.demandes.map((e=>e.date_prevu)),nombreDemandes:e=>e.demandes.length,demandeProche:e=>{const t=[...e.demandes].sort(((e,t)=>new Date(e.date_prevu)-new Date(t.dat_prevu)));if(t.length>0){const e=t[0],o=new Date(e.date_prevu),a=("0"+o.getDate()).slice(-2),l=("0"+(o.getMonth()+1)).slice(-2),s=o.getFullYear(),i=`${a}/${l}/${s}`;return e.dateFormatee=i,e}return null},nombreDemandesProche:(e,t)=>{const o=t.demandeProche;if(!o)return 0;const a=e.demandes.filter((e=>new Date(e.date_prevu).getTime()===new Date(o.date_prevu).getTime()));return a.length}},lo={ApiError({dispatch:e},t){let o=t.response?.data?.detail;o&&(o=o.replace(/\[ErrorDetail\(string=/g,"").replace(/\)\s*\]/g,""),o=o.replace(/code='invalid',/g,""),o=o.replace(/code='invalid'/g,"")),e("notifications/showNotification",{message:o,type:"error"},{root:!0})},async addParametresValues({dispatch:e},t){try{return await He.post("PPH/parametres-demandes/",t,{headers:{"Content-Type":"application/json"}}),e("notifications/showNotification",{message:"Paramètres enregistrés avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout des paramètres",type:"error"},{root:!0}),e("ApiError",o),Promise.reject(o)}},async loadParametresDemandes({commit:e,dispatch:t}){try{const t=await He.get("/parametres-demandes");e("SET_PARAMETRES_DEMANDES",t.data)}catch(o){t("ApiError",o)}},async addDemande({dispatch:e},t){try{return await He.post("PPH/demandes/",t),e("notifications/showNotification",{message:"Demande enregistrée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de la demande",type:"error"},{root:!0}),e("ApiError",o),Promise.reject(o)}},async loadLastDemandeId(){try{await He.get("/PPH/demandes/dernier_id")}catch(e){console.error("Erreur lors de la récupération du dernier ID de la formule",e)}},async loadDemandes({commit:e,dispatch:t}){try{const t=await He.get("/demandes");e("SET_DEMANDES",t.data)}catch(o){t("ApiError",o)}},async deleteDemande({dispatch:e},t){try{await He.delete(`/PPH/demandes/${t}`),e("notifications/showNotification",{message:"Demande supprimée",type:"success"},{root:!0}),e("loadDemandes")}catch(o){e("notifications/showNotification",{message:"Erreur lors de la suppression",type:"error"},{root:!0}),e("ApiError",o)}},async toggleProduction({dispatch:e},t){const{demandeId:o,isProduction:a}=t;try{a?(await He.patch(`/PPH/demandes/${o}/`,{production:!1}),e("notifications/showNotification",{message:`Demande n°${o} mise en attente`,type:"success"},{root:!0})):(await He.patch(`/PPH/demandes/${o}/`,{production:!0}),e("notifications/showNotification",{message:`Demande n°${o} mise en production`,type:"success"},{root:!0})),e("loadDemandes")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),e("ApiError",l)}},async stopRepeat({dispatch:e},t){const{demandeId:o}=t;try{await He.patch(`/PPH/demandes/${o}/`,{recurence:null}),e("notifications/showNotification",{message:"Répétition annulée",type:"success"},{root:!0}),e("loadDemandes")}catch(a){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),e("ApiError",a)}},async addRepeat({dispatch:e},t){const{demandeId:o,repeatTime:a}=t;try{await He.patch(`/PPH/demandes/${o}/`,{recurence:a}),e("notifications/showNotification",{message:"Répétition ajoutée",type:"success"},{root:!0}),e("notifications/showNotification",{message:`Une demande prévue ${a} jours après chaque fiche de fabrication sera générer automatiquement`,type:"info"},{root:!0}),e("loadDemandes")}catch(l){e("notifications/showNotification",{message:"Erreur lors de l'ajout de la répétition",type:"error"},{root:!0}),e("ApiError",l)}},toggleRepeat({commit:e},t){e("TOGGLE_REPEAT",t)},toggleMenu({commit:e},t){e("TOGGLE_MENU",t)},toggleInfo({commit:e},t){e("TOGGLE_INFO",t)},toggleSettings({commit:e},t){e("TOGGLE_SETTINGS",t)},toggleCompo({commit:e},t){e("TOGGLE_COMPO",t)}},so={SET_DEMANDES:(e,t)=>{e.demandes=t},SET_PARAMETRES_DEMANDES:(e,t)=>{e.parametresDemandes=t},TOGGLE_REPEAT(e,t){e.repeatDialog[t]=!e.repeatDialog[t]},TOGGLE_MENU(e,t){e.showMenu[t]=!e.showMenu[t]},TOGGLE_INFO(e,t){e.expanded[t]=!e.expanded[t]},TOGGLE_SETTINGS(e,t){e.settings[t]=!e.settings[t]},TOGGLE_COMPO(e,t){e.compo[t]=!e.compo[t]}};var io={namespaced:!0,state:oo,getters:ao,mutations:so,actions:lo};const ro={fiches:[],parametresFiches:[],fichesSemaine:[],showMenu:{},settings:{},compo:{},info:{}},no={showMenu:e=>e.showMenu,settings:e=>e.settings,compo:e=>e.compo,info:e=>e.info,lastFicheId:e=>{const t=e.fiches.length?e.fiches[e.fiches.length-1]:null;return t?t.id:null},allParametresFiches:e=>e.parametresFiches,fichesControlCount:e=>e.fiches.filter((e=>e.attente_controle)).length,fichesControl:e=>e.fiches.filter((e=>!0===e.attente_controle)),allFiches:e=>e.fiches,fichesSemaine:e=>e.fichesSemaine.map((e=>({week:e.week,count:e.count})))},co={async addParametresValues({dispatch:e},t){try{return await He.post("PPH/parametres-fiches/",t,{headers:{"Content-Type":"application/json"}}),e("notifications/showNotification",{message:"Paramètres enregistrés avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout des paramètres",type:"error"},{root:!0}),Promise.reject(o)}},async loadParametresFiches({commit:e}){try{const t=await He.get("/parametres-fiches");e("SET_PARAMETRES_FICHES",t.data)}catch(t){console.error("Erreur lors du chargement des fiches :",t)}},async addFiche({commit:e,dispatch:t},o){try{return await He.post("PPH/fiches/",o),e("SET_FICHES"),t("notifications/showNotification",{message:"Fiche enregistrée avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return t("notifications/showNotification",{message:"Erreur lors de l'ajout de la fiche",type:"error"},{root:!0}),Promise.reject(a)}},async loadFiches({commit:e}){try{const t=await He.get("/fiches"),o=t.data,a={},l={},s={},i={};o.forEach((e=>{a[e.id]=!1,l[e.id]=!1,s[e.id]=!1,i[e.id]=!1})),e("INIT_MENU",a),e("INIT_INFO",i),e("INIT_COMPO",s),e("INIT_SETTINGS",l),e("SET_FICHES",t.data)}catch(t){console.error("Erreur lors du chargement des fiches :",t)}},async loadLastFicheId(){try{await He.get("/PPH/fiches/dernier_id")}catch(e){console.error("Erreur lors de la récupération du dernier ID de la formule",e)}},async loadFichesSemaine({commit:e}){try{const t=await He.get("/PPH/fiches-semaine");e("SET_FICHES_SEMAINES",t.data)}catch(t){console.error("Erreur lors du chargement des fiches par semaine :",t)}},async toggleControle({dispatch:e},t){const{ficheId:o,isControl:a}=t;try{a?(await He.patch(`/PPH/fiches/${o}/`,{controle_valide:!1,destruction:!0}),e("notifications/showNotification",{message:"Contrôle non validé",type:"success"},{root:!0})):(await He.patch(`/PPH/fiches/${o}/`,{controle_valide:!0,attente_controle:!1}),e("notifications/showNotification",{message:"Contrôle validé",type:"success"},{root:!0})),e("loadFiches")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},async toggleDestruction({dispatch:e},t){const{ficheId:o,isDestroy:a}=t;try{a?(await He.patch(`/PPH/fiches/${o}/`,{attente_controle:!0,destruction:!1}),e("notifications/showNotification",{message:"Fiche en attente de contrôle",type:"success"},{root:!0})):(await He.patch(`/PPH/fiches/${o}/`,{destruction:!0,attente_controle:!1}),e("notifications/showNotification",{message:"Contrôle non validé",type:"success"},{root:!0})),e("loadFiches")}catch(l){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(l)}},toggleInfo({commit:e},t){e("TOGGLE_INFO",t)},toggleMenu({commit:e},t){e("TOGGLE_MENU",t)},toggleSettings({commit:e},t){e("TOGGLE_SETTINGS",t)},toggleCompo({commit:e},t){e("TOGGLE_COMPO",t)}},uo={ADD_FICHE:(e,t)=>{e.fiches.push(t)},ADD_PARAMETRES_FICHES:(e,t)=>{e.parametresFiches.push(t)},SET_FICHES:(e,t)=>{e.fiches=t},SET_PARAMETRES_FICHES:(e,t)=>{e.parametresFiches=t},SET_FICHES_SEMAINES:(e,t)=>{e.fichesSemaine=t},TOGGLE_MENU(e,t){e.showMenu[t]=!e.showMenu[t]},TOGGLE_INFO(e,t){e.info[t]=!e.info[t]},TOGGLE_SETTINGS(e,t){e.settings[t]=!e.settings[t]},TOGGLE_COMPO(e,t){e.compo[t]=!e.compo[t]},INIT_INFO(e,t){e.info=t},INIT_MENU(e,t){e.showMenu=t},INIT_COMPO(e,t){e.compo=t},INIT_SETTINGS(e,t){e.settings=t}};var po={namespaced:!0,state:ro,getters:no,mutations:uo,actions:co};const mo={isLoading:!1},fo={SET_LOADING(e,t){e.isLoading=t}},ho={showSpinner({commit:e}){e("SET_LOADING",!0)},hideSpinner({commit:e}){e("SET_LOADING",!1)}},bo={isLoading:e=>e.isLoading};var go={namespaced:!0,state:mo,mutations:fo,actions:ho,getters:bo};const ko={socket:null},_o={SET_SOCKET(e,t){e.socket=t}},vo={initWebSocket({commit:e,dispatch:t}){const o=new WebSocket(Mt);o.onopen=()=>{console.log("WebSocket connecté")},o.onerror=e=>{console.error("WebSocket Erreur: ",e)},o.onmessage=e=>{const o=JSON.parse(e.data);o.notification&&t("notifications/showNotification",{message:o.notification.message,type:o.notification.notification_type},{root:!0})},o.onclose=()=>{console.log("WebSocket déconnecté")},e("SET_SOCKET",o)},sendMessage({state:e},t){e.socket&&e.socket.send(JSON.stringify(t))},closeWebSocket({commit:e,state:t}){t.socket&&(t.socket.close(),e("SET_SOCKET",null))}};var yo={namespaced:!0,state:ko,mutations:_o,actions:vo};const Fo={formatDate({commit:e},t){const o=Lo(t);e("SET_FORMATTED_DATE",o)}},wo={SET_FORMATTED_DATE(e,t){e.formattedDate=t}},Co={getFormattedDate:e=>e.formattedDate};function Lo(e){const[t,o,a]=e.split("-");return`${a}/${o}/${t}`}const xo={formattedDate:null};var Ao={state:xo,actions:Fo,mutations:wo,getters:Co};const qo=()=>({services:[]}),Eo={allServices:e=>e.services},Io={async addService({dispatch:e},t){try{return await He.post("PPH/service/",t),e("notifications/showNotification",{message:"Service ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout du service",type:"error"},{root:!0}),Promise.reject(o)}},async loadServices({commit:e,dispatch:t}){try{const t=await He.get("/PPH/service");e("SET_SERVICE",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des services",type:"error"},{root:!0}),console.error(o)}}},Po={ADD_SERVICE(e,t){e.services.push(t)},SET_SERVICE(e,t){e.services=t}};var So={namespaced:!0,state:qo,getters:Eo,actions:Io,mutations:Po};const Vo=()=>({epis:[],episFormules:[]}),Qo={allEpis:e=>e.epis,allEpisFormules:e=>e.episFormules},Mo={async addEpi({dispatch:e},t){try{return await He.post("PPH/epi/",t),e("notifications/showNotification",{message:"Epi ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de l'EPI",type:"error"},{root:!0}),Promise.reject(o)}},async addEpis({dispatch:e},t){try{return await He.post("PPH/epi-formules/",t),e("notifications/showNotification",{message:"Epi ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:`Erreur méthode addEpis: ${o}`,type:"error"},{root:!0}),Promise.reject(o)}},async updateEpis({dispatch:e},{formData:t,id:o}){try{return await He.put(`PPH/epi-formules/${o}/`,t),e("notifications/showNotification",{message:"Epi ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(a){return e("notifications/showNotification",{message:a,type:"error"},{root:!0}),Promise.reject(a)}},async loadEpis({commit:e,dispatch:t}){try{const t=await He.get("/PPH/epi");e("SET_EPI",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des EPI",type:"error"},{root:!0}),console.error(o)}},async loadEpisFormules({commit:e,dispatch:t}){try{const t=await He.get("/epi-formules");e("SET_EPI_FORMULES",t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des EPI",type:"error"},{root:!0}),console.error("Erreur lors du chargement des fiches :",o)}}},To={ADD_EPI(e,t){e.epis.push(t)},SET_EPI(e,t){e.epis=t},SET_EPI_FORMULES(e,t){e.episFormules=t}};var Wo={namespaced:!0,state:Vo,getters:Qo,actions:Mo,mutations:To};const Do=()=>({appareils:[],types:[],coms:[],instructionsAppareils:[],reponses:[],showMenu:{},expanded:{}}),Ro={allReponses:e=>e.reponses,allAppareils:e=>e.appareils,allTypes:e=>e.types,allComs:e=>e.coms,allInstructionsAppareils:e=>e.instructionsAppareils,showMenu:e=>e.showMenu,expanded:e=>e.expanded},Uo={async addAppareil({dispatch:e},t){try{return await He.post("PPH/appareils/",t),e("notifications/showNotification",{message:"Appareil ajouté avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout de la appareil",type:"error"},{root:!0}),Promise.reject(o)}},async loadAppareils({commit:e,dispatch:t}){try{const t=await He.get("/PPH/appareils");e("SET_APPAREILS",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des appareil",type:"error"},{root:!0}),console.error(o)}},async loadTypesAppareils({commit:e,dispatch:t}){try{const t=await He.get("/PPH/types-appareils");e("SET_TYPES_APPAREILS",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des types d'appareil",type:"error"},{root:!0}),console.error(o)}},async loadCom({commit:e,dispatch:t}){try{const t=await He.get("/PPH/type-com");e("SET_COM_APPAREILS",t.data),console.log(t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement des communications",type:"error"},{root:!0}),console.error(o)}},async loadInstructionsAppareils({commit:e,dispatch:t}){try{const t=await He.get("/instructions-appareils");e("SET_INSTRUCTIONS_APPAREILS",t.data)}catch(o){t("notifications/showNotification",{message:"Erreur lors du chargement de instructions",type:"error"},{root:!0}),console.error("Erreur lors du chargement des instructions :",o)}},async loadReponses({commit:e,dispatch:t}){try{const t=await He.get("/reponses-appareils");e("SET_REPONSES_APPAREILS",t.data)}catch(o){t("notifications/showNotification",{message:`Erreur lors du chargement des réponses: ${o}`,type:"error"},{root:!0}),console.error("Erreur lors du chargement des réponses :",o)}},async getCalibration({dispatch:e},t){try{console.log("appareil",t);const o=await He.get(`PPH/appareils/${t.id}/`),a=new Date(o.data.calibration),l=new Date;l.setDate(l.getDate()+30);const s=Math.floor((a.getTime()-l.getTime())/864e5);return a<l&&e("notifications/showNotification",{message:`La calibration expire dans ${s} jours`,type:"error"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'obtention de la date de calibration",type:"error"},{root:!0}),Promise.reject(o)}},async toggleActivation({dispatch:e},t){const{appareilId:o,isActive:a,appareilName:l}=t;try{a?(await He.patch(`/PPH/appareils/${o}/`,{is_activate:!1}),e("notifications/showNotification",{message:`${l} désactivée`,type:"success"},{root:!0})):(await He.patch(`/PPH/appareils/${o}/`,{is_activate:!0}),e("notifications/showNotification",{message:`${l} activée`,type:"success"},{root:!0})),e("loadSuppliers")}catch(s){e("notifications/showNotification",{message:"Erreur lors du changement d'état",type:"error"},{root:!0}),console.error(s)}},toggleMenu({commit:e},t){e("TOGGLE_MENU",t)},toggleInfo({commit:e},t){e("TOGGLE_INFO",t)}},No={TOGGLE_MENU(e,t){e.showMenu[t]=!e.showMenu[t]},TOGGLE_INFO(e,t){e.expanded[t]=!e.expanded[t]},ADD_APPAREIL(e,t){e.appareils.push(t)},SET_APPAREILS(e,t){e.appareils=t},SET_TYPES_APPAREILS(e,t){e.types=t},SET_COM_APPAREILS(e,t){e.coms=t},SET_INSTRUCTIONS_APPAREILS(e,t){e.instructionsAppareils=t},SET_REPONSES_APPAREILS(e,t){e.reponses=t}};var Xo={namespaced:!0,state:Do,getters:Ro,actions:Uo,mutations:No};const Oo={},jo={},$o={async resetData({dispatch:e}){try{await He.post("/PPH/reset-data/"),e("notifications/showNotification",{message:"Données réinitialisées avec succès",type:"success"},{root:!0})}catch(t){e("notifications/showNotification",{message:"Erreur lors de la réinitialisation des données",type:"error"},{root:!0}),console.error(t)}}},Bo={};var Ho={namespaced:!0,state:Oo,getters:jo,actions:$o,mutations:Bo};const zo={error:null},Go={SET_ERROR(e,t){e.error=t}},Ko={ApiError({commit:e,dispatch:t},o){let a=o.response?.data?.detail;a&&(a=a.replace(/\[ErrorDetail\(string=/g,"").replace(/\)\s*\]/g,""),a=a.replace(/code='invalid',/g,""),a=a.replace(/code='invalid'/g,"")),e("SET_ERROR",a),t("notifications/showNotification",{message:a,type:"error"},{root:!0})}};var Yo={namespaced:!0,state:zo,mutations:Go,actions:Ko};const Jo={typesControles:[],controles:[],showMenu:{},settings:{}},Zo={showMenu:e=>e.showMenu,settings:e=>e.settings,allTypesControles:e=>e.typesControles,allControles:e=>e.controles},ea={async addType({dispatch:e},t){try{return await He.post("PPH/type-controle/",t),e("notifications/showNotification",{message:"Contrôle enregistré avec succès",type:"success"},{root:!0}),Promise.resolve()}catch(o){return e("notifications/showNotification",{message:"Erreur lors de l'ajout du contrôle",type:"error"},{root:!0}),Promise.reject(o)}},async loadTypes({commit:e,dispatch:t}){try{const t=await He.get("PPH/type-controle/");return e("SET_TYPES",t.data),Promise.resolve()}catch(o){return t("notifications/showNotification",{message:"Erreur lors du chargement des contrôles",type:"error"},{root:!0}),Promise.reject(o)}},toggleInfo({commit:e},t){e("TOGGLE_INFO",t)},toggleMenu({commit:e},t){e("TOGGLE_MENU",t)},toggleSettings({commit:e},t){e("TOGGLE_SETTINGS",t)}},ta={ADD_TYPE:(e,t)=>{e.typesControles.push(t)},SET_TYPES:(e,t)=>{e.typesControles=t},TOGGLE_MENU(e,t){e.showMenu[t]=!e.showMenu[t]},TOGGLE_SETTINGS(e,t){e.settings[t]=!e.settings[t]}};var oa={namespaced:!0,state:Jo,getters:Zo,mutations:ta,actions:ea};const aa={vpph:[],profil:[],competences:[],situations:[],personnas:[],response:null,history:null},la={getResponse:e=>e.response,allHistory:e=>e.history,allProfils:e=>e.profil,getVpph:e=>e.vpph},sa={async askQuestion({commit:e,dispatch:t},o){try{e("deleteResponse"),console.log("message",o);const t=await He.post("PPH/chatgpt/",o);e("setResponse",t.data.message)}catch(a){let o="Désolé, une erreur est survenue.";a.response&&a.response.data&&a.response.data.error?o=a.response.data.error:a.message&&(o=a.message),t("notifications/showNotification",{message:o,type:"error"},{root:!0}),console.error("Erreur lors de l'envoi de la question : ",o),e("setResponse",o)}},async getHistory({commit:e,dispatch:t}){try{const t=await He.get("PPH/chatgpt/");return e("setHistory",t.data),Promise.resolve()}catch(o){return t("notifications/showNotification",{message:"Erreur lors du chargement des conversations",type:"error"},{root:!0}),Promise.reject(o)}},async saveVpph({dispatch:e},{id:t,formData:o}){try{await He.patch(`PPH/personnas/${t}/`,o),e("notifications/showNotification",{message:"Paramètres V-PPH enregistrés",type:"succes"},{root:!0})}catch(a){e("notifications/showNotification",{message:"Erreur lors de l'enregistrement des paramètres",type:"error"},{root:!0})}},async loadVpph({commit:e,dispatch:t}){try{const t=await He.get("PPH/personnas/");return console.log("VpphData",t.data),e("setVpph",t.data),Promise.resolve()}catch(o){return t("notifications/showNotification",{message:"Erreur lors du chargement de V-PP",type:"error"},{root:!0}),Promise.reject(o)}},async newChat(){await He.delete("PPH/chatgpt/").then((function(e){console.log("Ressource supprimée avec succès",e)})).catch((function(e){console.log("Erreur lors de la suppression de la ressource",e)}))},async sciteApi(){const{data:e}=await He.get("https://api.scite.ai/search",{params:{term:"CRISPR"}});console.log(e)},ajouterProfil({commit:e},t){console.log("ajout",t),e("addProfil",t)},modifierProfil({commit:e},{index:t,profil:o}){console.log("modif",o),e("updateProfil",{index:t,nouveauProfil:o})}},ia={addCompetence(e,t){e.competences.push(t)},addProfil(e,t){console.log("add",t),e.profil.push(t)},updateProfil(e,{index:t,nouveauProfil:o}){t>=0&&t<e.profil.length&&(console.log("update",o),e.profil.splice(t,1,o),e.profil=[...e.profil])},setVpph(e,t){e.vpph=t},setResponse(e,t){e.response=t},setHistory(e,t){e.history=t},deleteResponse(e){e.response=null}};var ra={namespaced:!0,state:aa,getters:la,actions:sa,mutations:ia};const na=(0,u.y$)({modules:{chatGPT:ra,controles:oa,etapes:Kt,appareils:Xo,epi:Wo,apiError:Yo,resetData:Ho,services:So,dateFormatter:Ao,websocket:yo,spinner:go,fiches:po,demandes:io,voiesAdministration:to,formules:$t,matieresPremieres:Ut,suppliers:Je,users:at,notifications:it,contact:dt,user:vt,auth:ht,errorModule:Ct,screen:qt,forms:St}});var ca=na;const ua=(0,l.Lk)("div",{class:"row justify-center items-center"},[(0,l.Lk)("div",{class:"text-h6 text-center text-cyan-4"},"Inscription")],-1),da={key:0},pa={key:1},ma={class:"row justify-center q-my-md"},fa={class:"row justify-center q-mt-lg text-cyan-4 pph-link"};function ha(e,t,o,a,s,i){const r=(0,l.g2)("q-card-section"),n=(0,l.g2)("q-separator"),c=(0,l.g2)("UserRegisterForm"),u=(0,l.g2)("q-icon"),d=(0,l.g2)("router-link"),p=(0,l.g2)("q-card"),m=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(m,{class:"row justify-center container-signup"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"card-signup shadow-10 col-md-3"},{default:(0,l.k6)((()=>[(0,l.bF)(r,null,{default:(0,l.k6)((()=>[ua])),_:1}),(0,l.bF)(n,{color:"grey-7"}),(0,l.bF)(r,null,{default:(0,l.k6)((()=>[s.formSubmitted?((0,l.uX)(),(0,l.CE)("div",pa,[(0,l.Lk)("div",ma,[(0,l.bF)(u,{size:"10em",name:"check_circle",color:"green-4"})]),(0,l.Lk)("div",fa,[(0,l.bF)(d,{class:"q-mx-md text-cyan-4 pph-link",to:"/login"},{default:(0,l.k6)((()=>[(0,l.eW)("Déjà inscrit ? Connectez-vous")])),_:1})])])):((0,l.uX)(),(0,l.CE)("div",da,[(0,l.bF)(c,{register:i.register},null,8,["register"])]))])),_:1})])),_:1})])),_:1})}const ba={class:"q-pa-sm row"},ga={class:"q-gutter-sm col-md-12"},ka={class:"row"},_a={class:"col-md-6"},va={class:"col-md-6"},ya={class:"row"},Fa={class:"col-md-6"},wa={class:"col-md-6"},Ca={class:"row justify-center q-mt-sm"},La={class:"col-md-10"},xa={class:"row q-pa-sm items-center"},Aa={class:"offset-2 col-md-3"},qa=(0,l.Lk)("p",{class:"text-cyan-4 col-2 text-center q-mt-sm"},"Ou",-1),Ea={class:"col-md-3"},Ia={class:"row justify-center"},Pa={class:"col-md-10"};function Sa(e,t,o,s,i,r){const n=(0,l.g2)("q-icon"),c=(0,l.g2)("q-input"),u=(0,l.g2)("q-btn"),d=(0,l.g2)("q-separator"),p=(0,l.g2)("q-form");return(0,l.uX)(),(0,l.Wv)(p,{onSubmit:(0,a.D$)(r.onSubmit,["prevent"])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ba,[(0,l.Lk)("div",ga,[(0,l.bF)(c,{ref:"emailInput",class:"my-0",modelValue:i.email,"onUpdate:modelValue":t[0]||(t[0]=e=>i.email=e),label:"E-mail",color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("emailInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("emailInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("email","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("email"))},{before:(0,l.k6)((()=>[(0,l.bF)(n,{name:"mail",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.Lk)("div",ka,[(0,l.Lk)("div",_a,[(0,l.bF)(c,{ref:"last_nameInput",class:"my-0",modelValue:i.last_name,"onUpdate:modelValue":t[5]||(t[5]=e=>i.last_name=e),label:"Nom",color:"cyan-4",onMouseover:t[6]||(t[6]=e=>r.changeLabelColor("last_nameInput","#ffb74d")),onMouseleave:t[7]||(t[7]=e=>r.changeLabelColor("last_nameInput","")),onFocus:t[8]||(t[8]=e=>r.onFocus("last_name","#4dd0e1")),onBlur:t[9]||(t[9]=e=>r.onBlur("last_name"))},{before:(0,l.k6)((()=>[(0,l.bF)(n,{name:"portrait",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",va,[(0,l.bF)(c,{ref:"first_nameInput",class:"my-0",modelValue:i.first_name,"onUpdate:modelValue":t[10]||(t[10]=e=>i.first_name=e),label:"Prénom",color:"cyan-4",onMouseover:t[11]||(t[11]=e=>r.changeLabelColor("first_nameInput","#ffb74d")),onMouseleave:t[12]||(t[12]=e=>r.changeLabelColor("first_nameInput","")),onFocus:t[13]||(t[13]=e=>r.onFocus("first_name","#4dd0e1")),onBlur:t[14]||(t[14]=e=>r.onBlur("first_name"))},{before:(0,l.k6)((()=>[(0,l.bF)(n,{name:"portrait",color:"cyan-4"})])),_:1},8,["modelValue"])])]),(0,l.Lk)("div",ya,[(0,l.Lk)("div",Fa,[(0,l.bF)(c,{ref:"password1Input",class:"my-0",modelValue:i.password1,"onUpdate:modelValue":t[15]||(t[15]=e=>i.password1=e),label:"Mot de passe",type:"password",color:"cyan-4",onMouseover:t[16]||(t[16]=e=>r.changeLabelColor("password1Input","#ffb74d")),onMouseleave:t[17]||(t[17]=e=>r.changeLabelColor("password1Input","")),onFocus:t[18]||(t[18]=e=>r.onFocus("password1","#4dd0e1")),onBlur:t[19]||(t[19]=e=>r.onBlur("password1"))},{before:(0,l.k6)((()=>[(0,l.bF)(n,{name:"password",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",wa,[(0,l.bF)(c,{ref:"password2Input",class:"my-0",modelValue:i.password2,"onUpdate:modelValue":t[20]||(t[20]=e=>i.password2=e),label:"Confirmation",type:"password",color:"cyan-4",onMouseover:t[21]||(t[21]=e=>r.changeLabelColor("password2Input","#ffb74d")),onMouseleave:t[22]||(t[22]=e=>r.changeLabelColor("password2Input","")),onFocus:t[23]||(t[23]=e=>r.onFocus("password2","#4dd0e1")),onBlur:t[24]||(t[24]=e=>r.onBlur("password2"))},{before:(0,l.k6)((()=>[(0,l.bF)(n,{name:"password",color:"cyan-4"})])),_:1},8,["modelValue"])])]),(0,l.Lk)("div",Ca,[(0,l.Lk)("div",La,[(0,l.bF)(u,{type:"submit",class:"q-mt-lg glossy full-width btn-grey-success-pph"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"q-mx-sm",name:"person_add"}),(0,l.eW)(" S'inscrire ")])),_:1})])]),(0,l.Lk)("div",xa,[(0,l.Lk)("div",Aa,[(0,l.bF)(d,{color:"grey-8"})]),qa,(0,l.Lk)("div",Ea,[(0,l.bF)(d,{color:"grey-8"})])]),(0,l.Lk)("div",Ia,[(0,l.Lk)("div",Pa,[(0,l.bF)(u,{class:"glossy full-width btn-grey-success-pph",onClick:r.redirectToLogin},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"q-mr-sm",name:"login"}),(0,l.eW)(" Se connecter ")])),_:1},8,["onClick"])])])])])])),_:1},8,["onSubmit"])}var Va={props:{register:{type:Function,required:!0}},data(){return{email:"",first_name:"",last_name:"",password1:"",password2:"",emailFocused:!1,first_nameFocused:!1,last_nameFocused:!1,password1Focused:!1,password2Focused:!1,isEmailHovered:!1}},methods:{onSubmit(){this.register({email:this.email,first_name:this.first_name,last_name:this.last_name,password1:this.password1,password2:this.password2})},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},redirectToLogin(){this.$router.push("/login")},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1}}},Qa=o(4542);const Ma=(0,m.A)(Va,[["render",Sa]]);var Ta=Ma;E()(Va,"components",{QForm:xe.A,QInput:Ae.A,QIcon:x.A,QBtn:v.A,QSeparator:L.A,QField:Qa.A});var Wa={components:{UserRegisterForm:Ta},data(){return{error:null,formSubmitted:!1}},methods:{register(e){He.post("/accounts/register/",e,{headers:{"Content-Type":"application/json"}}).then((()=>{this.$q.notify({message:"Inscription réussie !\n Un mail de confirmation\nvient de vous être envoyé.",icon:"announcement",color:"green-4",timeout:1e4,position:"top-right"}),this.formSubmitted=!0})).catch((e=>{e.response&&400===e.response.status&&(this.error=e.response.data),this.$q.notify({message:"Échec de l'inscription.",icon:"warning amber",color:"red-3",timeout:5e3,position:"top-right"})}))}}};const Da=(0,m.A)(Wa,[["render",ha]]);var Ra=Da;E()(Wa,"components",{QPage:Qe.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A,QIcon:x.A});const Ua={class:"row justify-center q-my-xl q-py-xl"},Na=(0,l.Lk)("div",{class:"row justify-center items-center"},[(0,l.Lk)("div",{class:"text-h6 text-center text-cyan-4"},"Connexion")],-1);function Xa(e,t,o,a,s,i){const r=(0,l.g2)("atom-spinner"),n=(0,l.g2)("q-page"),c=(0,l.g2)("q-card-section"),u=(0,l.g2)("q-separator"),d=(0,l.g2)("UserLoginForm"),p=(0,l.g2)("q-card");return s.logged?((0,l.uX)(),(0,l.Wv)(n,{key:0,class:"row justify-center items-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ua,[(0,l.bF)(r,{class:"bg-op-8","animation-duration":1e3,size:100,color:"#ff1d5e"})])])),_:1})):((0,l.uX)(),(0,l.Wv)(n,{key:1,class:"row justify-center container-signup"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"card-signup shadow-10 col-md-3 col-xs-10"},{default:(0,l.k6)((()=>[(0,l.bF)(c,null,{default:(0,l.k6)((()=>[Na])),_:1}),(0,l.bF)(u,{color:"grey-7"}),(0,l.bF)(c,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{onSubmit:i.loginUser},null,8,["onSubmit"])])),_:1})])),_:1})])),_:1}))}const Oa={class:"q-pa-sm row"},ja={class:"q-gutter-sm col-md-12"},$a={class:"row"},Ba={class:"col-md-12"},Ha={class:"row justify-center q-mt-sm"},za={class:"col-md-10"},Ga={class:"row justify-center q-mt-sm text-cyan-4 pph-link"},Ka={class:"row q-pa-sm items-center"},Ya={class:"offset-2 col-md-3"},Ja=(0,l.Lk)("p",{class:"text-cyan-4 col-2 text-center q-mt-sm"},"Ou",-1),Za={class:"col-md-3"},el={class:"row justify-center"},tl={class:"col-md-10"};function ol(e,t,o,s,i,r){const n=(0,l.g2)("q-icon"),c=(0,l.g2)("q-input"),u=(0,l.g2)("q-btn"),d=(0,l.g2)("router-link"),p=(0,l.g2)("q-separator"),m=(0,l.g2)("q-form");return(0,l.uX)(),(0,l.Wv)(m,{onSubmit:(0,a.D$)(r.onSubmit,["prevent"])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Oa,[(0,l.Lk)("div",ja,[(0,l.bF)(c,{ref:"usernameInput",class:"my-0",modelValue:i.username,"onUpdate:modelValue":t[0]||(t[0]=e=>i.username=e),label:"Nom d'utilisateur",color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("usernameInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("usernameInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("username","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("username"))},{before:(0,l.k6)((()=>[(0,l.bF)(n,{name:"portrait",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.Lk)("div",$a,[(0,l.Lk)("div",Ba,[(0,l.bF)(c,{ref:"password1Input",class:"my-0",type:i.isPwd?"password":"text",modelValue:i.password1,"onUpdate:modelValue":t[6]||(t[6]=e=>i.password1=e),color:"cyan-4",label:"Mot de passe",onMouseover:t[7]||(t[7]=e=>r.changeLabelColor("password1Input","#ffb74d")),onMouseleave:t[8]||(t[8]=e=>r.changeLabelColor("password1Input","")),onFocus:t[9]||(t[9]=e=>r.onFocus("password1","#4dd0e1")),onBlur:t[10]||(t[10]=e=>r.onBlur("password1"))},{before:(0,l.k6)((()=>[(0,l.bF)(n,{name:"password",color:"cyan-4"})])),append:(0,l.k6)((()=>[(0,l.bF)(n,{name:i.isPwd?"visibility_off":"visibility",class:"cursor-pointer hover-effect",onClick:t[5]||(t[5]=e=>i.isPwd=!i.isPwd),color:"cyan-4"},null,8,["name"])])),_:1},8,["type","modelValue"])])]),(0,l.Lk)("div",Ha,[(0,l.Lk)("div",za,[(0,l.bF)(u,{type:"submit",class:"q-mt-lg glossy full-width btn-grey-success-pph"},{default:(0,l.k6)((()=>[e.isLoggedIn?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(n,{key:0,class:"q-mx-sm",name:"login"})),(0,l.eW)(" Se connecter ")])),_:1})]),(0,l.Lk)("div",Ga,[(0,l.bF)(d,{class:"q-mx-md text-cyan-4 hover-effect pph-link",to:"/password-reset"},{default:(0,l.k6)((()=>[(0,l.eW)("Mot de passe oublié ?")])),_:1})])]),(0,l.Lk)("div",Ka,[(0,l.Lk)("div",Ya,[(0,l.bF)(p,{color:"grey-8"})]),Ja,(0,l.Lk)("div",Za,[(0,l.bF)(p,{color:"grey-8"})])]),(0,l.Lk)("div",el,[(0,l.Lk)("div",tl,[(0,l.bF)(u,{class:"glossy full-width btn-grey-success-pph",onClick:r.redirectToRegister},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"q-mr-sm",name:"person_add"}),(0,l.eW)(" S'inscrire ")])),_:1},8,["onClick"])])])])])])),_:1},8,["onSubmit"])}var al={data(){return{isPwd:!0,username:"",password1:"",usernameFocused:!1,passwordFocused:!1}},methods:{onSubmit(){this.$emit("submit",{username:this.username,password:this.password1})},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},redirectToRegister(){this.$router.push("/Register")},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1}}};const ll=(0,m.A)(al,[["render",ol]]);var sl=ll;E()(al,"components",{QForm:xe.A,QInput:Ae.A,QIcon:x.A,QBtn:v.A,QSeparator:L.A,QField:Qa.A});var il=o(5172),rl={components:{UserLoginForm:sl,AtomSpinner:il.F},data(){return{logged:!1}},computed:{...(0,u.aH)("auth",["isLoggedIn","user"])},mounted(){this.$route.query.accountActivated&&this.showActivatedNotification()},methods:{...(0,u.PY)("error",["SET_ERROR"]),...(0,u.i0)("auth",["login"]),async loginUser(e){try{this.logged=!0,await this.login(e),this.$store.dispatch("notifications/showNotification",{message:"Connexion réussie !",type:"success"}),this.$store.dispatch("notifications/showNotification",{message:`Bienvenue ${this.user.firstName} !`,type:"info"}),this.$router.push({name:"Home"})}catch(t){this.SET_ERROR(t)}this.logged=!1},showActivatedNotification(){this.$store.dispatch("notifications/showNotification",{message:"Votre compte est activé !",type:"success"})}}};const nl=(0,m.A)(rl,[["render",Xa]]);var cl=nl;E()(rl,"components",{QPage:Qe.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A});const ul=(0,l.Lk)("div",{class:"row justify-center items-center"},[(0,l.Lk)("div",{class:"text-h6 text-center text-cyan-4"},"Nouveau mot de passe")],-1);function dl(e,t,o,a,s,i){const r=(0,l.g2)("q-card-section"),n=(0,l.g2)("q-separator"),c=(0,l.g2)("PasswordResetForm"),u=(0,l.g2)("q-card"),d=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(d,{class:"row justify-center container-signup"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"card-signup shadow-10 col-md-3"},{default:(0,l.k6)((()=>[(0,l.bF)(r,null,{default:(0,l.k6)((()=>[ul])),_:1}),(0,l.bF)(n,{color:"grey-7"}),(0,l.bF)(r,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{register:e.register},null,8,["register"])])),_:1})])),_:1})])),_:1})}var pl=o(6732);const ml={class:"q-pa-sm row"},fl={class:"q-gutter-sm col-md-12"},hl={class:"row justify-center q-mt-sm"},bl={class:"col-md-10"},gl={class:"row q-pa-sm items-center"},kl={class:"offset-2 col-md-3"},_l=(0,l.Lk)("p",{class:"text-cyan-4 col-2 text-center q-mt-sm"},"Ou",-1),vl={class:"col-md-3"},yl={class:"row justify-center"},Fl={class:"col-md-10"};function wl(e,t,o,s,i,r){const n=(0,l.g2)("q-icon"),c=(0,l.g2)("q-input"),u=(0,l.g2)("q-btn"),d=(0,l.g2)("q-separator"),p=(0,l.g2)("q-form");return(0,l.uX)(),(0,l.Wv)(p,{onSubmit:(0,a.D$)(r.onSubmit,["prevent"])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ml,[(0,l.Lk)("div",fl,[(0,l.bF)(c,{ref:"emailInput",class:"my-0",modelValue:i.email,"onUpdate:modelValue":t[0]||(t[0]=e=>i.email=e),label:"E-mail",color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("emailInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("emailInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("email","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("email"))},{before:(0,l.k6)((()=>[(0,l.bF)(n,{name:"portrait",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.Lk)("div",hl,[(0,l.Lk)("div",bl,[(0,l.bF)(u,{type:"submit",class:"q-mt-lg glossy full-width btn-grey-primary-pph"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"q-mx-sm",name:"restart_alt"}),(0,l.eW)(" Réinitialiser ")])),_:1})])]),(0,l.Lk)("div",gl,[(0,l.Lk)("div",kl,[(0,l.bF)(d,{color:"grey-8"})]),_l,(0,l.Lk)("div",vl,[(0,l.bF)(d,{color:"grey-8"})])]),(0,l.Lk)("div",yl,[(0,l.Lk)("div",Fl,[(0,l.bF)(u,{class:"glossy full-width btn-grey-success-pph",onClick:r.redirectToLogin},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"q-mr-sm",name:"login"}),(0,l.eW)(" Se connecter ")])),_:1},8,["onClick"])])])])])])),_:1},8,["onSubmit"])}var Cl={data(){return{email:"",emailFocused:!1}},methods:{onSubmit(){this.$emit("submit",{email:this.email})},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},redirectToLogin(){this.$router.push("/login")},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1}}};const Ll=(0,m.A)(Cl,[["render",wl]]);var xl=Ll;E()(Cl,"components",{QForm:xe.A,QInput:Ae.A,QIcon:x.A,QBtn:v.A,QSeparator:L.A,QField:Qa.A});var Al={components:{PasswordResetForm:xl},setup(){const e=(0,pl.KR)(""),t=(0,pl.KR)(""),o=async()=>{try{const o=await De.A.post("http://localhost:8000/dj-rest-auth/password/reset/",{email:e.value});200===o.status&&(t.value="Votre demande de réinitialisation du mot de passe a été soumise.")}catch(o){console.error(o)}};return{email:e,message:t,submitForm:o}}};const ql=(0,m.A)(Al,[["render",dl]]);var El=ql;E()(Al,"components",{QPage:Qe.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A});const Il=(0,l.Lk)("div",{class:"text-cyan-4 q-mb-lg text-h5 text-center"},"Fiche fournisseur",-1),Pl={class:"row"},Sl={class:"row"},Vl={class:"row"},Ql={class:"row"},Ml={class:"row"},Tl={class:"row"},Wl={class:"row"},Dl={class:"row justify-center"};function Rl(e,t,o,a,s,i){const r=(0,l.g2)("q-icon"),n=(0,l.g2)("q-input"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-stepper-navigation"),d=(0,l.g2)("q-step"),p=(0,l.g2)("q-btn-group"),m=(0,l.g2)("q-stepper"),f=(0,l.g2)("q-form");return(0,l.uX)(),(0,l.Wv)(f,{class:"q-pa-md"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{modelValue:s.step,"onUpdate:modelValue":t[57]||(t[57]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[Il,(0,l.bF)(d,{name:1,title:"Identification",icon:"info",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Pl,[(0,l.bF)(n,{class:"col-2",ref:"nameInput",modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.name=e),label:"Nom",color:"cyan-4",onMouseover:t[1]||(t[1]=e=>i.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>i.changeLabelColor("nameInput","")),onFocus:t[3]||(t[3]=e=>i.onFocus("name","#4dd0e1")),onBlur:t[4]||(t[4]=e=>i.onBlur("name"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"forklift",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[5]||(t[5]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:2,title:"Localisation",icon:"vaccines",done:s.step>2},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Sl,[(0,l.bF)(n,{ref:"countryInput",class:"col-2",modelValue:s.country,"onUpdate:modelValue":t[6]||(t[6]=e=>s.country=e),label:"Pays",color:"cyan-4",onMouseover:t[7]||(t[7]=e=>i.changeLabelColor("countryInput","#ffb74d")),onMouseleave:t[8]||(t[8]=e=>i.changeLabelColor("countryInput","")),onFocus:t[9]||(t[9]=e=>i.onFocus("country","#4dd0e1")),onBlur:t[10]||(t[10]=e=>i.onBlur("country"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"flag",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Vl,[(0,l.bF)(n,{ref:"addressInput",class:"col-3",modelValue:s.address,"onUpdate:modelValue":t[11]||(t[11]=e=>s.address=e),label:"Adresse",color:"cyan-4",onMouseover:t[12]||(t[12]=e=>i.changeLabelColor("addressInput","#ffb74d")),onMouseleave:t[13]||(t[13]=e=>i.changeLabelColor("addressInput","")),onFocus:t[14]||(t[14]=e=>i.onFocus("address","#4dd0e1")),onBlur:t[15]||(t[15]=e=>i.onBlur("address"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"mail",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(n,{ref:"postalInput",class:"col-2 q-ml-md",modelValue:s.postal,"onUpdate:modelValue":t[16]||(t[16]=e=>s.postal=e),label:"Code postal",color:"cyan-4",onMouseover:t[17]||(t[17]=e=>i.changeLabelColor("postalInput","#ffb74d")),onMouseleave:t[18]||(t[18]=e=>i.changeLabelColor("postalInput","")),onFocus:t[19]||(t[19]=e=>i.onFocus("postal","#4dd0e1")),onBlur:t[20]||(t[20]=e=>i.onBlur("postal"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"contact_mail",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Ql,[(0,l.bF)(n,{ref:"cityInput",class:"col-3",modelValue:s.city,"onUpdate:modelValue":t[21]||(t[21]=e=>s.city=e),label:"Ville",color:"cyan-4",onMouseover:t[22]||(t[22]=e=>i.changeLabelColor("cityInput","#ffb74d")),onMouseleave:t[23]||(t[23]=e=>i.changeLabelColor("cityInput","")),onFocus:t[24]||(t[24]=e=>i.onFocus("city","#4dd0e1")),onBlur:t[25]||(t[25]=e=>i.onBlur("city"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"location_city",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[26]||(t[26]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[27]||(t[27]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:3,title:"Contact",icon:"ac_unit",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ml,[(0,l.bF)(n,{ref:"phoneInput",class:"col-3",modelValue:s.phone,"onUpdate:modelValue":t[28]||(t[28]=e=>s.phone=e),label:"Téléphone",color:"cyan-4",onMouseover:t[29]||(t[29]=e=>i.changeLabelColor("phoneInput","#ffb74d")),onMouseleave:t[30]||(t[30]=e=>i.changeLabelColor("phoneInput","")),onFocus:t[31]||(t[31]=e=>i.onFocus("phone","#4dd0e1")),onBlur:t[32]||(t[32]=e=>i.onBlur("phone"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"phone",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Tl,[(0,l.bF)(n,{ref:"emailInput",class:"col-3",modelValue:s.email,"onUpdate:modelValue":t[33]||(t[33]=e=>s.email=e),type:"email",label:"E-mail de contact",color:"cyan-4",onMouseover:t[34]||(t[34]=e=>i.changeLabelColor("emailInput","#ffb74d")),onMouseleave:t[35]||(t[35]=e=>i.changeLabelColor("emailInput","")),onFocus:t[36]||(t[36]=e=>i.onFocus("email","#4dd0e1")),onBlur:t[37]||(t[37]=e=>i.onBlur("email"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"mail",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(n,{ref:"siteInput",class:"col-3 q-ml-md",modelValue:s.site,"onUpdate:modelValue":t[38]||(t[38]=e=>s.site=e),type:"url",label:"Site",color:"cyan-4",onMouseover:t[39]||(t[39]=e=>i.changeLabelColor("siteInput","#ffb74d")),onMouseleave:t[40]||(t[40]=e=>i.changeLabelColor("siteInput","")),onFocus:t[41]||(t[41]=e=>i.onFocus("site","#4dd0e1")),onBlur:t[42]||(t[42]=e=>i.onBlur("site"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"web",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[43]||(t[43]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[44]||(t[44]=e=>s.step=4),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:4,title:"Identifiants",icon:"settings",done:s.step>4},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Wl,[(0,l.bF)(n,{ref:"user_codeInput",class:"col-2",modelValue:s.user_code,"onUpdate:modelValue":t[45]||(t[45]=e=>s.user_code=e),label:"Code client",color:"cyan-4",onMouseover:t[46]||(t[46]=e=>i.changeLabelColor("user_codeInput","#ffb74d")),onMouseleave:t[47]||(t[47]=e=>i.changeLabelColor("user_codeInput","")),onFocus:t[48]||(t[48]=e=>i.onFocus("user_code","#4dd0e1")),onBlur:t[49]||(t[49]=e=>i.onBlur("user_code"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"sell",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(n,{ref:"passwordInput",class:"col-2 q-ml-md",modelValue:s.password,"onUpdate:modelValue":t[50]||(t[50]=e=>s.password=e),label:"Mot de passe",color:"cyan-4",onMouseover:t[51]||(t[51]=e=>i.changeLabelColor("passwordInput","#ffb74d")),onMouseleave:t[52]||(t[52]=e=>i.changeLabelColor("passwordInput","")),onFocus:t[53]||(t[53]=e=>i.onFocus("password","#4dd0e1")),onBlur:t[54]||(t[54]=e=>i.onBlur("password"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"password",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[55]||(t[55]=e=>s.step=3),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[56]||(t[56]=e=>s.step=5),color:"cyan-4",label:"Terminer",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",Dl,[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:i.callSubmit,color:"green-4",class:"btn-flat-success-pph"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{class:"q-mx-sm",name:"library_add"}),(0,l.eW)(" Enregistrer ")])),_:1},8,["onClick"])])),_:1})])])),_:1},8,["modelValue"])])),_:1})}var Ul={data(){return{step:1,supplierId:null,supplier:[],name:"",postal:"",address:"",city:"",country:"",phone:"",email:"",site:"",user_code:"",password:"",is_activate:!0}},async mounted(){this.$route.params.id&&(this.supplierId=Number(this.$route.params.id)),await Promise.all([this.loadSuppliers()]),this.supplierId&&(this.supplier=this.allSuppliers.find((e=>e.id===this.supplierId)),this.name=this.supplier.name,this.postal=this.supplier.postal,this.address=this.supplier.address,this.city=this.supplier.city,this.country=this.supplier.country,this.phone=this.supplier.phone,this.email=this.supplier.email,this.site=this.supplier.site,this.user_code=this.supplier.user_code,this.password=this.supplier.password)},computed:{...(0,u.L8)("suppliers",["allSuppliers"])},methods:{...(0,u.i0)("suppliers",["addSupplier","loadSuppliers","updateSupplier"]),async callSubmit(){const e={name:this.name,postal:this.postal,address:this.address,city:this.city,country:this.country,phone:this.phone,email:this.email,site:this.site,user_code:this.user_code,password:this.password};this.supplierId?this.updateSubmit(e):this.onSubmit(e)},async updateSubmit(e){const t=this.supplierId;await this.updateSupplier({id:t,formData:e}),this.resetForm(),this.loadUsers()},async onSubmit(e){try{if("CreateBalancesSupplier"===this.$route.name){const t="/PPH/balances-supplier/";await this.addSupplier({formData:e,url:t})}else{const t="/PPH/suppliers/";await this.addSupplier({formData:e,url:t})}this.resetForm()}catch(t){console.error("Error adding supplier:",t)}},resetForm(){this.name="",this.postal="",this.address="",this.city="",this.country="",this.logo=null,this.phone="",this.email="",this.site="",this.user_code="",this.password=""},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1}}},Nl=o(6312),Xl=o(5504),Ol=o(8198);const jl=(0,m.A)(Ul,[["render",Rl]]);var $l=jl;E()(Ul,"components",{QForm:xe.A,QStepper:Nl.A,QStep:Xl.A,QInput:Ae.A,QIcon:x.A,QStepperNavigation:Ol.A,QBtn:v.A,QBtnGroup:Y.A,QField:Qa.A});var Bl=o.p+"img/blanc.2f72339c.jpg";const Hl={class:"row justify-center"},zl={class:"col-md-12"},Gl={class:"row q-mx-sm"},Kl={class:"col-3 q-mt-md"},Yl={class:"col-6 q-mt-md text-cyan-4 text-h6"},Jl={class:"row justify-center"},Zl={class:"col-2 offset-1 q-mt-sm"},es={class:"row q-mt-sm"},ts={class:"col col-12 justify-center"},os={class:"row justify-start"},as=["onClick"],ls=["onClick"],ss=["href"];function is(e,t,o,s,i,r){const n=(0,l.g2)("q-btn"),c=(0,l.g2)("router-link"),u=(0,l.g2)("q-icon"),d=(0,l.g2)("q-input"),p=(0,l.g2)("q-spinner-rings"),m=(0,l.g2)("q-img"),f=(0,l.g2)("q-item-section"),h=(0,l.g2)("q-item"),b=(0,l.g2)("q-list"),k=(0,l.g2)("q-menu"),_=(0,l.g2)("q-card"),v=(0,l.g2)("q-page"),y=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(v,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Hl,[(0,l.Lk)("div",zl,[(0,l.Lk)("div",Gl,[(0,l.Lk)("div",Kl,[(0,l.bF)(c,{to:"/supplier/"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{round:"",class:"glossy btn-cyan-pph",icon:"add_box"})])),_:1})]),(0,l.Lk)("div",Yl,[(0,l.Lk)("div",Jl,(0,g.v_)(r.countSuppliers)+" fournisseurs référencées ",1)]),(0,l.Lk)("div",Zl,[(0,l.bF)(d,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e),label:"Recherche...",onInput:r.filterSuppliers,color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("searchInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(u,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",es,[(0,l.Lk)("div",ts,[(0,l.Lk)("div",os,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredSuppliers,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-1 q-pa-sm",key:t.id,onClick:e=>r.redirectToLink(t.id)},[(0,l.bF)(_,{bordered:"",class:(0,g.C4)(["card-mini justify-center items-center text-center relative",{"bd-red-4":!t.is_activate}])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",{onClick:e=>r.redirectToLink(t.id),class:"card-content"},[(0,l.bF)(m,{class:"logo-card-mini",src:Bl,loading:"lazy","spinner-color":"red-4",alt:t.name},{loading:(0,l.k6)((()=>[(0,l.bF)(p,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.bF)(u,{name:"factory",size:"md",color:"cyan-4",class:"icon-background"}),(0,l.Lk)("div",{class:(0,g.C4)(["absolute-top hover-effect q-my-none",{"text-cyan-1":t.is_activate,"text-red-4":!t.is_activate}])},(0,g.v_)(t.name),3)])),_:2},1032,["alt"]),(0,l.bF)(n,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(k,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:"",onClick:(0,a.D$)((o=>e.deleteSupplier(t.id)),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Supprimer")])),_:1})])),_:2},1032,["onClick"])),[[y]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:"",onClick:(0,a.D$)((o=>e.toggleActivation({supplierId:t.id,isActive:t.is_activate})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.is_activate?"Désactiver":"Activer"),1)])),_:2},1024)])),_:2},1032,["onClick"])),[[y]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])],8,ls),(0,l.bF)(n,{class:"absolute-bottom-right hover-effect q-pa-none q-ma-none",color:"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"xs",onClick:(0,a.D$)((o=>e.toggleInfo(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(k,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[t.id],"onUpdate:modelValue":o=>e.expanded[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[t.phone?((0,l.uX)(),(0,l.Wv)(h,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Téléphone : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.phone),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.email?((0,l.uX)(),(0,l.Wv)(h,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" E-mail : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.email),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.site?((0,l.uX)(),(0,l.Wv)(h,{key:2,clickable:"",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Site : ")])),_:1}),(0,l.Lk)("a",{href:t.site,target:"_blank",rel:"noopener noreferrer",class:"pph-link"},[(0,l.bF)(f,{class:"row items-center text-grey-7 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.site),1)])),_:2},1024)],8,ss)])),_:2},1024)):(0,l.Q3)("",!0),t.user_code?((0,l.uX)(),(0,l.Wv)(h,{key:3},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Code utilisateur : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.user_code),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.password?((0,l.uX)(),(0,l.Wv)(h,{key:4},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Mot de passe : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.password),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["class"])],8,as)))),128))])])])])])])),_:1})}var rs={name:"SuppliersCards",data(){return{searchQuery:""}},computed:{...(0,u.L8)("suppliers",["allSuppliers","showMenu","expanded"]),countSuppliers(){return Array.isArray(this.filteredSuppliers)?this.filteredSuppliers.length:0},filteredSuppliers(){return this.searchQuery?this.allSuppliers.filter((e=>e.name.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.allSuppliers}},created(){this.loadSuppliers(),console.log(this.allSuppliers)},methods:{...(0,u.i0)("suppliers",["loadSuppliers","toggleActivation","deleteSupplier","toggleMenu","toggleInfo"]),filterSuppliers(){return this.searchQuery?this.allSuppliers.filter((e=>e.name.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.allSuppliers},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/supplier/${e}`)}}},ns=o(5726),cs=o(2169);const us=(0,m.A)(rs,[["render",is]]);var ds=us;E()(rs,"components",{QPage:Qe.A,QBtn:v.A,QInput:Ae.A,QIcon:x.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QField:Qa.A}),E()(rs,"directives",{ClosePopup:A.A});const ps={class:"q-pa-md"},ms={class:"text-h5 text-center text-cyan-4"},fs={class:"row"},hs={class:"row"},bs={class:"row"},gs={class:"row"},ks={class:"row"},_s={class:"row justify-center"};function vs(e,t,o,a,s,i){const r=(0,l.g2)("q-icon"),n=(0,l.g2)("q-input"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-stepper-navigation"),d=(0,l.g2)("q-step"),p=(0,l.g2)("q-select"),m=(0,l.g2)("q-btn-group"),f=(0,l.g2)("q-stepper");return(0,l.uX)(),(0,l.CE)("div",ps,[(0,l.bF)(f,{modelValue:s.step,"onUpdate:modelValue":t[10]||(t[10]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ms,"Profil de "+(0,g.v_)(s.user.first_name)+" "+(0,g.v_)(s.user.last_name),1),(0,l.bF)(d,{name:1,title:"Identité",icon:"person",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",fs,[(0,l.bF)(n,{modelValue:s.nom,"onUpdate:modelValue":t[0]||(t[0]=e=>s.nom=e),color:"cyan-4",label:"Nom",class:"col-2"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"person",color:"cyan-4",size:"sm"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",hs,[(0,l.bF)(n,{modelValue:s.prenom,"onUpdate:modelValue":t[1]||(t[1]=e=>s.prenom=e),color:"cyan-4",label:"Prenom",class:"col-2"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"person",color:"cyan-4",size:"sm"})])),_:1},8,["modelValue"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[2]||(t[2]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:2,title:"Identifiants",icon:"person",done:s.step>2},{default:(0,l.k6)((()=>[(0,l.Lk)("div",bs,[(0,l.bF)(n,{type:"email",modelValue:s.email,"onUpdate:modelValue":t[3]||(t[3]=e=>s.email=e),color:"cyan-4",label:"E-mail",class:"col-2"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"person",color:"cyan-4",size:"sm"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",gs,[(0,l.bF)(n,{modelValue:s.username,"onUpdate:modelValue":t[4]||(t[4]=e=>s.username=e),color:"cyan-4",label:"Nom d'utilisateur",class:"col-2"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"person",color:"cyan-4",size:"sm"})])),_:1},8,["modelValue"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[5]||(t[5]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[6]||(t[6]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:3,title:"Fonction",icon:"person",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ks,[(0,l.bF)(p,{modelValue:s.user_function,"onUpdate:modelValue":t[7]||(t[7]=e=>s.user_function=e),color:"cyan-4",label:"Nom",class:"col-2",options:i.allFunctionsLabel,"option-label":"label","option-value":"id"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"person",color:"cyan-4",size:"sm"})])),_:1},8,["modelValue","options"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[8]||(t[8]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[9]||(t[9]=e=>s.step=4),color:"cyan-4",label:"Terminer",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",_s,[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:i.callSubmit,color:"green-4",label:"Enregistrer",class:"btn-flat-success-pph"},null,8,["onClick"])])),_:1})])])),_:1},8,["modelValue"])])}var ys={components:{},data(){return{step:1,nom:"",prenom:"",username:"",user_function:"",user_function_id:"",email:"",user:[],id:""}},async created(){this.userId=Number(this.$route.params.id),this.loadUsers(),this.loadFunctions(),this.user=this.allUsers.find((e=>e.id===this.userId)),console.log("allFunctions",this.allFunctions),console.log("User",this.user),this.userId&&(this.nom=this.user.last_name,this.prenom=this.user.first_name,this.username=this.user.username,this.user_function=this.user.function.title,this.user_function_id=this.user.function.id,this.email=this.user.email)},computed:{...(0,u.L8)("users",["allUsers","allFunctions"]),allFunctionsLabel(){return this.allFunctions.map((e=>({...e,label:`${e.title}`,id:e.id})))}},methods:{...(0,u.i0)("users",["loadUsers","updateUser","addUser","loadFunctions"]),async callSubmit(){console.log("User",this.user);const e={last_name:this.nom,first_name:this.prenom,username:this.username,function:this.user_function_id,email:this.email};console.log("formDataEnvoyé",e),this.userId?this.updateSubmit(e):this.onSubmit(e)},async updateSubmit(e){const t=this.userId;await this.updateUser({id:t,formData:e}),this.resetForm()},async onSubmit(e){try{await this.addUser(e),this.resetForm()}catch(t){console.error("Error adding supplier:",t)}},resetForm(){this.nom="",this.prenom="",this.username="",this.user_function=null,this.email="",this.step=1}}},Fs=o(48);const ws=(0,m.A)(ys,[["render",vs]]);var Cs=ws;E()(ys,"components",{QStepper:Nl.A,QStep:Xl.A,QInput:Ae.A,QIcon:x.A,QStepperNavigation:Ol.A,QBtn:v.A,QSelect:Fs.A,QBtnGroup:Y.A});const Ls={class:"row justify-center"},xs={class:"col-md-12"},As={class:"row"},qs={class:"col-1 q-mx-sm q-mt-sm"},Es={class:"row q-mt-sm"},Is={class:"col col-12 justify-center"},Ps={class:"row justify-start"},Ss=["onClick"],Vs=["onClick"];function Qs(e,t,o,s,i,r){const n=(0,l.g2)("q-btn"),c=(0,l.g2)("router-link"),u=(0,l.g2)("q-spinner-rings"),d=(0,l.g2)("q-img"),p=(0,l.g2)("q-item-section"),m=(0,l.g2)("q-item"),f=(0,l.g2)("q-list"),h=(0,l.g2)("q-menu"),b=(0,l.g2)("q-card"),k=(0,l.g2)("q-page"),_=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(k,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ls,[(0,l.Lk)("div",xs,[(0,l.Lk)("div",As,[(0,l.Lk)("div",qs,[(0,l.bF)(c,{to:"/user/"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{round:"",class:"btn-cyan-pph",icon:"add"})])),_:1})])]),(0,l.Lk)("div",Es,[(0,l.Lk)("div",Is,[(0,l.Lk)("div",Ps,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.allUsers,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-1 q-pa-sm",key:t.id,onClick:e=>r.redirectToLink(t.id)},[(0,l.bF)(b,{bordered:"",class:(0,g.C4)(["card-mini justify-center items-center text-center relative",{"bd-red-4":!t.is_active}])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",{onClick:e=>r.redirectToLink(t.id),class:"card-content"},[(0,l.bF)(d,{class:"logo-card-mini",src:t.function.logo,alt:t.function.title,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(u,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",{class:(0,g.C4)(["absolute-top hover-effect q-my-none text-no-wrap",{"text-cyan-1":t.is_active,"text-red-4":!t.is_active}])},(0,g.v_)(t.last_name)+" "+(0,g.v_)(t.first_name[0]),3)])),_:2},1032,["src","alt"]),(0,l.bF)(n,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(h,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(f,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(m,{clickable:"",onClick:(0,a.D$)((o=>e.deleteUser(t.id)),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)("Supprimer")])),_:1})])),_:2},1032,["onClick"])),[[_]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(m,{clickable:"",onClick:(0,a.D$)((o=>e.toggleActivation({userId:t.id,isActive:t.is_active})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.is_active?"Désactiver":"Activer"),1)])),_:2},1024)])),_:2},1032,["onClick"])),[[_]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])],8,Vs),(0,l.bF)(n,{class:"absolute-bottom-right hover-effect q-pa-none q-ma-none",color:"cyan-4",round:"",flat:"",dense:"",icon:"info",onClick:(0,a.D$)((o=>(e.toggleInfo(t.id),e.showMenuLog(t.id))),["stop"])},null,8,["onClick"]),(0,l.bF)(h,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[t.id],"onUpdate:modelValue":o=>e.expanded[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(f,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(p,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Nom : ")])),_:1}),(0,l.bF)(p,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.last_name),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(p,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prénom : ")])),_:1}),(0,l.bF)(p,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.first_name),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(p,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" E-mail : ")])),_:1}),(0,l.bF)(p,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.email),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(p,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Fonction : ")])),_:1}),(0,l.bF)(p,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.function.title),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["class"])],8,Ss)))),128))])])])])])])),_:1})}var Ms={name:"UsersCards",computed:{...(0,u.L8)("users",["allUsers","showMenu","expanded"])},created(){this.loadUsers(),console.log(this.allUsers)},methods:{...(0,u.i0)("users",["loadUsers","toggleActivation","deleteUser","toggleMenu","toggleInfo"]),redirectToLink(e){this.$router.push(`/user/${e}`)}}};const Ts=(0,m.A)(Ms,[["render",Qs]]);var Ws=Ts;E()(Ms,"components",{QPage:Qe.A,QBtn:v.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A}),E()(Ms,"directives",{ClosePopup:A.A});const Ds={class:"row justify-center q-pt-xl"},Rs=(0,l.Lk)("h5",{class:"text-cyan-4"}," Mentions légales ",-1),Us=(0,l.Lk)("p",{class:"text-blue-grey-7"},[(0,l.eW)(" Le présent site www.pph.fr est la propriété de la société HopDigit SAS, société par action simplifiée au capital de 21.870 euros."),(0,l.Lk)("br"),(0,l.eW)(" Inscription au RCS de Cherbourg en Cotentin sous le n° 817 698 061"),(0,l.Lk)("br"),(0,l.eW)(" Siège social: 3 le quesnay, 50690 Couville, France"),(0,l.Lk)("br"),(0,l.eW)(" Adresse mail: contact@pph.fr"),(0,l.Lk)("br"),(0,l.Lk)("br"),(0,l.eW)(" Directeur de publication : Monsieur Capelle Jérémy ayant la qualité de Président de la société PPH."),(0,l.Lk)("br"),(0,l.Lk)("br"),(0,l.eW)(" Numéro de la TVA: FR85 817 698 061"),(0,l.Lk)("br"),(0,l.Lk)("br"),(0,l.eW)(" Déclaration auprès de la CNIL sous les numéros1850968v0, 1850964v0 & 2070289-V1"),(0,l.Lk)("br"),(0,l.Lk)("br"),(0,l.eW)(" Hébergeurs: OVH & Hébergement données santé: A2COM (Hébergeur français souverain certifié HDS – Activités 1-2-3-4-5-6 – ZA Rive Ouest, 1 Bd du Trieux, 35740 Pacé) ")],-1);function Ns(e,t,o,a,s,i){const r=(0,l.g2)("q-card-section"),n=(0,l.g2)("q-card");return(0,l.uX)(),(0,l.CE)("div",Ds,[(0,l.bF)(n,{class:"col-10 q-mt-xl",style:{"background-color":"#e6e5e8"}},{default:(0,l.k6)((()=>[(0,l.bF)(r,null,{default:(0,l.k6)((()=>[Rs,Us])),_:1})])),_:1})])}var Xs={name:"MentionsLegales"};const Os=(0,m.A)(Xs,[["render",Ns]]);var js=Os;E()(Xs,"components",{QCard:Ce.A,QCardSection:Le.A});const $s={class:"row justify-center q-pt-xl"},Bs=(0,l.Lk)("h5",{class:"text-cyan-4"}," Conditions générales d'utilisation ",-1),Hs=(0,l.Lk)("h6",{class:"text-cyan-4"}," ARTICLE 1 : DISPOSITIONS GENERALES ",-1),zs=(0,l.Lk)("p",{class:"text-blue-grey-7"},[(0,l.eW)(" Les présentes conditions générales s’appliquent dans leur intégralité, sans restriction ni réserve, à l’ensemble des services proposés (ci-après définis et désignés « Services ») aux Etablissements (ci-après définis), par la société HopDigit, Société par Actions Simplifiée au capital de 21.890 € immatriculée au R.C.S de Cherbourg en Cotentin sous le numéro 817 698 061 sise 20 quai Duguay Trouin, 35000 Rennees (ci-après « HopDigit »), notamment via son site internet https://www.hopdigit.fr/ (ci-après « Site Internet »)."),(0,l.Lk)("br"),(0,l.Lk)("br"),(0,l.eW)(" Elles en constituent les conditions essentielles et déterminantes et prévalent sur toutes conditions générales et/ou tous autres documents émanant de l’Etablissement, quels qu’en soient les termes."),(0,l.Lk)("br"),(0,l.eW)(" Aussi, toute demande de souscription à une offre de Services proposée par HopDigit et/ou l’utilisation des Services implique l’acceptation sans réserve des présentes conditions générales. Les présentes conditions générales peuvent être modifiées à tout moment par Hopdigit, notamment en cas d’ajustement tarifaire, d’évolutions technologiques ou réglementaires. Dans cette hypothèse, les conditions générales modifiées seront applicables à toute relation contractuelle en cours et à venir. Chacune des stipulations des présentes conditions générales s’appliquera dans toute la mesure autorisée par la loi et toute nullité en tout ou partie d’une clause sera sans influence sur le reste de cette clause et l’ensemble des conditions générales. ")],-1),Gs=(0,l.Lk)("h6",{class:"text-cyan-4"},"ARTICLE 2 : CHAMP D’APPLICATION SERVICES",-1),Ks=(0,l.Lk)("p",{class:"text-blue-grey-7"},[(0,l.eW)(" MAPUI LABS met à disposition par le biais du Site Internet et moyennant un abonnement gratuit ou payant selon la formule, une plateforme (ci-après : « Plateforme ») permettant notamment à l’Etablissement, en fonction des différentes fonctionnalités choisies :"),(0,l.Lk)("br"),(0,l.eW)(" – de mettre à disposition, prêter et échanger des médicaments, dispositifs médicaux ou autres préparations (ci-après « Médicaments ») avec d’autres Etablissements,"),(0,l.Lk)("br"),(0,l.eW)(" – d’être alerté par notification ou email d’informations provenant d’autres Etablissements, notamment concernant la disponibilité et la péremption de Médicaments,"),(0,l.Lk)("br"),(0,l.eW)(" – d’accéder à des statistiques et compilations de données réalisée par MAPUI LABS (ci-après : « Données »),"),(0,l.Lk)("br"),(0,l.eW)(" – d’échanger avec les autres Etablissements et leurs Utilisateurs (ci-après définis) inscrits sur la Plateforme notamment via le forum (ci-après « Forum »)"),(0,l.Lk)("br")],-1),Ys=(0,l.Lk)("h6",{class:"text-cyan-4"},"ETABLISSEMENTS",-1),Js=(0,l.Lk)("p",{class:"text-blue-grey-7"}," Au regard du contenu et de leurs finalités, la Plateforme et les Services proposés sont exclusivement destiné aux pharmacies des hôpitaux et cliniques agissant dans le cadre de leur activité professionnelle (ci-après « Etablissements ») et à leur personnel habilité à y accéder pour un usage professionnel (ci-après « Utilisateurs »). ",-1);function Zs(e,t,o,a,s,i){const r=(0,l.g2)("q-card-section"),n=(0,l.g2)("q-card");return(0,l.uX)(),(0,l.CE)("div",$s,[(0,l.bF)(n,{class:"col-10 q-mt-xl",style:{"background-color":"#e6e5e8"}},{default:(0,l.k6)((()=>[(0,l.bF)(r,null,{default:(0,l.k6)((()=>[Bs,Hs,zs,Gs,Ks,Ys,Js])),_:1})])),_:1})])}var ei={name:"CdtGalUtl"};const ti=(0,m.A)(ei,[["render",Zs]]);var oi=ti;E()(ei,"components",{QCard:Ce.A,QCardSection:Le.A});var ai=o.p+"img/commande.b3bf3770.jpg",li=o.p+"img/livrer.4dff3f2b.jpg",si=o.p+"img/demande3.593b0d7f.jpg",ii=o.p+"img/controle2.ee12c8bc.jpg",ri=o.p+"img/health_hazard.61e5836e.png";const ni={class:"row q-mx-md justify-center"},ci={class:"col-md-12"},ui=(0,l.Lk)("div",{class:"row q-mt-xs"},[(0,l.Lk)("div",{class:"col-6 text-h6 text-center text-cyan-4"}," Matières premières "),(0,l.Lk)("div",{class:"col-6 text-h6 text-center text-cyan-4"}," Préparations ")],-1),di={class:"row justify-center"},pi={class:"col-5"},mi={class:"row"},fi={class:"col-3 card-home offset-1 q-mt-sm"},hi={class:"absolute-top text-subtitle2 text-center hover-effect"},bi={class:"text-h5 text-center text-cyan-4"},gi={class:"col-3 card-home offset-2 q-mt-sm"},ki={class:"absolute-top text-subtitle2 text-center hover-effect"},_i={class:"text-h5 text-center text-cyan-4"},vi={class:"col-5"},yi={class:"row"},Fi={class:"col-3 card-home offset-3 q-ml-sm q-mt-sm"},wi={class:"absolute-top text-subtitle2 text-center hover-effect"},Ci={class:"text-h5 text-center text-cyan-4"},Li={class:"text-subtitle2 text-center"},xi=(0,l.Lk)("br",null,null,-1),Ai={class:"q-ma-md"},qi={class:"q-pa-md"},Ei=(0,l.Lk)("div",{class:"text-h6 text-center text-orange-4"},"Demandes en cours",-1),Ii={key:0},Pi={class:"text-subtitle1 text-center text-cyan-4"},Si={class:"text-bold"},Vi=(0,l.Lk)("br",null,null,-1),Qi={class:"text-italic"},Mi={class:"row justify-center"},Ti=(0,l.Lk)("br",null,null,-1),Wi={key:1},Di=(0,l.Lk)("p",null,"Aucune demande pour cette date.",-1),Ri=[Di],Ui={class:"col-3 card-home offset-2 q-mt-sm"},Ni={class:"absolute-top text-subtitle2 text-center hover-effect"},Xi={class:"text-h5 text-center text-cyan-4"},Oi={class:"row justify-center q-mx-md q-pb-lg q-mt-lg bd-radius-10 bg-op-8",style:{"background-color":"#1a2946"}},ji=(0,l.Lk)("div",{class:"col-12 text-center"},[(0,l.Lk)("div",{class:"text-h6 text-cyan-4"},"Tableau de bord")],-1),$i={class:"col-md-5"},Bi={class:"text-center text-cyan-1"},Hi={class:"row justify-center"},zi=(0,l.Lk)("br",null,null,-1),Gi=(0,l.Lk)("div",{class:"text-center text-cyan-1"},"Produits en attente de commande",-1),Ki={class:"row justify-center"},Yi=(0,l.Lk)("div",{class:"text-center text-cyan-1"},"Produits en attente de livraison",-1),Ji={class:"row justify-center"},Zi={class:"col-md-5 offset-1"},er={class:"text-center text-cyan-1"},tr={class:"row justify-center"};function or(e,t,o,s,i,r){const n=(0,l.g2)("q-spinner-rings"),c=(0,l.g2)("q-img"),u=(0,l.g2)("q-tooltip"),d=(0,l.g2)("q-btn"),p=(0,l.g2)("router-link"),m=(0,l.g2)("q-btn-group"),f=(0,l.g2)("q-card"),h=(0,l.g2)("q-toolbar"),b=(0,l.g2)("q-date"),k=(0,l.g2)("q-separator"),_=(0,l.g2)("q-scroll-area"),v=(0,l.g2)("q-splitter"),y=(0,l.g2)("q-dialog"),F=(0,l.g2)("q-item-label"),w=(0,l.g2)("q-item-section"),C=(0,l.g2)("font-awesome-icon"),L=(0,l.g2)("q-badge"),x=(0,l.g2)("q-item"),A=(0,l.g2)("q-list"),q=(0,l.g2)("q-card-section"),E=(0,l.g2)("q-carousel-slide"),I=(0,l.g2)("q-carousel"),P=(0,l.g2)("q-toggle"),S=(0,l.g2)("apexchart"),V=(0,l.g2)("q-page"),Q=(0,l.g2)("atom-spinner"),M=(0,l.gN)("ripple");return i.loadedPage?((0,l.uX)(),(0,l.Wv)(V,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ni,[(0,l.Lk)("div",ci,[ui,(0,l.Lk)("div",di,[(0,l.Lk)("div",pi,[(0,l.Lk)("div",mi,[(0,l.Lk)("div",fi,[(0,l.bF)(f,{bordered:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{src:ai,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(n,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",hi,[(0,l.eW)(" En attente commande "),(0,l.Lk)("div",bi,(0,g.v_)(e.matieresCdeCount),1)])])),_:1}),(0,l.bF)(m,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{to:"/commande/"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"visibility"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Voir la liste de commande")])),_:1})])),_:1})])),_:1}),(0,l.bF)(d,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"print"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Imprimer la liste de commande")])),_:1})])),_:1}),(0,l.bF)(d,{class:"q-pa-none hover-effect",flat:"",color:"green-4",icon:"check_circle",onClick:e.validateCommande},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Mettre les produits en attente de livraison")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})]),(0,l.Lk)("div",gi,[(0,l.bF)(f,{bordered:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{src:li,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(n,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",ki,[(0,l.eW)(" En attente livraison "),(0,l.Lk)("div",_i,(0,g.v_)(e.matieresLivraisonCount),1)])])),_:1}),(0,l.bF)(m,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{to:"/reception/"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"visibility"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Voir les produits")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])])]),(0,l.Lk)("div",vi,[(0,l.Lk)("div",yi,[(0,l.Lk)("div",Fi,[(0,l.bF)(f,{bordered:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{src:si,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(n,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",wi,[(0,l.eW)(" En attente préparation "),(0,l.Lk)("div",Ci,(0,g.v_)(e.nombreDemandes),1),(0,l.Lk)("div",Li,[(0,l.eW)((0,g.v_)(e.nombreDemandesProche)+" pour le ",1),xi,(0,l.eW)(" "+(0,g.v_)(e.demandeProche.dateFormatee),1)])])])),_:1}),(0,l.bF)(m,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"calendar_month",onClick:r.openCalendar},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Voir la plannification")])),_:1})])),_:1},8,["onClick"])])),_:1}),(0,l.bF)(y,{modelValue:i.calendarDialog,"onUpdate:modelValue":t[3]||(t[3]=e=>i.calendarDialog=e)},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(p,{to:"demande",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",class:"text-cyan-4 hover-effect",label:"Nouvelle demande"})])),_:1}),(0,l.bF)(p,{to:"demandes",class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",class:"text-cyan-4 hover-effect",label:"Toutes les demandes"})])),_:1}),(0,l.bF)(d,{flat:"",class:"text-cyan-4 hover-effect absolute-right",icon:"close",onClick:t[0]||(t[0]=e=>i.calendarDialog=!1)})])),_:1}),(0,l.bF)(v,{modelValue:i.splitterModel,"onUpdate:modelValue":t[2]||(t[2]=e=>i.splitterModel=e)},{before:(0,l.k6)((()=>[(0,l.Lk)("div",Ai,[(0,l.bF)(b,{modelValue:i.dateCalendar,"onUpdate:modelValue":t[1]||(t[1]=e=>i.dateCalendar=e),events:r.formatDemandesDates,"event-color":"orange",color:"cyan-4"},null,8,["modelValue","events"])])])),after:(0,l.k6)((()=>[(0,l.Lk)("div",qi,[Ei,(0,l.bF)(_,{"thumb-style":i.thumbStyle,"bar-style":i.barStyle,style:{height:"310px","max-width":"300px"}},{default:(0,l.k6)((()=>[Object.keys(r.demandesGroupesParType).length?((0,l.uX)(),(0,l.CE)("div",Ii,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.demandesGroupesParType,((t,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o},[(0,l.bF)(k),(0,l.Lk)("div",Pi,(0,g.v_)(o),1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t,((t,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o},[(0,l.Lk)("div",Si,[(0,l.eW)((0,g.v_)(t.qté)+" "+(0,g.v_)(t.prep.nom),1),Vi]),(0,l.eW)(" "+(0,g.v_)(t.service.nom)+" ",1),(0,l.Lk)("div",Qi,(0,g.v_)(t.commentaire),1),(0,l.Lk)("div",Mi,[(0,l.bF)(d,{size:"xs",flat:"",class:"text-cyan-4 hover-effect",icon:"visibility"}),(0,l.bF)(d,{flat:"",size:"xs",icon:"local_pharmacy",color:"green-4"}),(0,l.bF)(d,{flat:"",size:"xs",icon:"delete_forever",color:"red-4",onClick:(0,a.D$)((o=>e.deleteDemande(t.id)),["stop"])},null,8,["onClick"])]),Ti])))),128))])))),128))])):((0,l.uX)(),(0,l.CE)("div",Wi,Ri))])),_:1},8,["thumb-style","bar-style"])])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["modelValue"])])),_:1})]),(0,l.Lk)("div",Ui,[(0,l.bF)(f,{bordered:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{src:ii,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(n,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",Ni,[(0,l.eW)(" En attente contrôle "),(0,l.Lk)("div",Xi,(0,g.v_)(e.fichesControlCount),1)])])),_:1}),(0,l.bF)(m,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{to:"/controles/"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"visibility"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Voir les contrôles en attente")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])])])])])]),(0,l.Lk)("div",Oi,[ji,(0,l.Lk)("div",$i,[(0,l.bF)(I,{animated:"",modelValue:i.carousel1,"onUpdate:modelValue":t[4]||(t[4]=e=>i.carousel1=e),arrows:"",infinite:"",autoplay:i.autoplay1,onMouseenter:t[5]||(t[5]=e=>i.autoplay1=!1),onMouseleave:t[6]||(t[6]=e=>i.autoplay1=!0),class:"rounded-borders q-pb-sm",style:{"background-image":"linear-gradient(to left, #263238, #3F6B79)"}},{default:(0,l.k6)((()=>[(0,l.bF)(E,{name:"slide1"},{default:(0,l.k6)((()=>[(0,l.bF)(_,{"thumb-style":i.thumbStyle,"bar-style":i.barStyle,style:{height:"350px"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"items-center",style:{"background-image":"linear-gradient(to left, #263238, #3F6B79)"}},{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Bi,"Produits arrivant à expiration en "+(0,g.v_)(i.currentYear),1),(0,l.bF)(A,{class:"text-cyan-1"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieresExpire,((e,t)=>(0,l.bo)(((0,l.uX)(),(0,l.Wv)(x,{key:t,clickable:""},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(F,{class:"text-cyan-1 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.matiere.nom)+" "+(0,g.v_)(e.matiere.qté_cdt)+(0,g.v_)(e.matiere.unite_cdt),1)])),_:2},1024),(0,l.bF)(F,{class:"text-cyan-1 text-subtitle2 text-no-wrap",caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.matiere.fournisseur.name)+" "+(0,g.v_)(e.lot)+" "+(0,g.v_)(e.peremption),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(w,{class:"q-mr-md",top:""},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Hi,[(0,l.bF)(w,null,{default:(0,l.k6)((()=>[e.matiere.froid?((0,l.uX)(),(0,l.Wv)(C,{key:0,fade:"",icon:"fa-solid fa-snowflake",class:"fa-2x",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0)])),_:2},1024),(0,l.bF)(w,null,{default:(0,l.k6)((()=>[e.matiere.cmr?((0,l.uX)(),(0,l.Wv)(c,{key:0,class:"fade-blink",src:ri,style:{width:"30px",height:"30px"}})):(0,l.Q3)("",!0)])),_:2},1024)])])),_:2},1024),(0,l.bF)(w,{side:"",top:""},{default:(0,l.k6)((()=>[(0,l.bF)(L,{color:"cyan-4","text-color":"white"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.stock_reception)+(0,g.v_)(e.matiere.unite_mesure.nom),1),zi,(0,l.eW)((0,g.v_)(e.matiere.qté_stock)+(0,g.v_)(e.matiere.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)),[[M]]))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["thumb-style","bar-style"])])),_:1}),(0,l.bF)(E,{name:"slide2"},{default:(0,l.k6)((()=>[(0,l.bF)(_,{"thumb-style":i.thumbStyle,"bar-style":i.barStyle,style:{height:"350px"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"items-center",style:{"background-image":"linear-gradient(to left, #263238, #3F6B79)"}},{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[Gi,(0,l.bF)(A,{class:"text-cyan-1"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieresCde,((t,o)=>(0,l.bo)(((0,l.uX)(),(0,l.Wv)(x,{key:o,clickable:""},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(F,{class:"text-cyan-1 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.nom)+" "+(0,g.v_)(t.qté_cdt)+(0,g.v_)(t.unite_cdt),1)])),_:2},1024),(0,l.bF)(F,{class:"text-cyan-1 text-subtitle2 text-no-wrap",caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.fournisseur.name)+" "+(0,g.v_)(t.code_fournisseur),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(w,{class:"q-mr-md",top:""},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ki,[(0,l.bF)(w,null,{default:(0,l.k6)((()=>[t.froid?((0,l.uX)(),(0,l.Wv)(C,{key:0,fade:"",icon:"fa-solid fa-snowflake",class:"fa-2x",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0)])),_:2},1024),(0,l.bF)(w,null,{default:(0,l.k6)((()=>[t.cmr?((0,l.uX)(),(0,l.Wv)(c,{key:0,class:"fade-blink",src:ri,style:{width:"30px",height:"30px"}})):(0,l.Q3)("",!0)])),_:2},1024)])])),_:2},1024),(0,l.bF)(w,{side:"",top:""},{default:(0,l.k6)((()=>[(0,l.bF)(L,{class:"q-mt-xs",color:t.qté_stock<t.stock_mini?"red":"green","text-color":"white"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.qté_stock)+(0,g.v_)(t.unite_mesure.nom),1)])),_:2},1032,["color"])])),_:2},1024),(0,l.bF)(w,{side:"",top:""},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",class:"q-px-xs",icon:"check_circle",size:"xs",color:"green-4",onClick:(0,a.D$)((o=>e.toggleLivraison({matiereId:t.id,isLivraison:t.attente_livraison})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Valider commande")])),_:1})])),_:2},1032,["onClick"]),(0,l.bF)(d,{flat:"",class:"q-px-xs",icon:"delete_forever",size:"xs",color:"red-4",onClick:(0,a.D$)((o=>e.toggleCde({matiereId:t.id,isCde:t.cde})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Supprimer")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)),[[M]]))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["thumb-style","bar-style"])])),_:1}),(0,l.bF)(E,{name:"slide3"},{default:(0,l.k6)((()=>[(0,l.bF)(_,{"thumb-style":i.thumbStyle,"bar-style":i.barStyle,style:{height:"350px"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"items-center",style:{"background-image":"linear-gradient(to left, #263238, #3F6B79)"}},{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[Yi,(0,l.bF)(A,{class:"text-cyan-1"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieresLivraison,((e,t)=>(0,l.bo)(((0,l.uX)(),(0,l.Wv)(x,{key:t,clickable:""},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(F,{class:"text-cyan-1 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.nom)+" "+(0,g.v_)(e.qté_cdt)+(0,g.v_)(e.unite_cdt),1)])),_:2},1024),(0,l.bF)(F,{class:"text-cyan-1 text-subtitle2 text-no-wrap",caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.fournisseur.name)+" "+(0,g.v_)(e.code_fournisseur),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(w,{class:"q-mr-md",top:""},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ji,[(0,l.bF)(w,null,{default:(0,l.k6)((()=>[e.froid?((0,l.uX)(),(0,l.Wv)(C,{key:0,fade:"",icon:"fa-solid fa-snowflake",class:"fa-2x",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0)])),_:2},1024),(0,l.bF)(w,null,{default:(0,l.k6)((()=>[e.cmr?((0,l.uX)(),(0,l.Wv)(c,{key:0,class:"fade-blink",src:ri,style:{width:"30px",height:"30px"}})):(0,l.Q3)("",!0)])),_:2},1024)])])),_:2},1024),(0,l.bF)(w,{side:"",top:""},{default:(0,l.k6)((()=>[(0,l.bF)(L,{color:e.qté_stock<e.stock_mini?"red":"green","text-color":"white"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.qté_stock)+(0,g.v_)(e.unite_mesure.nom),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1024)),[[M]]))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["thumb-style","bar-style"])])),_:1})])),_:1},8,["modelValue","autoplay"])]),(0,l.Lk)("div",Zi,[(0,l.bF)(I,{animated:"",modelValue:i.carousel2,"onUpdate:modelValue":t[10]||(t[10]=e=>i.carousel2=e),arrows:"",infinite:"",padding:i.padding,autoplay:i.autoplay2,class:"rounded-borders",onMouseenter:t[11]||(t[11]=e=>i.autoplay2=!1),onMouseleave:t[12]||(t[12]=e=>i.autoplay2=!0),style:{"background-image":"linear-gradient(to right, #263238, #3F6B79)"}},{default:(0,l.k6)((()=>[(0,l.bF)(E,{name:"slide2-1"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"text-subtitle2 text-center text-cyan-1",style:{"background-image":"linear-gradient(to right, #263238, #3F6B79)"}},{default:(0,l.k6)((()=>[i.loadedBar?((0,l.uX)(),(0,l.Wv)(q,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(P,{modelValue:i.toggleMonth,"onUpdate:modelValue":t[7]||(t[7]=e=>i.toggleMonth=e),color:"red-4",icon:"calendar_month",label:"Semaines/Mois",size:"md"},null,8,["modelValue"]),(0,l.bF)(P,{modelValue:i.toggleType,"onUpdate:modelValue":t[8]||(t[8]=e=>i.toggleType=e),color:"purple-4",icon:"bar_chart",label:"Bar/Area",size:"md"},null,8,["modelValue"]),(0,l.bF)(P,{modelValue:i.toggleValue,"onUpdate:modelValue":t[9]||(t[9]=e=>i.toggleValue=e),color:"green-4",icon:"timeline",label:"Valeurs",size:"md"},null,8,["modelValue"]),((0,l.uX)(),(0,l.Wv)(S,{key:i.graphKey,id:"apex-bar",height:"200",type:i.toggleType?"area":"bar",options:i.chartOptions,series:i.series},null,8,["type","options","series"]))])),_:1})):(0,l.Q3)("",!0)])),_:1})])),_:1}),(0,l.bF)(E,{name:"slide2-2"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"items-center",style:{"background-image":"linear-gradient(to right, #263238, #3F6B79)"}},{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",er,"Evolution des 5 formules les plus utilisées en "+(0,g.v_)(i.currentYear),1),(0,l.bF)(A,{class:"text-cyan-1"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.topFichesData,((e,t)=>(0,l.bo)(((0,l.uX)(),(0,l.Wv)(x,{key:t,clickable:""},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(F,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.prep),1)])),_:2},1024),(0,l.bF)(F,{class:"text-cyan-1 text-subtitle2",caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(i.previousYear)+": "+(0,g.v_)(e.previousCount)+" fiches - "+(0,g.v_)(i.currentYear)+": "+(0,g.v_)(e.count)+" fiches",1)])),_:2},1024)])),_:2},1024),(0,l.bF)(w,{side:"",top:""},{default:(0,l.k6)((()=>[(0,l.bF)(L,{color:r.calculateEvolution(e.count,e.previousCount)<0?"red":"green","text-color":"white"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(r.calculateEvolution(e.count,e.previousCount))+"% ",1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1024)),[[M]]))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(E,{name:"slide2-3"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"items-center",style:{"background-image":"linear-gradient(to right, #263238, #3F6B79)"}},{default:(0,l.k6)((()=>[(0,l.bF)(q,{class:"text-subtitle2 text-center text-cyan-1"},{default:(0,l.k6)((()=>[i.loadedDonut?((0,l.uX)(),(0,l.Wv)(q,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,"Répartition des fiches en "+(0,g.v_)(i.currentYear),1),(0,l.bF)(S,{options:i.donutOptions,series:i.donutSeries,type:"donut",height:"200"},null,8,["options","series"])])),_:1})):(0,l.Q3)("",!0)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","padding","autoplay"])])])])),_:1})):((0,l.uX)(),(0,l.Wv)(V,{key:1,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",tr,[(0,l.bF)(Q,{class:"bg-op-8","animation-duration":1e3,size:100,color:"#ff1d5e"})])])),_:1}))}var ar=o(8710),lr={name:"HomePage",components:{apexchart:ar.A,AtomSpinner:il.F},data(){return{thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#027be3",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#027be3",width:"9px",opacity:.2},carousel1:"slide1",carousel2:"slide2-1",autoplay1:!0,autoplay2:!0,padding:!1,loadedPage:!1,calendarDialog:!1,dateCalendar:(new Date).toISOString().substr(0,10).replace(/-/g,"/"),splitterModel:62,currentYear:(new Date).getFullYear(),previousYear:(new Date).getFullYear()-1,loadedBar:!1,toggleMonth:!0,loadedDonut:!1,loadedTopFiches:!1,topFichesData:null,tickAmountX:2,toggleType:!0,toggleValue:!1,graphKey:0,donutSeries:[],donutOptions:[],series:[],chartOptions:[]}},computed:{...(0,u.L8)("matieresPremieres",["allMatieres","allReceptions","matieresCdeCount","matieresLivraisonCount"]),...(0,u.L8)("demandes",["nombreDemandes","demandeProche","nombreDemandesProche","demandesDates","allDemandes"]),...(0,u.L8)("fiches",["fichesControlCount","fichesSemaine"]),filteredMatieresExpire(){const e=new Date,t=new Date(e.getFullYear(),11,31);return this.allReceptions.filter((o=>{const[a,l,s]=o.peremption.split("/"),i=new Date(`${s}-${l}-${a}`);return i>=e&&i<=t}))},filteredMatieresCde(){return this.allMatieres.filter((e=>!0===e.cde))},filteredMatieresLivraison(){return this.allMatieres.filter((e=>!0===e.attente_livraison))},demandesDates(){const e=this.$store.getters["demandes/demandesDates"];return e},demandesGroupesParType(){let e={};return this.demandesDatesSelect.forEach((t=>{let o=t.prep.type.nom;e[o]||(e[o]=[]),e[o].push(t)})),e},demandesDatesSelect(){let e=this.dateCalendar.replace(/\//g,"-");console.log("Date formatée pour comparaison:",e);let t=this.allDemandes.filter((t=>(console.log("Comparaison de dates:",t.date_prevu,e),t.date_prevu===e)));return console.log("Demandes filtrées:",t),t},formatDemandesDates(){return this.demandesDates.map((e=>e.replace(/-/g,"/")))},totalFiches(){return this.donutSeries.reduce(((e,t)=>e+t),0)}},async mounted(){await Promise.all([this.loadAllData()]),this.loadedPage=!0},watch:{toggleMonth(){this.loadData(),this.processData()},dateCalendar(e,t){console.log("Ancienne date:",t,"Nouvelle date:",e)},toggleType(){this.graphKey++},toggleValue(e){this.chartOptions={...this.chartOptions,dataLabels:{enabled:e}},this.graphKey++}},methods:{...(0,u.i0)("matieresPremieres",["loadMatieresPremieres","loadReceptions","toggleCde","toggleLivraison"]),...(0,u.i0)("demandes",["loadDemandes","deleteDemande"]),...(0,u.i0)("fiches",["loadFiches"]),async loadAllData(){await this.loadMatieresPremieres(),await this.loadDemandes(),await this.loadFiches(),await this.loadReceptions(),await this.loadData(),await this.loadTopFichesData(),await this.loadDonutData(),console.log("receptions : ",this.allReceptions)},async loadData(){try{const e=this.toggleMonth?"fiches-mois":"fiches-semaine",t=await He.get(`/PPH/${e}`);this.processData(t.data,this.toggleMonth),this.loadedBar=!0}catch(e){console.error("Erreur lors du chargement des données de l'API:",e),this.loadedBar=!1}},processData(e){const t=this.toggleMonth?"Mois":"Semaine",o=[{name:"Fiches",data:e.map((e=>e.count)),color:"#4dd0e1"},{name:"Unités de conditionnement",data:e.map((e=>e.qte)),color:"#ffb74d"}];this.chartOptions={chart:{id:"barChart",toolbar:{show:!0,tools:{zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0},autoSelected:"zoom"}},tooltip:{theme:"dark"},dataLabels:{enabled:this.toggleValue},xaxis:{labels:{style:{colors:"#e0f7fa"}},tickAmount:this.tickAmountX,title:{text:t,style:{color:"#e0f7fa"}}},yaxis:{labels:{style:{colors:["#e0f7fa"]}},title:{text:"Quantité",style:{color:"#e0f7fa"}},axisBorder:{show:!0,color:"#e0f7fa"}},grid:{xaxis:{lines:{show:!1}},yaxis:{lines:{show:!1}}},legend:{position:"top",horizontalAlign:"left",labels:{colors:"#e0f7fa",useSeriesColors:!1}},plotOptions:{bar:{borderRadius:2,columnWidth:"80%",borderRadiusApplication:"end",backgroundBarOpacity:.8,fill:{type:"gradient",gradient:{shade:"light",type:"vertical",shadeIntensity:0,gradientToColors:["#ffb74d"],inverseColors:!0,opacityFrom:1,opacityTo:.6}}}}},this.series=o},async loadDonutData(){try{const e=await He.get("/PPH/fiches/count_per_service"),t=this.DonutData(e.data);this.donutSeries=t.series,this.donutOptions=t.options,this.loadedDonut=!0,console.log(this.donutSeries),console.log(this.donutOptions)}catch(e){console.error("Erreur lors du chargement des données du donut :",e),this.loadedDonut=!1}},DonutData(e){function t(){const e="0123456789ABCDEF";let t="#";for(let o=0;o<6;o++)t+=e[Math.floor(16*Math.random())];return t}const o=e.map((()=>t()));return{series:e.map((e=>e.count)),options:{labels:e.map((e=>e.service__nom)),colors:o,plotOptions:{pie:{donut:{labels:{show:!0,value:{color:"#e0f7fa"},total:{show:!0,label:"Total",formatter:()=>this.totalFiches,color:"#e0f7fa"}}}}},stroke:{width:0},legend:{position:"left",labels:{colors:"#e0f7fa"}},fill:{colors:o}}}},async loadTopFichesData(){try{const e=await He.get("/PPH/fiches/top_fiches_annuelles");this.topFichesData=this.formatTopFichesData(e.data),this.loadedTopFiches=!0}catch(e){console.error("Erreur lors du chargement des données des top fiches :",e),this.loadedTopFiches=!1}},formatTopFichesData(e){const t=e.current_year.map((t=>({prep:t.prep__nom,count:t.count,previousCount:e.previous_year[t.prep__nom]?.count||0})));return t},calculateEvolution(e,t){return 0===t?0===e?0:100:((e-t)/t*100).toFixed(2)},getEvolutionClass(e,t){const o=this.calculateEvolution(e,t);return o>0?"positive":"negative"},openCalendar(){this.calendarDialog=!0}}},sr=o(9764),ir=o(6642),rr=o(5009),nr=o(9749),cr=o(4155),ur=o(2185),dr=o(7342),pr=o(9628),mr=o(6269),fr=o(5539);const hr=(0,m.A)(lr,[["render",or]]);var br=hr;E()(lr,"components",{QPage:Qe.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QBtnGroup:Y.A,QBtn:v.A,QTooltip:sr.A,QDialog:we.A,QToolbar:G.A,QSplitter:ir.A,QDate:rr.A,QScrollArea:nr.A,QSeparator:L.A,QCarousel:cr.A,QCarouselSlide:ur.A,QCardSection:Le.A,QList:F.A,QItem:w.A,QItemSection:C.A,QItemLabel:dr.A,QBadge:pr.A,QToggle:mr.A}),E()(lr,"directives",{Ripple:fr.A});const gr={class:"row justify-center"},kr={class:"col-md-12"},_r={class:"row q-mx-sm q-mt-sm"},vr={class:"col-3 q-mt-sm"},yr={class:"row"},Fr=(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," Intégrer ",-1),wr=(0,l.Lk)("br",null,null,-1),Cr={class:"row justify-center text-subtitle1 text-orange-4"},Lr=(0,l.Lk)("br",null,null,-1),xr=(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," aux matières premières ",-1),Ar={class:"row"},qr={class:"col-12"},Er={class:"row"},Ir={class:"col-6"},Pr={class:"col-6"},Sr={class:"row"},Vr={class:"col-4"},Qr=(0,l.Lk)("div",{class:"text-cyan-4 text-subtitle2"},"%",-1),Mr={class:"row"},Tr={class:"col-5"},Wr={class:"col-5 offset-1"},Dr={class:"row"},Rr={class:"col-5"},Ur={class:"uniteStockName text-subtitle2 text-cyan-4"},Nr={class:"col-5 offset-1"},Xr={class:"row justify-center"},Or={class:"col-6 q-mt-md text-cyan-4 text-h6"},jr={class:"row justify-center"},$r={class:"col-2 offset-1"},Br={class:"row q-mt-sm"},Hr={class:"col-12 justify-center"},zr={class:"row justify-start"},Gr=["onClick"],Kr=["onClick"],Yr={class:"absolute-top-left q-ml-sm q-mt-xs"},Jr={key:0,class:"text-red-4 text-subtitle2"},Zr={key:1,class:"text-green-4 text-subtitle2"},en={key:2,class:"text-red-4 text-subtitle2"},tn={class:"absolute-bottom-left"},on={class:"row q-mb-xs"},an={class:"row justify-center"};function ln(e,t,o,s,i,r){const n=(0,l.g2)("q-btn"),c=(0,l.g2)("router-link"),u=(0,l.g2)("q-icon"),d=(0,l.g2)("font-awesome-icon"),p=(0,l.g2)("q-item"),m=(0,l.g2)("q-list"),f=(0,l.g2)("q-menu"),h=(0,l.g2)("q-input"),b=(0,l.g2)("q-card-section"),k=(0,l.g2)("q-separator"),_=(0,l.g2)("q-toggle"),v=(0,l.g2)("q-select"),y=(0,l.g2)("q-btn-group"),F=(0,l.g2)("q-card"),w=(0,l.g2)("q-dialog"),C=(0,l.g2)("q-form"),L=(0,l.g2)("q-spinner-rings"),x=(0,l.g2)("q-img"),A=(0,l.g2)("q-item-section"),q=(0,l.g2)("q-page"),E=(0,l.g2)("atom-spinner"),I=(0,l.gN)("close-popup");return e.loadMatieresPremieres?((0,l.uX)(),(0,l.Wv)(q,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",gr,[(0,l.Lk)("div",kr,[(0,l.Lk)("div",_r,[(0,l.Lk)("div",vr,[(0,l.Lk)("div",yr,[(0,l.bF)(h,{ref:"searchCatalogueInput",modelValue:i.searchCatalogueQuery,"onUpdate:modelValue":t[1]||(t[1]=e=>i.searchCatalogueQuery=e),label:"Importer...",color:"cyan-4",onInput:e.filterCatalogueMatieres,onMouseover:t[2]||(t[2]=e=>r.changeLabelColor("searchCatalogueInput","#ffb74d")),onMouseleave:t[3]||(t[3]=e=>r.changeLabelColor("searchCatalogueInput","")),onFocus:t[4]||(t[4]=e=>r.onFocus("searchCatalogueQuery","#4dd0e1")),onBlur:t[5]||(t[5]=e=>r.onBlur("searchCatalogueQuery"))},{before:(0,l.k6)((()=>[(0,l.bF)(c,{to:"/creation-matiere-premiere/"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{round:"",icon:"add_box",class:"glossy btn-cyan-pph"})])),_:1})])),append:(0,l.k6)((()=>[i.searchCatalogueQuery.length<1?((0,l.uX)(),(0,l.Wv)(u,{key:0,name:"search",style:{color:"#4dd0e1"}})):i.searchCatalogueQuery.length>=1&&r.filteredMatieresCatalogue.length>0?((0,l.uX)(),(0,l.Wv)(n,{key:1,size:"lg",onClick:e.toogleMenuMat,class:"hover-effect-success q-pa-xs",flat:""},{default:(0,l.k6)((()=>[(0,l.bF)(d,{icon:"fa-solid fa-magnifying-glass-plus","beat-fade":"",style:{color:"#a1d19b"}})])),_:1},8,["onClick"])):((0,l.uX)(),(0,l.Wv)(d,{key:2,icon:"fa-solid fa-magnifying-glass-plus",fade:"",style:{color:"#d59e9e"},size:"fa-md"}))])),default:(0,l.k6)((()=>[i.searchCatalogueQuery.length>=1?((0,l.uX)(),(0,l.Wv)(f,{key:0,modelValue:i.menuMat,"onUpdate:modelValue":t[0]||(t[0]=e=>i.menuMat=e),anchor:"bottom left"},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieresCatalogue,(e=>((0,l.uX)(),(0,l.Wv)(p,{key:e.id,clickable:"",onClick:t=>r.selectMatiere(e),class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.designation)+", "+(0,g.v_)(e.cdt)+" "+(0,g.v_)(e.qté)+(0,g.v_)(e.unite)+", "+(0,g.v_)(e.fournisseur.name)+", ref:"+(0,g.v_)(e.code_fournisseur),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])):(0,l.Q3)("",!0)])),_:1},8,["modelValue","onInput"]),(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)(w,{modelValue:i.addDialog,"onUpdate:modelValue":t[16]||(t[16]=e=>i.addDialog=e)},{default:(0,l.k6)((()=>[(0,l.bF)(F,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,null,{default:(0,l.k6)((()=>[Fr,wr,(0,l.Lk)("div",Cr,(0,g.v_)(i.selectedMatiere.designation)+" "+(0,g.v_)(i.selectedMatiere.cdt)+" "+(0,g.v_)(i.selectedMatiere.qté)+(0,g.v_)(i.selectedMatiere.unite)+" "+(0,g.v_)(i.selectedMatiere.fournisseur.name)+" ref:"+(0,g.v_)(i.selectedMatiere.code_fournisseur),1),Lr,xr])),_:1}),(0,l.bF)(k),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ar,[(0,l.Lk)("div",qr,[(0,l.bF)(h,{modelValue:i.nom,"onUpdate:modelValue":t[7]||(t[7]=e=>i.nom=e),label:"Désignation",color:"cyan-4",class:"hover-effect"},{prepend:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"",color:"cyan-4",class:"hover-effect-success",onClick:t[6]||(t[6]=e=>this.nom=this.selectedMatiere.designation)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{size:"fa-sm",icon:"fa-solid fa-clone"})])),_:1})])),_:1},8,["modelValue"])])]),(0,l.Lk)("div",Er,[(0,l.Lk)("div",Ir,[(0,l.bF)(_,{modelValue:i.stockee,"onUpdate:modelValue":t[8]||(t[8]=e=>i.stockee=e),size:"md",icon:"inventory",label:"Stockée",color:"green-4"},null,8,["modelValue"])]),(0,l.Lk)("div",Pr,[(0,l.bF)(_,{modelValue:i.cde_auto,"onUpdate:modelValue":t[9]||(t[9]=e=>i.cde_auto=e),size:"md",icon:"list_alt",label:"Commande auto",color:"purple-4"},null,8,["modelValue"])])]),(0,l.Lk)("div",Sr,[(0,l.Lk)("div",Vr,[(0,l.bF)(h,{label:"Liste",class:"hover-effect",color:"cyan-4",modelValue:i.tva,"onUpdate:modelValue":t[10]||(t[10]=e=>i.tva=e)},{append:(0,l.k6)((()=>[Qr])),_:1},8,["modelValue"])])]),(0,l.Lk)("div",Mr,[(0,l.Lk)("div",Tr,[(0,l.bF)(v,{label:"Unité de mesure",class:"hover-effect",color:"cyan-4",modelValue:i.uniteMesure,"onUpdate:modelValue":t[11]||(t[11]=e=>i.uniteMesure=e),options:i.unitesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])]),(0,l.Lk)("div",Wr,[(0,l.bF)(v,{label:"Liste",class:"hover-effect",color:"cyan-4",modelValue:i.liste,"onUpdate:modelValue":t[12]||(t[12]=e=>i.liste=e),options:e.listesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])])]),(0,l.Lk)("div",Dr,[(0,l.Lk)("div",Rr,[(0,l.bF)(h,{modelValue:i.stock_mini,"onUpdate:modelValue":t[13]||(t[13]=e=>i.stock_mini=e),label:"Stock mini",color:"cyan-4"},{append:(0,l.k6)((()=>[(0,l.Lk)("div",Ur,(0,g.v_)(r.uniteStockNom),1)])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Nr,[(0,l.bF)(v,{label:"Forme",class:"hover-effect",color:"cyan-4",modelValue:i.forme,"onUpdate:modelValue":t[14]||(t[14]=e=>i.forme=e),options:e.formesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])])])])),_:1}),(0,l.bF)(k),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Xr,[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"",label:"Transférer",onClick:r.transfert,color:"green-4"},null,8,["onClick"]),(0,l.bF)(n,{flat:"",label:"Annuler",onClick:t[15]||(t[15]=e=>{i.addDialog=!1,this.searchCatalogueQuery=""}),color:"red-4"})])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])]),(0,l.Lk)("div",Or,[(0,l.Lk)("div",jr,(0,g.v_)(r.countMatieres)+" matières premières référencées ",1)]),(0,l.Lk)("div",$r,[(0,l.bF)(h,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[17]||(t[17]=e=>i.searchQuery=e),label:"Recherche...",onInput:e.filterMatieres,color:"cyan-4",onMouseover:t[18]||(t[18]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[19]||(t[19]=e=>r.changeLabelColor("searchInput","")),onFocus:t[20]||(t[20]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[21]||(t[21]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(u,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",Br,[(0,l.Lk)("div",Hr,[(0,l.Lk)("div",zr,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieres,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:t.id,onClick:e=>r.redirectToLink(t.id)},[(0,l.bF)(F,{bordered:"",class:(0,g.C4)(["card-maxi justify-center items-center text-center relative",{"bd-red-4":!t.stockee}])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",{onClick:e=>r.redirectToLink(t.id),class:"card-content"},[(0,l.bF)(x,{class:"logo-card-mini",src:Bl,loading:"lazy","spinner-color":"red-4",alt:t.type.nom},{loading:(0,l.k6)((()=>[(0,l.bF)(L,{color:"red-4"})])),default:(0,l.k6)((()=>["Conditionnement"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:0,icon:"fa-solid fa-prescription-bottle",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Principe actif"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:1,icon:"fa-solid fa-pills",size:"3x",class:"icon-background hover-effect"})):(0,l.Q3)("",!0),"Cosmétique"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:2,icon:"fa-solid fa-hand-holding-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Complément alimentaire"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:3,icon:"fa-solid fa-glass-water-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Technique"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:4,icon:"fa-solid fa-book-medical",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Alimentaire"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:5,icon:"fa-solid fa-bottle-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Excipient"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:6,icon:"fa-solid fa-flask",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:(0,g.C4)(["absolute-top hover-effect q-my-none",{"text-cyan-1":t.stockee,"text-red-4":!t.stockee}])},[(0,l.Lk)("div",null,(0,g.v_)(t.nom),1),(0,l.Lk)("div",null,(0,g.v_)(t.forme.nom)+" "+(0,g.v_)(t.qté_cdt)+(0,g.v_)(t.unite_cdt),1),(0,l.Lk)("div",null,[t.qté_stock<t.stock_mini?((0,l.uX)(),(0,l.Wv)(d,{key:0,icon:"fa-solid fa-triangle-exclamation","beat-fade":"",size:"fa-xs",style:{color:"#e57373"}})):(0,l.Q3)("",!0),t.cde?((0,l.uX)(),(0,l.Wv)(u,{key:1,name:"fact_check",color:"orange-4",size:"xs"})):(0,l.Q3)("",!0),t.attente_livraison?((0,l.uX)(),(0,l.Wv)(u,{key:2,name:"fact_check",color:"green-4",size:"xs"})):(0,l.Q3)("",!0),(0,l.eW)(" Stock : "+(0,g.v_)(t.qté_stock)+(0,g.v_)(t.unite_mesure.nom),1)])],2)])),_:2},1032,["alt"]),(0,l.bF)(n,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(f,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(m,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(p,{clickable:"",onClick:(0,a.D$)((o=>e.toggleCde({matiereId:t.id,isCde:t.cde})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(A,{class:(0,g.C4)({"hover-effect-warning":t.cde,"hover-effect-success":!t.cde})},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.cde?"Retirer de la liste de commande":"Ajouter à la liste de commande"),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])),[[I]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(p,{clickable:"",onClick:(0,a.D$)((o=>e.toggleActivation({matiereId:t.id,isStockee:t.stockee})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(A,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.stockee?"Non Stockée":"Stockée"),1)])),_:2},1024)])),_:2},1032,["onClick"])),[[I]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])],8,Kr),(0,l.Lk)("div",Yr,["Liste 1"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",Jr,"1")):(0,l.Q3)("",!0),"Liste 2"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",Zr,"2")):(0,l.Q3)("",!0),"Stupéfiant"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",en,"S")):(0,l.Q3)("",!0)]),(0,l.Lk)("div",tn,[(0,l.Lk)("div",on,[t.froid?((0,l.uX)(),(0,l.Wv)(d,{key:0,fade:"",icon:"fa-solid fa-snowflake",class:"q-ml-xs fa-2x",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.cmr?((0,l.uX)(),(0,l.Wv)(x,{key:1,class:"q-ml-xs fade-blink",src:ri,style:{width:"20px",height:"20px"}})):(0,l.Q3)("",!0)])]),(0,l.bF)(y,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"bar_chart",size:"sm"}),(0,l.bF)(n,{class:"hover-effect",color:e.expanded[t.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((o=>e.toggleInfo(t.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(f,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[t.id],"onUpdate:modelValue":o=>e.expanded[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(m,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Détails ")])),_:1})])),_:1}),t.fournisseur?((0,l.uX)(),(0,l.Wv)(p,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Fournisseur : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.fournisseur.name),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.tva?((0,l.uX)(),(0,l.Wv)(p,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" TVA : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.tva)+"% ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.prix?((0,l.uX)(),(0,l.Wv)(p,{key:2},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prix : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.prix)+" € HT - "+(0,g.v_)(t.prix_ttc)+" € TTC ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.prix_unit?((0,l.uX)(),(0,l.Wv)(p,{key:3},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prix unitaire : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.prix_unit)+" €/"+(0,g.v_)(t.unite_mesure.nom)+" HT - "+(0,g.v_)(t.prix_unit_ttc)+" €/"+(0,g.v_)(t.unite_mesure.nom)+" TTC ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.stock_mini?((0,l.uX)(),(0,l.Wv)(p,{key:4},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Stock mini : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.stock_mini)+(0,g.v_)(t.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["class"])],8,Gr)))),128))])])])])])])),_:1})):((0,l.uX)(),(0,l.Wv)(q,{key:1,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",an,[(0,l.bF)(E,{class:"bg-op-8","animation-duration":1e3,size:200,color:"#ff1d5e"})])])),_:1}))}var sn=o(9816),rn={name:"MatieresCards",components:{FontAwesomeIcon:sn.gc,AtomSpinner:il.F},data(){return{searchCatalogueQuery:"",searchQuery:"",addDialog:!1,menuMat:!1,selectedMatiere:null,nom:"",tva:"",stock_mini:"",stockee:!1,cde_auto:!1,uniteMesure:null,liste:null,forme:null,type:null,unitesOptions:[]}},computed:{...(0,u.L8)("matieresPremieres",["allMatieres","allMatieresCatalogue","allCategories","allUnites","allFormes","showMenu","expanded"]),...(0,u.L8)("formules",["allListes"]),countMatieres(){return Array.isArray(this.filteredMatieres)?this.filteredMatieres.length:0},filteredMatieres(){if(!Array.isArray(this.allMatieres))return[];const e=["Chimiques & Excipients","Alcools & Alcoolats","Gélules","Flaconnage","Pots"];return this.searchQuery?this.allMatieres.filter((t=>t.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase())&&e.includes(t.categorie.nom))):this.allMatieres.filter((t=>e.includes(t.categorie.nom)))},filteredMatieresCatalogue(){return this.searchCatalogueQuery?this.allMatieresCatalogue.filter((e=>e.designation.toLowerCase().startsWith(this.searchCatalogueQuery.toLowerCase()))):this.allMatieresCatalogue},uniteStockNom(){if(this.unite_mesure&&this.allUnites){const e=this.allUnites.find((e=>e.id===this.unite_mesure.id));return e?e.nom:""}return""}},async created(){await this.loadMatieresPremieres(),await this.loadMatieresPremieresCatalogue(),await this.loadCategoriesMatieres(),await this.loadUnites(),await this.loadListes(),await this.loadFormes(),console.log("allMatieres",this.allMatieres),this.unitesOptions=this.allUnites.map((e=>({label:e.nom,value:e.id}))),this.listesOptions=this.allListes.map((e=>({label:e.nom,value:e.id}))),this.formesOptions=this.allFormes.map((e=>({label:e.nom,value:e.id})))},methods:{...(0,u.i0)("matieresPremieres",["loadMatieresPremieres","loadCategoriesMatieres","loadMatieresPremieresCatalogue","deleteMatiere","loadUnites","loadFormes","addMatiere","toggleActivation","toggleMenuMat","toggleCde","toggleMenu","toggleInfo"]),...(0,u.i0)("formules",["loadListes"]),selectMatiere(e){this.searchCatalogueQuery=e.designation,this.selectedMatiere={...e},this.menuMat=!1,this.addDialog=!0},async transfert(){const e={nom:this.nom,type:this.selectedMatiere.type.id,"qté_cdt":this.selectedMatiere.qté,unite_mesure:this.uniteMesure.value,fournisseur:this.selectedMatiere.fournisseur.id,prix:this.selectedMatiere.prix,tva:this.tva,stock_mini:this.stock_mini,"qté_stock":0,cdt:1,froid:this.selectedMatiere.froid,cmr:this.selectedMatiere.cmr,liste:this.liste.value,forme:this.forme.value,stockee:this.stockee,ean:this.selectedMatiere.cip,code_fournisseur:this.selectedMatiere.code_fournisseur,unite_cdt:this.selectedMatiere.unite};this.addMatiere(e),await this.loadMatieresPremieres(),this.selectedMatiere=null,this.searchCatalogueQuery="",this.nom="",this.stock_mini="",this.tva="",this.stockee=!1,this.cde_auto=!1,this.uniteMesure=null,this.liste=null,this.forme=null,this.type=null,this.addDialog=!1},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/matiere/${e}`)}}};const nn=(0,m.A)(rn,[["render",ln]]);var cn=nn;E()(rn,"components",{QPage:Qe.A,QInput:Ae.A,QBtn:v.A,QIcon:x.A,QMenu:y.A,QList:F.A,QItem:w.A,QForm:xe.A,QDialog:we.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A,QToggle:mr.A,QSelect:Fs.A,QBtnGroup:Y.A,QImg:ns.A,QSpinnerRings:cs.A,QItemSection:C.A,QField:Qa.A}),E()(rn,"directives",{ClosePopup:A.A});const un={class:"row justify-center"},dn={class:"col-md-12"},pn={class:"row q-mx-sm q-mt-sm"},mn={class:"col-3"},fn={class:"row"},hn=(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," Intégrer ",-1),bn=(0,l.Lk)("br",null,null,-1),gn={class:"row justify-center text-subtitle1 text-orange-4"},kn=(0,l.Lk)("br",null,null,-1),_n=(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," aux matières premières ",-1),vn={class:"row"},yn={class:"col-12"},Fn={class:"row"},wn={class:"col-6"},Cn={class:"col-6"},Ln={class:"row"},xn={class:"col-4"},An=(0,l.Lk)("div",{class:"text-cyan-4 text-subtitle2"},"%",-1),qn={class:"row"},En={class:"col-5"},In={class:"col-5 offset-1"},Pn={class:"row"},Sn={class:"col-5"},Vn={class:"uniteStockName text-subtitle2 text-cyan-4"},Qn={class:"col-5 offset-1"},Mn={class:"row justify-center"},Tn={class:"col-6 q-mt-md text-cyan-4 text-h6"},Wn={class:"row justify-center"},Dn={class:"col-2 offset-1"},Rn={class:"row q-mt-sm"},Un={class:"col-12 justify-center"},Nn={class:"row justify-start"},Xn=["onClick"],On=["onClick"],jn={class:"absolute-top-left q-ml-sm q-mt-xs"},$n={key:0,class:"text-red-4 text-subtitle2"},Bn={key:1,class:"text-green-4 text-subtitle2"},Hn={key:2,class:"text-red-4 text-subtitle2"},zn={class:"absolute-bottom-left"},Gn={class:"row q-mb-xs"},Kn={class:"row justify-center"};function Yn(e,t,o,s,i,r){const n=(0,l.g2)("q-btn"),c=(0,l.g2)("router-link"),u=(0,l.g2)("q-icon"),d=(0,l.g2)("font-awesome-icon"),p=(0,l.g2)("q-item"),m=(0,l.g2)("q-list"),f=(0,l.g2)("q-menu"),h=(0,l.g2)("q-input"),b=(0,l.g2)("q-card-section"),k=(0,l.g2)("q-separator"),_=(0,l.g2)("q-toggle"),v=(0,l.g2)("q-select"),y=(0,l.g2)("q-btn-group"),F=(0,l.g2)("q-card"),w=(0,l.g2)("q-dialog"),C=(0,l.g2)("q-form"),L=(0,l.g2)("q-spinner-rings"),x=(0,l.g2)("q-img"),A=(0,l.g2)("q-item-section"),q=(0,l.g2)("q-page"),E=(0,l.g2)("atom-spinner"),I=(0,l.gN)("close-popup");return e.loadMatieresPremieres?((0,l.uX)(),(0,l.Wv)(q,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",un,[(0,l.Lk)("div",dn,[(0,l.Lk)("div",pn,[(0,l.Lk)("div",mn,[(0,l.Lk)("div",fn,[(0,l.bF)(h,{ref:"searchCatalogueInput",modelValue:i.searchCatalogueQuery,"onUpdate:modelValue":t[1]||(t[1]=e=>i.searchCatalogueQuery=e),label:"Importer...",color:"cyan-4",onInput:e.filterCatalogueMatieres,onMouseover:t[2]||(t[2]=e=>r.changeLabelColor("searchCatalogueInput","#ffb74d")),onMouseleave:t[3]||(t[3]=e=>r.changeLabelColor("searchCatalogueInput","")),onFocus:t[4]||(t[4]=e=>r.onFocus("searchCatalogueQuery","#4dd0e1")),onBlur:t[5]||(t[5]=e=>r.onBlur("searchCatalogueQuery"))},{before:(0,l.k6)((()=>[(0,l.bF)(c,{to:"/creation-matiere-premiere/"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{round:"",icon:"add_box",class:"glossy btn-cyan-pph"})])),_:1})])),append:(0,l.k6)((()=>[i.searchCatalogueQuery.length<1?((0,l.uX)(),(0,l.Wv)(u,{key:0,name:"search",style:{color:"#4dd0e1"}})):i.searchCatalogueQuery.length>=1&&r.filteredMatieresCatalogue.length>0?((0,l.uX)(),(0,l.Wv)(n,{key:1,size:"lg",onClick:e.toogleMenuMat,class:"hover-effect-success q-pa-xs",flat:""},{default:(0,l.k6)((()=>[(0,l.bF)(d,{icon:"fa-solid fa-magnifying-glass-plus","beat-fade":"",style:{color:"#a1d19b"}})])),_:1},8,["onClick"])):((0,l.uX)(),(0,l.Wv)(d,{key:2,icon:"fa-solid fa-magnifying-glass-plus",fade:"",style:{color:"#d59e9e"},size:"fa-md"}))])),default:(0,l.k6)((()=>[i.searchCatalogueQuery.length>=1?((0,l.uX)(),(0,l.Wv)(f,{key:0,modelValue:i.menuMat,"onUpdate:modelValue":t[0]||(t[0]=e=>i.menuMat=e),anchor:"bottom left"},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieresCatalogue,(e=>((0,l.uX)(),(0,l.Wv)(p,{key:e.id,clickable:"",onClick:t=>r.selectMatiere(e),class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.designation)+", "+(0,g.v_)(e.cdt)+" "+(0,g.v_)(e.qté)+(0,g.v_)(e.unite)+", "+(0,g.v_)(e.fournisseur.name)+", ref:"+(0,g.v_)(e.code_fournisseur),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])):(0,l.Q3)("",!0)])),_:1},8,["modelValue","onInput"]),(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)(w,{modelValue:i.addDialog,"onUpdate:modelValue":t[16]||(t[16]=e=>i.addDialog=e)},{default:(0,l.k6)((()=>[(0,l.bF)(F,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,null,{default:(0,l.k6)((()=>[hn,bn,(0,l.Lk)("div",gn,(0,g.v_)(i.selectedMatiere.designation)+" "+(0,g.v_)(i.selectedMatiere.cdt)+" "+(0,g.v_)(i.selectedMatiere.qté)+(0,g.v_)(i.selectedMatiere.unite)+" "+(0,g.v_)(i.selectedMatiere.fournisseur.name)+" ref:"+(0,g.v_)(i.selectedMatiere.code_fournisseur),1),kn,_n])),_:1}),(0,l.bF)(k),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",vn,[(0,l.Lk)("div",yn,[(0,l.bF)(h,{modelValue:i.nom,"onUpdate:modelValue":t[7]||(t[7]=e=>i.nom=e),label:"Désignation",color:"cyan-4",class:"hover-effect"},{prepend:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"",color:"cyan-4",class:"hover-effect-success",onClick:t[6]||(t[6]=e=>this.nom=this.selectedMatiere.designation)},{default:(0,l.k6)((()=>[(0,l.bF)(d,{size:"fa-sm",icon:"fa-solid fa-clone"})])),_:1})])),_:1},8,["modelValue"])])]),(0,l.Lk)("div",Fn,[(0,l.Lk)("div",wn,[(0,l.bF)(_,{modelValue:i.stockee,"onUpdate:modelValue":t[8]||(t[8]=e=>i.stockee=e),size:"md",icon:"inventory",label:"Stockée",color:"green-4"},null,8,["modelValue"])]),(0,l.Lk)("div",Cn,[(0,l.bF)(_,{modelValue:i.cde_auto,"onUpdate:modelValue":t[9]||(t[9]=e=>i.cde_auto=e),size:"md",icon:"list_alt",label:"Commande auto",color:"purple-4"},null,8,["modelValue"])])]),(0,l.Lk)("div",Ln,[(0,l.Lk)("div",xn,[(0,l.bF)(h,{label:"Liste",class:"hover-effect",color:"cyan-4",modelValue:i.tva,"onUpdate:modelValue":t[10]||(t[10]=e=>i.tva=e)},{append:(0,l.k6)((()=>[An])),_:1},8,["modelValue"])])]),(0,l.Lk)("div",qn,[(0,l.Lk)("div",En,[(0,l.bF)(v,{label:"Unité de mesure",class:"hover-effect",color:"cyan-4",modelValue:i.uniteMesure,"onUpdate:modelValue":t[11]||(t[11]=e=>i.uniteMesure=e),options:i.unitesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])]),(0,l.Lk)("div",In,[(0,l.bF)(v,{label:"Liste",class:"hover-effect",color:"cyan-4",modelValue:i.liste,"onUpdate:modelValue":t[12]||(t[12]=e=>i.liste=e),options:e.listesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])])]),(0,l.Lk)("div",Pn,[(0,l.Lk)("div",Sn,[(0,l.bF)(h,{modelValue:i.stock_mini,"onUpdate:modelValue":t[13]||(t[13]=e=>i.stock_mini=e),label:"Stock mini",color:"cyan-4"},{append:(0,l.k6)((()=>[(0,l.Lk)("div",Vn,(0,g.v_)(r.uniteStockNom),1)])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Qn,[(0,l.bF)(v,{label:"Forme",class:"hover-effect",color:"cyan-4",modelValue:i.forme,"onUpdate:modelValue":t[14]||(t[14]=e=>i.forme=e),options:e.formesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])])])])),_:1}),(0,l.bF)(k),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Mn,[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"",label:"Transférer",onClick:r.transfert,color:"green-4"},null,8,["onClick"]),(0,l.bF)(n,{flat:"",label:"Annuler",onClick:t[15]||(t[15]=e=>{i.addDialog=!1,this.searchCatalogueQuery=""}),color:"red-4"})])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])]),(0,l.Lk)("div",Tn,[(0,l.Lk)("div",Wn,(0,g.v_)(r.countMatieres)+" matières premières référencées ",1)]),(0,l.Lk)("div",Dn,[(0,l.bF)(h,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[17]||(t[17]=e=>i.searchQuery=e),label:"Recherche...",onInput:e.filterMatieres,color:"cyan-4",onMouseover:t[18]||(t[18]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[19]||(t[19]=e=>r.changeLabelColor("searchInput","")),onFocus:t[20]||(t[20]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[21]||(t[21]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(u,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",Rn,[(0,l.Lk)("div",Un,[(0,l.Lk)("div",Nn,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieres,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:t.id,onClick:e=>r.redirectToLink(t.id)},[(0,l.bF)(F,{bordered:"",class:(0,g.C4)(["card-maxi justify-center items-center text-center relative",{"bd-red-4":!t.stockee}])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",{onClick:e=>r.redirectToLink(t.id),class:"card-content"},[(0,l.bF)(x,{class:"logo-card-mini",src:Bl,loading:"lazy","spinner-color":"red-4",alt:t.type.nom},{loading:(0,l.k6)((()=>[(0,l.bF)(L,{color:"red-4"})])),default:(0,l.k6)((()=>["Conditionnement"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:0,icon:"fa-solid fa-prescription-bottle",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Principe actif"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:1,icon:"fa-solid fa-pills",size:"3x",class:"icon-background hover-effect"})):(0,l.Q3)("",!0),"Cosmétique"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:2,icon:"fa-solid fa-hand-holding-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Complément alimentaire"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:3,icon:"fa-solid fa-glass-water-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Technique"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:4,icon:"fa-solid fa-book-medical",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Alimentaire"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:5,icon:"fa-solid fa-bottle-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Excipient"===t.type.nom?((0,l.uX)(),(0,l.Wv)(d,{key:6,icon:"fa-solid fa-flask",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:(0,g.C4)(["absolute-top hover-effect q-my-none",{"text-cyan-1":t.stockee,"text-red-4":!t.stockee}])},[(0,l.Lk)("div",null,(0,g.v_)(t.nom),1),(0,l.Lk)("div",null,(0,g.v_)(t.forme.nom)+" "+(0,g.v_)(t.qté_cdt)+(0,g.v_)(t.unite_cdt),1),(0,l.Lk)("div",null,[t.qté_stock<t.stock_mini?((0,l.uX)(),(0,l.Wv)(d,{key:0,icon:"fa-solid fa-triangle-exclamation","beat-fade":"",size:"fa-xs",style:{color:"#e57373"}})):(0,l.Q3)("",!0),t.cde?((0,l.uX)(),(0,l.Wv)(u,{key:1,name:"fact_check",color:"orange-4",size:"xs"})):(0,l.Q3)("",!0),t.attente_livraison?((0,l.uX)(),(0,l.Wv)(u,{key:2,name:"fact_check",color:"green-4",size:"xs"})):(0,l.Q3)("",!0),(0,l.eW)(" Stock : "+(0,g.v_)(t.qté_stock)+(0,g.v_)(t.unite_mesure.nom),1)])],2)])),_:2},1032,["alt"]),(0,l.bF)(n,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(f,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(m,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(p,{clickable:"",onClick:(0,a.D$)((o=>e.toggleCde({matiereId:t.id,matiereName:t.nom,isCde:t.cde})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(A,{class:(0,g.C4)({"hover-effect-warning":t.cde,"hover-effect-success":!t.cde})},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.cde?"Retirer de la liste de commande":"Ajouter à la liste de commande"),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])),[[I]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(p,{clickable:"",onClick:(0,a.D$)((o=>e.toggleActivation({matiereId:t.id,isStockee:t.stockee})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(A,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.stockee?"Non Stockée":"Stockée"),1)])),_:2},1024)])),_:2},1032,["onClick"])),[[I]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])],8,On),(0,l.Lk)("div",jn,["Liste 1"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",$n,"1")):(0,l.Q3)("",!0),"Liste 2"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",Bn,"2")):(0,l.Q3)("",!0),"Stupéfiant"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",Hn,"S")):(0,l.Q3)("",!0)]),(0,l.Lk)("div",zn,[(0,l.Lk)("div",Gn,[t.froid?((0,l.uX)(),(0,l.Wv)(d,{key:0,fade:"",icon:"fa-solid fa-snowflake",class:"q-ml-xs fa-2x",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.cmr?((0,l.uX)(),(0,l.Wv)(x,{key:1,class:"q-ml-xs fade-blink",src:ri,style:{width:"20px",height:"20px"}})):(0,l.Q3)("",!0)])]),(0,l.bF)(y,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"bar_chart",size:"sm"}),(0,l.bF)(n,{class:"hover-effect",color:e.expanded[t.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((o=>e.toggleInfo(t.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(f,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[t.id],"onUpdate:modelValue":o=>e.expanded[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(m,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Détails ")])),_:1})])),_:1}),t.fournisseur?((0,l.uX)(),(0,l.Wv)(p,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Fournisseur : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.fournisseur.name),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.tva?((0,l.uX)(),(0,l.Wv)(p,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" TVA : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.tva)+"% ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.prix?((0,l.uX)(),(0,l.Wv)(p,{key:2},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prix : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.prix)+" € HT - "+(0,g.v_)(t.prix_ttc)+" € TTC ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.prix_unit?((0,l.uX)(),(0,l.Wv)(p,{key:3},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prix unitaire : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.prix_unit)+" €/"+(0,g.v_)(t.unite_mesure.nom)+" HT - "+(0,g.v_)(t.prix_unit_ttc)+" €/"+(0,g.v_)(t.unite_mesure.nom)+" TTC ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.stock_mini?((0,l.uX)(),(0,l.Wv)(p,{key:4},{default:(0,l.k6)((()=>[(0,l.bF)(A,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Stock mini : ")])),_:1}),(0,l.bF)(A,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.stock_mini)+(0,g.v_)(t.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["class"])],8,Xn)))),128))])])])])])])),_:1})):((0,l.uX)(),(0,l.Wv)(q,{key:1,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Kn,[(0,l.bF)(E,{class:"bg-op-8","animation-duration":1e3,size:200,color:"#ff1d5e"})])])),_:1}))}var Jn={name:"MatieresCards",components:{FontAwesomeIcon:sn.gc,AtomSpinner:il.F},data(){return{searchCatalogueQuery:"",searchQuery:"",addDialog:!1,menuMat:!1,selectedMatiere:null,nom:"",tva:"",stock_mini:"",stockee:!1,cde_auto:!1,uniteMesure:null,liste:null,forme:null,type:null,unitesOptions:[]}},computed:{...(0,u.L8)("matieresPremieres",["allMatieres","allMatieresCatalogue","allCategories","allUnites","allFormes","showMenu","expanded"]),...(0,u.L8)("formules",["allListes"]),countMatieres(){return Array.isArray(this.filteredMatieres)?this.filteredMatieres.length:0},filteredMatieres(){if(!Array.isArray(this.allMatieres))return[];const e=["Matériel & Articles de conditionnement"];return this.searchQuery?this.allMatieres.filter((t=>t.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase())&&e.includes(t.categorie.nom))):this.allMatieres.filter((t=>e.includes(t.categorie.nom)))},filteredMatieresCatalogue(){return this.searchCatalogueQuery?this.allMatieresCatalogue.filter((e=>e.designation.toLowerCase().startsWith(this.searchCatalogueQuery.toLowerCase()))):this.allMatieresCatalogue},uniteStockNom(){if(this.unite_mesure&&this.allUnites){const e=this.allUnites.find((e=>e.id===this.unite_mesure.id));return e?e.nom:""}return""}},async created(){await this.loadMatieresPremieres(),await this.loadMatieresPremieresCatalogue(),await this.loadCategoriesMatieres(),await this.loadUnites(),await this.loadListes(),await this.loadFormes(),this.unitesOptions=this.allUnites.map((e=>({label:e.nom,value:e.id}))),this.listesOptions=this.allListes.map((e=>({label:e.nom,value:e.id}))),this.formesOptions=this.allFormes.map((e=>({label:e.nom,value:e.id})))},methods:{...(0,u.i0)("matieresPremieres",["loadMatieresPremieres","loadCategoriesMatieres","loadMatieresPremieresCatalogue","deleteMatiere","loadUnites","loadFormes","addMatiere","toggleActivation","toggleMenuMat","toggleCde","toggleMenu","toggleInfo"]),...(0,u.i0)("formules",["loadListes"]),selectMatiere(e){this.searchCatalogueQuery=e.designation,this.selectedMatiere={...e},this.menuMat=!1,this.addDialog=!0},async transfert(){const e={nom:this.nom,type:this.selectedMatiere.type.id,"qté_cdt":this.selectedMatiere.qté,unite_mesure:this.uniteMesure.value,fournisseur:this.selectedMatiere.fournisseur.id,prix:this.selectedMatiere.prix,tva:this.tva,stock_mini:this.stock_mini,"qté_stock":0,cdt:1,froid:this.selectedMatiere.froid,cmr:this.selectedMatiere.cmr,liste:this.liste.value,forme:this.forme.value,stockee:this.stockee,ean:this.selectedMatiere.cip,code_fournisseur:this.selectedMatiere.code_fournisseur,unite_cdt:this.selectedMatiere.unite};this.addMatiere(e),await this.loadMatieresPremieres(),this.selectedMatiere=null,this.searchCatalogueQuery="",this.nom="",this.stock_mini="",this.tva="",this.stockee=!1,this.cde_auto=!1,this.uniteMesure=null,this.liste=null,this.forme=null,this.type=null,this.addDialog=!1},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/matiere/${e}`)}}};const Zn=(0,m.A)(Jn,[["render",Yn]]);var ec=Zn;E()(Jn,"components",{QPage:Qe.A,QInput:Ae.A,QBtn:v.A,QIcon:x.A,QMenu:y.A,QList:F.A,QItem:w.A,QForm:xe.A,QDialog:we.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A,QToggle:mr.A,QSelect:Fs.A,QBtnGroup:Y.A,QImg:ns.A,QSpinnerRings:cs.A,QItemSection:C.A,QField:Qa.A}),E()(Jn,"directives",{ClosePopup:A.A});const tc=e=>((0,l.Qi)("data-v-1cbbe3a1"),e=e(),(0,l.jt)(),e),oc={class:"row justify-center"},ac={class:"row justify-center"},lc={class:"col-md-12"},sc={class:"row q-mx-sm"},ic={class:"col-1 q-mt-md"},rc=tc((()=>(0,l.Lk)("div",{class:"row text-h6 text-cyan-4 justify-center"}," Importer un catalogue Excel ",-1))),nc=tc((()=>(0,l.Lk)("div",{class:"row text-subtitle1 text-orange-4"}," Données du catalogue ",-1))),cc={class:"row"},uc={class:"col-12"},dc={class:"row"},pc={class:"col-6"},mc={class:"col-5 offset-1"},fc=tc((()=>(0,l.Lk)("div",{class:"row text-subtitle1 text-orange-4"}," Plage d'extraction ",-1))),hc={class:"row"},bc={class:"col-4"},gc={class:"col-4 offset-1"},kc={class:"row"},_c={class:"col-4"},vc={class:"col-4 offset-1"},yc={class:"row justify-center"},Fc=tc((()=>(0,l.Lk)("div",{class:"row text-cyan-4 justify-center text-h6"}," Importer un catalogue Excel ",-1))),wc=tc((()=>(0,l.Lk)("div",{class:"row text-orange-4 justify-center text-subtitle2"}," Données a importer ",-1))),Cc={class:"row"},Lc={class:"col"},xc=["onDragenter","onDragleave"],Ac=tc((()=>(0,l.Lk)("div",{class:"row text-orange-4 justify-center text-subtitle2"}," Colonnes du fichier Excel ",-1))),qc={class:"items"},Ec=["onDragstart"],Ic={class:"row justify-center"},Pc=tc((()=>(0,l.Lk)("div",{class:"row text-h6 text-cyan-4 justify-center"}," Importer un catalogue ",-1))),Sc=tc((()=>(0,l.Lk)("div",{class:"row text-subtitle1 text-orange-4"}," Données du catalogue ",-1))),Vc={class:"row"},Qc={class:"col-12"},Mc={class:"row"},Tc={class:"col-6"},Wc={class:"col-5 offset-1"},Dc=tc((()=>(0,l.Lk)("div",{class:"row text-subtitle1 text-orange-4"}," Plage d'extraction ",-1))),Rc={class:"row"},Uc={class:"col-4"},Nc={class:"col-4 offset-1"},Xc={class:"row"},Oc={class:"col-4"},jc={class:"col-4 offset-1"},$c={class:"row justify-center"},Bc={class:"col-6 offset-2 q-mt-md text-cyan-4 text-h6"},Hc={class:"row justify-center"},zc={class:"col-2 offset-1"},Gc={class:"row q-mt-sm"},Kc={class:"col-12 justify-center"},Yc={key:0,class:"row justify-start"},Jc=["onClick"],Zc={class:"absolute-top hover-effect q-my-none text-cyan-1"},eu={key:0,class:"absolute-bottom-left"},tu={key:1,class:"row"},ou=tc((()=>(0,l.Lk)("div",{class:"row"},[(0,l.Lk)("div",{class:"col-3 text-center"},"Désignation"),(0,l.Lk)("div",{class:"col-1 text-center"},"Conditionnement"),(0,l.Lk)("div",{class:"col-1 text-center"},"Prix HT"),(0,l.Lk)("div",{class:"col-2 text-center"},"Ref fournisseur"),(0,l.Lk)("div",{class:"col-2 text-center"},"EAN"),(0,l.Lk)("div",{class:"col-1 text-center"},"Fournisseur")],-1))),au=tc((()=>(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," Intégrer ",-1))),lu=tc((()=>(0,l.Lk)("br",null,null,-1))),su={class:"row justify-center text-subtitle1 text-orange-4"},iu=tc((()=>(0,l.Lk)("br",null,null,-1))),ru=tc((()=>(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," aux matières premières ",-1))),nu={class:"row"},cu={class:"col-12"},uu={class:"row"},du={class:"col-6"},pu={class:"col-6"},mu={class:"row"},fu={class:"col-5"},hu={class:"col-5 offset-1"},bu={class:"row"},gu={class:"col-5"},ku={class:"uniteStockName text-subtitle2 text-cyan-4"},_u={class:"col-5 offset-1"},vu={class:"row justify-center"};function yu(e,t,o,s,i,r){const n=(0,l.g2)("atom-spinner"),c=(0,l.g2)("q-page"),u=(0,l.g2)("q-fab-action"),d=(0,l.g2)("q-card-section"),p=(0,l.g2)("q-separator"),m=(0,l.g2)("q-file"),f=(0,l.g2)("q-select"),h=(0,l.g2)("q-input"),b=(0,l.g2)("q-btn"),k=(0,l.g2)("q-btn-group"),_=(0,l.g2)("q-card"),v=(0,l.g2)("q-dialog"),y=(0,l.g2)("q-splitter"),F=(0,l.g2)("q-card-actions"),w=(0,l.g2)("q-form"),C=(0,l.g2)("q-fab"),L=(0,l.g2)("q-icon"),x=(0,l.g2)("q-spinner-rings"),A=(0,l.g2)("q-img"),q=(0,l.g2)("q-item-label"),E=(0,l.g2)("q-item-section"),I=(0,l.g2)("font-awesome-icon"),P=(0,l.g2)("q-item"),S=(0,l.g2)("q-list"),V=(0,l.g2)("q-toggle");return e.isLoading?((0,l.uX)(),(0,l.Wv)(c,{key:0,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",oc,[(0,l.bF)(n,{class:"bg-op-8","animation-duration":1e3,size:200,color:"#ff1d5e"})])])),_:1})):((0,l.uX)(),(0,l.Wv)(c,{key:1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ac,[(0,l.Lk)("div",lc,[(0,l.Lk)("div",sc,[(0,l.Lk)("div",ic,[(0,l.bF)(C,{size:"sm",glossy:"",class:"btn-cyan-pph",icon:"add_box",direction:"right"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"","external-label":"","label-position":"bottom",label:"Excel",color:"cyan-4",class:"hover-effect",onClick:t[0]||(t[0]=e=>i.importCatalogueExcel=!0),icon:"playlist_add"}),(0,l.bF)(u,{flat:"","external-label":"","label-position":"bottom",label:"PDF",color:"cyan-4",class:"hover-effect",onClick:t[1]||(t[1]=e=>i.importCatalogue=!0),icon:"post_add"}),(0,l.bF)(u,{flat:"","external-label":"","label-position":"bottom",label:"Site",color:"cyan-4",class:"hover-effect",onClick:t[2]||(t[2]=e=>i.selectColumns=!0),icon:"add_business"}),(0,l.bF)(w,{enctype:"multipart/form-data"},{default:(0,l.k6)((()=>[(0,l.bF)(v,{modelValue:i.importCatalogueExcel,"onUpdate:modelValue":t[12]||(t[12]=e=>i.importCatalogueExcel=e)},{default:(0,l.k6)((()=>[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[rc])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[nc,(0,l.Lk)("div",cc,[(0,l.Lk)("div",uc,[(0,l.bF)(m,{label:"Sélectionner un fichier.xls",accept:".xls",modelValue:i.selectedFile,"onUpdate:modelValue":t[3]||(t[3]=e=>i.selectedFile=e)},null,8,["modelValue"])])]),(0,l.Lk)("div",dc,[(0,l.Lk)("div",pc,[(0,l.bF)(f,{label:"Fournisseur",color:"cyan-4",modelValue:i.selectedSupplier,"onUpdate:modelValue":t[4]||(t[4]=e=>i.selectedSupplier=e),options:i.suppliersOptions,"options-label":"label","options-value":"value",onInput:r.onSupplierChange},null,8,["modelValue","options","onInput"])]),(0,l.Lk)("div",mc,[(0,l.bF)(f,{label:"Catégorie",color:"cyan-4",modelValue:i.selectedCategory,"onUpdate:modelValue":t[5]||(t[5]=e=>i.selectedCategory=e),options:i.categoriesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])])])])),_:1}),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[fc,(0,l.Lk)("div",hc,[(0,l.Lk)("div",bc,[(0,l.bF)(h,{label:"Page de début",modelValue:i.pageDebut,"onUpdate:modelValue":t[6]||(t[6]=e=>i.pageDebut=e),color:"cyan-4"},null,8,["modelValue"])]),(0,l.Lk)("div",gc,[(0,l.bF)(h,{label:"Page de fin",modelValue:i.pageFin,"onUpdate:modelValue":t[7]||(t[7]=e=>i.pageFin=e),color:"cyan-4"},null,8,["modelValue"])])]),(0,l.Lk)("div",kc,[(0,l.Lk)("div",_c,[(0,l.bF)(h,{label:"Code CPF de début",modelValue:i.codeDebut,"onUpdate:modelValue":t[8]||(t[8]=e=>i.codeDebut=e),color:"cyan-4",mask:i.maskFormat},null,8,["modelValue","mask"])]),(0,l.Lk)("div",vc,[(0,l.bF)(h,{label:"Code CPF de fin",modelValue:i.codeFin,"onUpdate:modelValue":t[9]||(t[9]=e=>i.codeFin=e),color:"cyan-4",mask:i.maskFormat},null,8,["modelValue","mask"])])])])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",yc,[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",label:"Importer",onClick:r.importer,color:"green-4"},null,8,["onClick"]),(0,l.bF)(b,{flat:"",label:"Colonnes",onClick:t[10]||(t[10]=t=>{i.importCatalogueExcel=!1,e.SelectColumns=!0}),color:"green-4"}),(0,l.bF)(b,{flat:"",label:"Annuler",onClick:t[11]||(t[11]=e=>i.importCatalogue=!1),color:"red-4"})])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.bF)(v,{modelValue:i.selectColumns,"onUpdate:modelValue":t[17]||(t[17]=e=>i.selectColumns=e)},{default:(0,l.k6)((()=>[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[Fc,(0,l.bF)(p),(0,l.bF)(y,{horizontal:""},{after:(0,l.k6)((()=>[wc,(0,l.Lk)("div",Cc,[(0,l.Lk)("div",Lc,[(0,l.Lk)("div",{class:"drop-target",onDragover:t[13]||(t[13]=(...e)=>r.onDragOver&&r.onDragOver(...e)),onDrop:t[14]||(t[14]=(...e)=>r.onDrop&&r.onDrop(...e))},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.labels,((e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:t,class:(0,g.C4)(["label q-mx-xs",{active:r.isLabelActive(e)}]),onDragenter:t=>r.onLabelDragEnter(e),onDragleave:t=>r.onLabelDragLeave(e)},(0,g.v_)(e),43,xc)))),128))],32)])])])),before:(0,l.k6)((()=>[Ac,(0,l.Lk)("div",qc,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.items,((e,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o,class:"item q-mx-xsm run",draggable:!0,onDragstart:e=>r.onDragStart(o),onDragend:t[15]||(t[15]=(...e)=>r.onDragEnd&&r.onDragEnd(...e))},(0,g.v_)(e),41,Ec)))),128))])])),_:1}),(0,l.bF)(p),(0,l.Lk)("div",Ic,[(0,l.bF)(F,null,{default:(0,l.k6)((()=>[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",label:"Importer",onClick:e.transfert,color:"green-4"},null,8,["onClick"]),(0,l.bF)(b,{flat:"",label:"Annuler",onClick:t[16]||(t[16]=e=>i.selectColumns=!1),color:"red-4"})])),_:1})])),_:1})])])),_:1})])),_:1},8,["modelValue"]),(0,l.bF)(v,{modelValue:i.importCatalogue,"onUpdate:modelValue":t[26]||(t[26]=e=>i.importCatalogue=e)},{default:(0,l.k6)((()=>[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[Pc])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[Sc,(0,l.Lk)("div",Vc,[(0,l.Lk)("div",Qc,[(0,l.bF)(m,{label:"Sélectionner un fichier.pdf",accept:".pdf",modelValue:i.selectedFile,"onUpdate:modelValue":t[18]||(t[18]=e=>i.selectedFile=e)},null,8,["modelValue"])])]),(0,l.Lk)("div",Mc,[(0,l.Lk)("div",Tc,[(0,l.bF)(f,{label:"Fournisseur",color:"cyan-4",modelValue:i.selectedSupplier,"onUpdate:modelValue":t[19]||(t[19]=e=>i.selectedSupplier=e),options:i.suppliersOptions,"options-label":"label","options-value":"value",onInput:r.onSupplierChange},null,8,["modelValue","options","onInput"])]),(0,l.Lk)("div",Wc,[(0,l.bF)(f,{label:"Catégorie",color:"cyan-4",modelValue:i.selectedCategory,"onUpdate:modelValue":t[20]||(t[20]=e=>i.selectedCategory=e),options:i.categoriesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])])])])),_:1}),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[Dc,(0,l.Lk)("div",Rc,[(0,l.Lk)("div",Uc,[(0,l.bF)(h,{label:"Page de début",modelValue:i.pageDebut,"onUpdate:modelValue":t[21]||(t[21]=e=>i.pageDebut=e),color:"cyan-4"},null,8,["modelValue"])]),(0,l.Lk)("div",Nc,[(0,l.bF)(h,{label:"Page de fin",modelValue:i.pageFin,"onUpdate:modelValue":t[22]||(t[22]=e=>i.pageFin=e),color:"cyan-4"},null,8,["modelValue"])])]),(0,l.Lk)("div",Xc,[(0,l.Lk)("div",Oc,[(0,l.bF)(h,{label:"Code CPF de début",modelValue:i.codeDebut,"onUpdate:modelValue":t[23]||(t[23]=e=>i.codeDebut=e),color:"cyan-4",mask:i.maskFormat},null,8,["modelValue","mask"])]),(0,l.Lk)("div",jc,[(0,l.bF)(h,{label:"Code CPF de fin",modelValue:i.codeFin,"onUpdate:modelValue":t[24]||(t[24]=e=>i.codeFin=e),color:"cyan-4",mask:i.maskFormat},null,8,["modelValue","mask"])])])])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",$c,[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",label:"Importer",onClick:r.importer,color:"green-4"},null,8,["onClick"]),(0,l.bF)(b,{flat:"",label:"Annuler",onClick:t[25]||(t[25]=e=>i.importCatalogue=!1),color:"red-4"})])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})]),(0,l.Lk)("div",Bc,[(0,l.Lk)("div",Hc,[(0,l.eW)((0,g.v_)(r.countMatieresCatalogue)+" matières premières disponibles ",1),(0,l.bF)(b,{flat:"",size:"md",onClick:t[27]||(t[27]=e=>i.toggleCard=!i.toggleCard),icon:i.toggleCard?"list":"grid_view"},null,8,["icon"])])]),(0,l.Lk)("div",zc,[(0,l.bF)(h,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[28]||(t[28]=e=>i.searchQuery=e),label:"Recherche...",onInput:e.filterMatieres,color:"cyan-4",onMouseover:t[29]||(t[29]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[30]||(t[30]=e=>r.changeLabelColor("searchInput","")),onFocus:t[31]||(t[31]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[32]||(t[32]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(L,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",Gc,[(0,l.Lk)("div",Kc,[i.toggleCard?((0,l.uX)(),(0,l.CE)("div",Yc,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieres,(e=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:e.id,onClick:t=>r.redirectToLink(e.id)},[(0,l.bF)(_,{bordered:"",class:"card-maxi justify-center items-center text-center relative"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.bF)(A,{class:"logo-card-mini",src:Bl,loading:"lazy","spinner-color":"red-4",alt:e.designation},{loading:(0,l.k6)((()=>[(0,l.bF)(x,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.bF)(L,{name:"Cooper"===e.fournisseur.name?"copyright":"info",class:"icon-background"},null,8,["name"]),(0,l.Lk)("div",Zc,[(0,l.Lk)("div",null,(0,g.v_)(e.designation),1),(0,l.Lk)("div",null,(0,g.v_)(e.prix)+"€ - "+(0,g.v_)(e.qté)+(0,g.v_)(e.unite),1),(0,l.Lk)("div",null,"Ref fournisseur : "+(0,g.v_)(e.code_fournisseur),1),(0,l.Lk)("div",null,"EAN : "+(0,g.v_)(e.cip),1)])])),_:2},1032,["alt"])]),e.cmr?((0,l.uX)(),(0,l.CE)("div",eu,[e.cmr?((0,l.uX)(),(0,l.Wv)(A,{key:0,class:"q-ml-xs q-mb-xs fade-blink",src:ri,style:{width:"30px",height:"30px"}})):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0),(0,l.bF)(k,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"add_box",onClick:(0,a.D$)((t=>r.openDialog(e)),["stop"])},null,8,["onClick"])])),_:2},1024)])),_:2},1024)],8,Jc)))),128))])):((0,l.uX)(),(0,l.CE)("div",tu,[(0,l.bF)(S,{bordered:"",class:"col-12 bg-white bg-op-8"},{default:(0,l.k6)((()=>[ou,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieres,(e=>((0,l.uX)(),(0,l.Wv)(P,{class:"row hover-effect",key:e.id,clickable:"",onClick:t=>r.redirectToLink(e.id)},{default:(0,l.k6)((()=>[(0,l.bF)(E,{class:"col-3"},{default:(0,l.k6)((()=>[(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.designation),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(E,{class:"col-1 text-center"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.qté)+(0,g.v_)(e.unite),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(E,{class:"col-1 text-center"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.prix)+"€",1)])),_:2},1024)])),_:2},1024),(0,l.bF)(E,{class:"col-2 text-center"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.code_fournisseur),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(E,{class:"col-2 text-center"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.cip),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(E,{class:"col-1 text-center"},{default:(0,l.k6)((()=>[(0,l.bF)(q,{caption:""},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.fournisseur.name),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(E,{class:"col-1 text-center"},{default:(0,l.k6)((()=>[e.cmr?((0,l.uX)(),(0,l.Wv)(I,{key:0,fade:"",size:"fa-lg",icon:"fa-solid fa-skull-crossbones",style:{color:"#e57373"},class:"q-ml-md"})):(0,l.Q3)("",!0)])),_:2},1024),(0,l.bF)(E,{class:"col-1"},{default:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",icon:"add_box",color:"cyan-4",onClick:(0,a.D$)((t=>r.openDialog(e)),["stop"])},null,8,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),(0,l.bF)(w,null,{default:(0,l.k6)((()=>[(0,l.bF)(v,{modelValue:e.addMatiereCat,"onUpdate:modelValue":t[42]||(t[42]=t=>e.addMatiereCat=t)},{default:(0,l.k6)((()=>[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[au,lu,(0,l.Lk)("div",su,(0,g.v_)(i.selectedMatiere.designation)+" "+(0,g.v_)(i.selectedMatiere.cdt)+" "+(0,g.v_)(i.selectedMatiere.qté)+(0,g.v_)(i.selectedMatiere.unite)+" "+(0,g.v_)(i.selectedMatiere.fournisseur.name)+" ref:"+(0,g.v_)(i.selectedMatiere.code_fournisseur),1),iu,ru])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",nu,[(0,l.Lk)("div",cu,[(0,l.bF)(h,{modelValue:e.nom,"onUpdate:modelValue":t[34]||(t[34]=t=>e.nom=t),label:"Désignation",color:"cyan-4",class:"hover-effect"},{prepend:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",color:"cyan-4",class:"hover-effect-success",onClick:t[33]||(t[33]=e=>this.nom=this.selectedMatiere.designation)},{default:(0,l.k6)((()=>[(0,l.bF)(I,{size:"fa-sm",icon:"fa-solid fa-clone"})])),_:1})])),_:1},8,["modelValue"])])]),(0,l.Lk)("div",uu,[(0,l.Lk)("div",du,[(0,l.bF)(V,{modelValue:e.stockee,"onUpdate:modelValue":t[35]||(t[35]=t=>e.stockee=t),size:"md",icon:"inventory",label:"Stockée",color:"green-4"},null,8,["modelValue"])]),(0,l.Lk)("div",pu,[(0,l.bF)(V,{modelValue:e.cde_auto,"onUpdate:modelValue":t[36]||(t[36]=t=>e.cde_auto=t),size:"md",icon:"list_alt",label:"Commande auto",color:"purple-4"},null,8,["modelValue"])])]),(0,l.Lk)("div",mu,[(0,l.Lk)("div",fu,[(0,l.bF)(f,{label:"Unité de mesure",class:"hover-effect",color:"cyan-4",modelValue:e.uniteMesure,"onUpdate:modelValue":t[37]||(t[37]=t=>e.uniteMesure=t),options:e.unitesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])]),(0,l.Lk)("div",hu,[(0,l.bF)(f,{label:"Liste",class:"hover-effect",color:"cyan-4",modelValue:e.liste,"onUpdate:modelValue":t[38]||(t[38]=t=>e.liste=t),options:e.listesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])])]),(0,l.Lk)("div",bu,[(0,l.Lk)("div",gu,[(0,l.bF)(h,{modelValue:e.stock_mini,"onUpdate:modelValue":t[39]||(t[39]=t=>e.stock_mini=t),label:"Stock mini",color:"cyan-4"},{append:(0,l.k6)((()=>[(0,l.Lk)("div",ku,(0,g.v_)(e.uniteStockNom),1)])),_:1},8,["modelValue"])]),(0,l.Lk)("div",_u,[(0,l.bF)(f,{label:"Forme",class:"hover-effect",color:"cyan-4",modelValue:e.forme,"onUpdate:modelValue":t[40]||(t[40]=t=>e.forme=t),options:e.formesOptions,"options-label":"label","options-value":"value"},null,8,["modelValue","options"])])])])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",vu,[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{flat:"",label:"Transférer",onClick:e.transfert,color:"green-4"},null,8,["onClick"]),(0,l.bF)(b,{flat:"",label:"Annuler",onClick:t[41]||(t[41]=t=>e.addMatiereCat=!1),color:"red-4"})])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})]))])])])])])),_:1}))}var Fu={name:"MatieresCatalogueCards",components:{AtomSpinner:il.F},data(){return{toggleCard:!0,showing:!0,items:["Item 1","Item 2","Item 3","Item 4","Item 5"],labels:["Nom","Code fournisseur","CIP/EAN","Prix"],activeLabel:null,selectColumns:!1,importCatalogueExcel:!1,importCatalogue:!1,searchQuery:"",currentPage:1,perPage:24,addDialog:!1,selectedFile:null,selectedMatiere:null,selectedSupplier:null,selectedCategory:null,pageDebut:"",pageFin:"",codeDebut:"",codeFin:"",suppliersOptions:[],categoriesOptions:[],maskFormat:"# ### ###"}},computed:{...(0,u.L8)("matieresPremieres",["allMatieresCatalogue","allCategories","showMenu","expanded","loadingMatieres"]),...(0,u.L8)("suppliers",["allSuppliers"]),...(0,u.L8)("spinner",["isLoading"]),countMatieresCatalogue(){return this.allMatieresCatalogue.length},filteredMatieres(){let e=(this.currentPage-1)*this.perPage,t=this.currentPage*this.perPage,o=this.allMatieresCatalogue;return this.searchQuery&&(o=o.filter((e=>e.designation.toLowerCase().startsWith(this.searchQuery.toLowerCase())))),o.slice(e,t)}},async mounted(){await this.loadMatieresPremieresCatalogue(),await this.loadCategoriesMatieres(),await this.loadSuppliers(),this.showing=!1,this.suppliersOptions=this.allSuppliers.filter((e=>!0===e.download_catalogue)).map((e=>({label:e.name,value:e.id}))),window.addEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)},watch:{selectedSupplier:"onSupplierChange"},methods:{...(0,u.i0)("matieresPremieres",["loadMatieresPremieresCatalogue","loadCategoriesMatieres","addImport","toggleActivation","toggleMenu","toggleInfo"]),...(0,u.i0)("suppliers",["loadSuppliers"]),onDragStart(e){event.dataTransfer.setData("text/plain",e)},onDragEnd(){this.activeLabel=null},onLabelDragEnter(e){this.activeLabel=e},onLabelDragLeave(e){this.activeLabel===e&&(this.activeLabel=null)},onDragOver(e){e.preventDefault()},onDrop(e){e.preventDefault();const t=e.dataTransfer.getData("text/plain");null!==this.activeLabel&&(this.labels[this.labels.indexOf(this.activeLabel)]=`${this.activeLabel}: ${this.items[t]}`,this.items.splice(t,1))},isLabelActive(e){return this.activeLabel===e},onSupplierChange(){console.log("suuplierId",this.selectedSupplier),this.selectedSupplier?this.categoriesOptions=this.allCategories.filter((e=>e.fournisseur.id===this.selectedSupplier.value)).map((e=>({label:e.nom,value:e.id}))):this.categoriesOptions=this.allCategories.map((e=>({label:e.nom,value:e.id})))},openDialog(e){this.selectedMatiere={...e},this.addDialog=!0},importer(){console.log("Le formulaire est soumis");const e={pdf:this.selectedFile,fournisseur:this.selectedSupplier.value,categorie:this.selectedCategory.value,page_debut:this.pageDebut,page_fin:this.pageFin,code_debut:this.codeDebut,code_fin:this.codeFin,data_source:"PDF"};console.log(e),this.addImport(e).then((()=>{this.importCatalogue=!1,this.loadMatieresPremieresCatalogue()}))},handleScroll(){let e=document.documentElement.scrollTop+window.innerHeight===document.documentElement.offsetHeight;e&&this.loadMore()},loadMore(){this.currentPage++},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/matiere/${e}`)}}},wu=o(3901),Cu=o(1667);const Lu=(0,m.A)(Fu,[["render",yu],["__scopeId","data-v-1cbbe3a1"]]);var xu=Lu;E()(Fu,"components",{QPage:Qe.A,QFab:fe.A,QFabAction:he.A,QForm:xe.A,QDialog:we.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A,QFile:wu.A,QSelect:Fs.A,QInput:Ae.A,QBtnGroup:Y.A,QBtn:v.A,QSplitter:ir.A,QCardActions:Cu.A,QIcon:x.A,QImg:ns.A,QSpinnerRings:cs.A,QList:F.A,QItem:w.A,QItemSection:C.A,QItemLabel:dr.A,QToggle:mr.A,QField:Qa.A});const Au={class:"q-pa-md"},qu={key:0,class:"text-h5 text-center text-cyan-4"},Eu={key:1,class:"text-h5 text-center text-cyan-4"},Iu={class:"row"},Pu={class:"row"},Su={class:"row"},Vu={class:"row"},Qu={class:"row"},Mu={class:"q-pa-md q-gutter-sm"},Tu={class:"row"},Wu={class:"col-12"},Du={class:"row"},Ru={class:"col-8"},Uu={class:"row"},Nu={class:"col-12"},Xu={class:"row"},Ou={class:"row"},ju={class:"row"},$u={class:"col-2"},Bu={class:"row justify-center"},Hu={class:"row justify-center"};function zu(e,t,o,a,s,i){const r=(0,l.g2)("q-icon"),n=(0,l.g2)("q-input"),c=(0,l.g2)("q-select"),u=(0,l.g2)("q-toggle"),d=(0,l.g2)("q-btn"),p=(0,l.g2)("q-stepper-navigation"),m=(0,l.g2)("q-step"),f=(0,l.g2)("ArticlesForm"),h=(0,l.g2)("ParametresForm"),b=(0,l.g2)("CompositionForm"),k=(0,l.g2)("EpiForm"),_=(0,l.g2)("EtapesForm"),v=(0,l.g2)("ControlesForm"),y=(0,l.g2)("q-btn-group"),F=(0,l.g2)("q-stepper"),w=(0,l.g2)("q-page"),C=(0,l.g2)("atom-spinner");return s.loading?((0,l.uX)(),(0,l.Wv)(w,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Au,[(0,l.bF)(F,{modelValue:s.step,"onUpdate:modelValue":t[52]||(t[52]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[s.formuleId?((0,l.uX)(),(0,l.CE)("div",qu,(0,g.v_)(s.formule.nom),1)):((0,l.uX)(),(0,l.CE)("div",Eu,"Nouvelle Formule")),(0,l.bF)(m,{name:1,title:"Identification",icon:"info",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Iu,[(0,l.bF)(n,{ref:"nomInput",class:"q-mr-lg col-3",modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.name=e),label:"Nom de la formule",color:"cyan-4",onMouseover:t[1]||(t[1]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[2]||(t[2]=t=>e.changeLabelColor("nameInput","")),onFocus:t[3]||(t[3]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[4]||(t[4]=t=>e.onBlur("name"))},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"local_pharmacy",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(c,{modelValue:s.typePrep,"onUpdate:modelValue":t[5]||(t[5]=e=>s.typePrep=e),color:"cyan-4",class:"col-3 hover-effect",label:"Type de préparation",options:s.typesPrep,"option-label":"nom","option-value":"id"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"local_pharmacy",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",Pu,[(0,l.bF)(c,{modelValue:s.liste,"onUpdate:modelValue":t[6]||(t[6]=e=>s.liste=e),color:"cyan-4",class:"col-2 hover-effect",label:"Liste",options:s.listes,"option-label":"nom","option-value":"id"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"gavel",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",Su,[(0,l.bF)(u,{class:"col-2 q-mt-sm",modelValue:s.hospital,"onUpdate:modelValue":t[7]||(t[7]=e=>s.hospital=e),label:"Préparation hospitalière",size:"md",color:"purple-4",icon:"account_child"},null,8,["modelValue"]),(0,l.bF)(u,{class:"col-2 offset-1 q-mt-sm",modelValue:s.pediatric,"onUpdate:modelValue":t[8]||(t[8]=e=>s.pediatric=e),label:"Formule pédiatrique",size:"md",color:"red-4",icon:"account_child"},null,8,["modelValue"])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[9]||(t[9]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:2,title:"Voie d'administration",icon:"vaccines",done:s.step>2},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Vu,[(0,l.bF)(c,{modelValue:s.voie,"onUpdate:modelValue":t[10]||(t[10]=e=>s.voie=e),color:"cyan-4",class:"col-3 hover-effect",label:"Sélectionnez la voie",options:s.voies,"option-label":"nom","option-value":"id"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"vaccines",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[11]||(t[11]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[12]||(t[12]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:3,title:"Conservation",icon:"ac_unit",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Qu,[(0,l.bF)(n,{ref:"dureeInput",class:"my-0 col-1",modelValue:s.duree,"onUpdate:modelValue":t[13]||(t[13]=e=>s.duree=e),label:"Durée (j)",color:"cyan-4",onMouseover:t[14]||(t[14]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[15]||(t[15]=t=>e.changeLabelColor("nameInput","")),onFocus:t[16]||(t[16]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[17]||(t[17]=t=>e.onBlur("name"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"alarm",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Mu,[(0,l.Lk)("div",null,[(0,l.bF)(u,{modelValue:s.froid,"onUpdate:modelValue":t[18]||(t[18]=e=>s.froid=e),color:"cyan-4",icon:"ac_unit",label:"4°C - 8°C",size:"md"},null,8,["modelValue"]),(0,l.bF)(u,{modelValue:s.lumiere,"onUpdate:modelValue":t[19]||(t[19]=e=>s.lumiere=e),color:"yellow-4",icon:"light_mode",label:"Abris de la lumiere",size:"md"},null,8,["modelValue"]),(0,l.bF)(u,{modelValue:s.agiter,"onUpdate:modelValue":t[20]||(t[20]=e=>s.agiter=e),color:"red-4",icon:"waving_hand",label:"Agiter avant emploi",size:"md"},null,8,["modelValue"])])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[21]||(t[21]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[22]||(t[22]=e=>s.step=4),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:4,title:"Matériel",icon:"biotech",done:s.step>4},{default:(0,l.k6)((()=>[4===s.step?((0,l.uX)(),(0,l.Wv)(f,{key:0,newId:s.newId,formuleId:s.formuleId,onArticlesRows:i.rowsArticles,articlesRows:s.articlesRows},null,8,["newId","formuleId","onArticlesRows","articlesRows"])):(0,l.Q3)("",!0),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[23]||(t[23]=e=>s.step=3),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[24]||(t[24]=e=>s.step=5),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:5,title:"Paramètres",icon:"settings",done:s.step>5},{default:(0,l.k6)((()=>[5===s.step?((0,l.uX)(),(0,l.Wv)(h,{key:0,newId:s.newId,formuleId:s.formuleId,onParametresRows:i.rowsParametres,parametresRows:s.parametresRows},null,8,["newId","formuleId","onParametresRows","parametresRows"])):(0,l.Q3)("",!0),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[25]||(t[25]=e=>s.step=4),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[26]||(t[26]=e=>s.step=6),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:6,title:"Composition",icon:"science",done:s.step>6},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Tu,[(0,l.Lk)("div",Wu,[(0,l.bF)(b,{newId:s.newId,formuleId:s.formuleId,typesAppareils:s.typesAppareils,parametresRows:s.parametresRows,name:s.name,prep:s.typePrep,compoRows:s.compoRows,onCompoRows:i.rowsCompo},null,8,["newId","formuleId","typesAppareils","parametresRows","name","prep","compoRows","onCompoRows"])])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[27]||(t[27]=e=>s.step=5),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[28]||(t[28]=e=>s.step=7),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:7,title:"EPI",icon:"masks",done:s.step>7},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Du,[(0,l.Lk)("div",Ru,[7===s.step?((0,l.uX)(),(0,l.Wv)(k,{key:0,newId:s.newId,formuleId:s.formuleId,episRows:s.episRows,onEpisRows:i.rowsEpis},null,8,["newId","formuleId","episRows","onEpisRows"])):(0,l.Q3)("",!0)])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[29]||(t[29]=e=>s.step=6),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[30]||(t[30]=e=>s.step=8),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:8,title:"Mode opératoire",icon:"list_alt",done:s.step>8},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Uu,[(0,l.Lk)("div",Nu,[8===s.step?((0,l.uX)(),(0,l.Wv)(_,{key:0,newId:s.newId,formuleId:s.formuleId,name:s.name,prep:s.typePrep,compoRows:s.compoRows,onEtapesRows:i.rowsEtapes,etapesRows:s.etapesRows},null,8,["newId","formuleId","name","prep","compoRows","onEtapesRows","etapesRows"])):(0,l.Q3)("",!0)])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[31]||(t[31]=e=>s.step=7),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[32]||(t[32]=e=>s.step=9),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:9,title:"Contrôles",icon:"biotech",done:s.step>9},{default:(0,l.k6)((()=>[9===s.step?((0,l.uX)(),(0,l.Wv)(v,{key:0,controlesRows:s.controleRows,onControleRows:i.rows},null,8,["controlesRows","onControleRows"])):(0,l.Q3)("",!0),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[33]||(t[33]=e=>s.step=8),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[34]||(t[34]=e=>s.step=10),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:10,title:"Contre-indications et précautions d'emploi",icon:"warning",done:s.step>10},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Xu,[(0,l.bF)(n,{ref:"emploiInput",class:"my-0 col-3",modelValue:s.emploi,"onUpdate:modelValue":t[35]||(t[35]=e=>s.emploi=e),label:"Entrez les informations",color:"cyan-4",autogrow:"",onMouseover:t[36]||(t[36]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[37]||(t[37]=t=>e.changeLabelColor("nameInput","")),onFocus:t[38]||(t[38]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[39]||(t[39]=t=>e.onBlur("name"))},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"info",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[40]||(t[40]=e=>s.step=9),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[41]||(t[41]=e=>s.step=11),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:10,title:"Publications",icon:"article",done:s.step>11},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ou,[(0,l.bF)(n,{ref:"publicationsInput",class:"my-0 col-3",modelValue:s.publications,"onUpdate:modelValue":t[42]||(t[42]=e=>s.publications=e),label:"Publications, données de stabilité...",color:"cyan-4",autogrow:"",onMouseover:t[43]||(t[43]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[44]||(t[44]=t=>e.changeLabelColor("nameInput","")),onFocus:t[45]||(t[45]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[46]||(t[46]=t=>e.onBlur("name"))},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"article",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[47]||(t[47]=e=>s.step=10),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[48]||(t[48]=e=>s.step=12),color:"cyan-4",label:"Suivant",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:12,title:"PPH cloud",icon:"cloud",done:s.step>12},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ju,[(0,l.Lk)("div",$u,[(0,l.bF)(u,{modelValue:s.cloud,"onUpdate:modelValue":t[49]||(t[49]=e=>s.cloud=e),label:s.cloud?"Publique":"Privée",size:"md",color:"green-4",icon:"publish"},null,8,["modelValue","label"])])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:t[50]||(t[50]=e=>s.step=11),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(d,{flat:"",onClick:t[51]||(t[51]=e=>s.step=13),color:"cyan-4",label:"Terminer",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",Bu,[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",onClick:i.submitForm,color:"green-4",label:"Enregistrer",class:"btn-flat-success-pph"},null,8,["onClick"]),(0,l.bF)(d,{flat:"",color:"red-4",label:"Supprimer",class:"btn-flat-danger-pph"})])),_:1})])])),_:1},8,["modelValue"])])])),_:1})):((0,l.uX)(),(0,l.Wv)(w,{key:1,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Hu,[(0,l.bF)(C,{class:"bg-op-8","animation-duration":1e3,size:100,color:"#ff1d5e"})])])),_:1}))}const Gu={class:"row"},Ku={key:0,class:"text-cyan-4 text-subtitle2 q-pt-md"},Yu={key:1,class:"text-cyan-4 text-subtitle2 q-pt-md"},Ju={key:0,class:"row text-subtitle1 text-cyan-4 justify-center"},Zu={key:1,class:"row text-subtitle1 text-cyan-4 justify-center"},ed=(0,l.Lk)("div",{class:"row text-orange-4 text-subtitle2 justify-center"},"Paramètres de calcul",-1),td={class:"row justify-center"},od={class:"row"},ad={class:"col-12"},ld={key:1,class:"q-pr-sm q-pl-md"},sd={class:"row justify-center"},id={class:"col-8"},rd={class:"row justify-center"};function nd(e,t,o,s,i,r){const n=(0,l.g2)("q-item-section"),c=(0,l.g2)("q-img"),u=(0,l.g2)("q-item"),d=(0,l.g2)("q-select"),p=(0,l.g2)("q-input"),m=(0,l.g2)("q-tooltip"),f=(0,l.g2)("q-btn"),h=(0,l.g2)("q-avatar"),b=(0,l.g2)("q-card-section"),k=(0,l.g2)("q-separator"),_=(0,l.g2)("q-card-actions"),v=(0,l.g2)("atom-spinner"),y=(0,l.g2)("q-btn-group"),F=(0,l.g2)("q-card"),w=(0,l.g2)("q-dialog"),C=(0,l.g2)("q-list");return(0,l.uX)(),(0,l.CE)("div",Gu,[i.rows.length>0?((0,l.uX)(),(0,l.Wv)(C,{key:0,bordered:"",class:"col-11"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.rows,((s,C)=>((0,l.uX)(),(0,l.Wv)(u,{key:C,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(n,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{label:s.matiere?"Matiere premiere n°"+(C+1):"Ajouter une matière première",modelValue:s.matiere,"onUpdate:modelValue":e=>s.matiere=e,color:"cyan-4",class:"hover-effect",options:i.matieres,"option-label":"label","option-value":"id"},{option:(0,l.k6)((e=>[(0,l.bF)(u,(0,l.v6)(e.itemProps,(0,l.Tb)(e.itemEvents)),{default:(0,l.k6)((()=>[(0,l.bF)(n,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.opt.label),1)])),_:2},1024),(0,l.bF)(n,{side:""},{default:(0,l.k6)((()=>[e.opt.cmr?((0,l.uX)(),(0,l.Wv)(c,{key:0,class:"q-ml-xs fade-blink",src:ri,style:{width:"20px",height:"20px"}})):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1040)])),_:2},1032,["label","modelValue","onUpdate:modelValue","options"])])),_:2},1024),(0,l.bF)(n,{class:"col-1"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{modelValue:s.qté,"onUpdate:modelValue":e=>s.qté=e,color:"cyan-4",class:"hover-effect text-center",label:"Quantité"},{append:(0,l.k6)((()=>["string"===typeof s.matiere?((0,l.uX)(),(0,l.CE)("div",Ku,(0,g.v_)(s.unite_mesure),1)):((0,l.uX)(),(0,l.CE)("div",Yu,(0,g.v_)(s.matiere.unite),1))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(n,{class:"col-4"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{readonly:"",modelValue:s.calcul,"onUpdate:modelValue":e=>s.calcul=e,label:s.calcul?"Calcul appliqué":"Ajouter un calcul",color:"cyan-4",class:"hover-effect text-center"},{prepend:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{flat:"",size:"md",onClick:e=>r.openCalculDialog(C),icon:"calculate",color:"purple-4",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.eW)("Ajouter ou modifier le calcul")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),(0,l.bF)(w,{modelValue:i.calculDialog,"onUpdate:modelValue":t[9]||(t[9]=e=>i.calculDialog=e)},{default:(0,l.k6)((()=>[(0,l.bF)(F,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,null,{default:(0,l.k6)((()=>["string"===typeof i.currentRow.matiere?((0,l.uX)(),(0,l.CE)("div",Ju," Calcul pour "+(0,g.v_)(i.currentRow.matiere),1)):((0,l.uX)(),(0,l.CE)("div",Zu," Calcul pour "+(0,g.v_)(i.currentRow.matiere.nom)+" "+(0,g.v_)(i.currentRow.matiere.qté_cdt)+(0,g.v_)(i.currentRow.matiere.unite_cdt)+" - "+(0,g.v_)(i.currentRow.matiere.forme.nom)+" - "+(0,g.v_)(i.currentRow.matiere.fournisseur.name),1))])),_:1}),(0,l.bF)(k),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[ed,(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",td,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.parametresRows,((e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:t},[(0,l.bF)(f,{flat:"",color:"cyan-4",class:"hover-effect",label:`${e.parametre.nom} - ${e.parametre.unite}`,onClick:t=>r.inputParametre(`${e.parametre.nom} - ${e.parametre.unite}`,i.indexRow)},null,8,["label","onClick"])])))),128)),o.formuleId?((0,l.uX)(),(0,l.Wv)(f,{key:1,flat:"",color:"cyan-4",class:"hover-effect",label:"Quantité - "+(i.currentRow?.unite_mesure||"Unité inconnue"),onClick:t[1]||(t[1]=e=>r.inputParametre("Quantité - "+(i.currentRow?.unite_mesure||""),i.indexRow))},null,8,["label"])):((0,l.uX)(),(0,l.Wv)(f,{key:0,flat:"",color:"cyan-4",class:"hover-effect",label:"Quantité - "+(i.currentRow?.matiere?.unite_mesure?.nom||"Unité inconnue"),onClick:t[0]||(t[0]=e=>r.inputParametre("Quantité - "+(i.currentRow?.matiere?.unite_mesure?.nom||""),i.indexRow))},null,8,["label"]))])])),_:2},1024)])),_:2},1024),(0,l.bF)(k),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",od,[(0,l.Lk)("div",ad,[(0,l.bF)(p,{modelValue:i.currentRow.calcul,"onUpdate:modelValue":t[3]||(t[3]=e=>i.currentRow.calcul=e),color:"cyan-4",label:e.response&&i.currentRow.calcul?"Calcul généré par V-PPH":"Entrez le calcul a appliquer"},{prepend:(0,l.k6)((()=>[i.ask?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(f,{key:0,flat:"",class:"q-ma-none hover-effect fade-blink",color:"purple-4",label:"V-PPH",size:"sm",onClick:t[2]||(t[2]=(0,a.D$)((e=>r.gptCalculate(i.indexRow)),["stop"]))})),i.ask&&!e.response?((0,l.uX)(),(0,l.CE)("div",ld,[(0,l.bF)(v,{class:"bg-op-8","animation-duration":1e3,size:25,color:"#ff1d5e"})])):(0,l.Q3)("",!0)])),_:1},8,["modelValue","label"])])]),(0,l.Lk)("div",sd,[(0,l.Lk)("div",id,[e.response?((0,l.uX)(),(0,l.Wv)(p,{key:0,modelValue:i.question,"onUpdate:modelValue":t[5]||(t[5]=e=>i.question=e),label:"Effectuer une demande",onKeyup:t[6]||(t[6]=(0,a.jR)((e=>r.gptCalculate(i.indexRow)),["enter"]))},{append:(0,l.k6)((()=>[(0,l.bF)(f,{flat:"",color:"purple-4",class:"hover-effect-success",size:"md",icon:"send",onClick:t[4]||(t[4]=e=>r.gptCalculate(i.indexRow))})])),_:1},8,["modelValue"])):(0,l.Q3)("",!0)])])])),_:1}),(0,l.bF)(k),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",rd,[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{flat:"",color:"green-4",label:"Valider",onClick:t[7]||(t[7]=e=>r.validerCalcul(i.indexRow))}),(0,l.bF)(f,{flat:"",class:"hover-effect",color:"cyan-4",label:"Effacer",onClick:t[8]||(t[8]=e=>r.effacerCalcul(i.indexRow))}),(0,l.bF)(f,{flat:"",color:"red-4",label:"Annuler",onClick:r.annulerCalcul},null,8,["onClick"])])),_:1})])])),_:1})])),_:2},1024)])),_:2},1032,["modelValue"])])),_:2},1024),(0,l.bF)(n,{class:"col-2"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{label:"Appareil de mesure",modelValue:s.type_appareil,"onUpdate:modelValue":e=>s.type_appareil=e,color:"cyan-4",class:"hover-effect",options:o.typesAppareils,"option-label":"nom","option-value":"id"},null,8,["modelValue","onUpdate:modelValue","options"])])),_:2},1024),(0,l.bF)(n,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(f,{flat:"",size:"md",onClick:e=>r.removeLine(C),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(f,{flat:"",size:"md",onClick:r.addLine,icon:"add_box",color:"cyan-4",class:"hover-effect q-px-xs",label:i.rows.length>0?"":"Ajouter"},null,8,["onClick","label"]),i.rows.length>0?((0,l.uX)(),(0,l.Wv)(f,{key:1,flat:"",size:"md",onClick:r.validRows,icon:"check_circle",color:"green-4",class:"q-px-xs"},null,8,["onClick"])):(0,l.Q3)("",!0)])}var cd={components:{AtomSpinner:il.F},props:["newId","formuleId","typesAppareils","compoRows","parametresRows","name","prep"],data(){return{calculDialog:!1,selectedRowIndex:null,calculDetails:[],matieres:[],rows:[],currentRow:[],indexRow:"",formRows:[{num_formule:null,matiere:null,"qté":null,calcul:"",calculInput:"",type_appareil:null}],question:"",context:"",ask:!1}},computed:{...(0,u.L8)("matieresPremieres",["allMatieres","allUnites"]),...(0,u.L8)("formules",["allParametres","allParametresFormules"]),...(0,u.L8)("appareils",["allTypes"]),...(0,u.aH)("chatGPT",["response"])},async created(){this.newChat(),this.question="",console.log("compoRows",this.compoRows),this.matieres=this.allMatieres.map((e=>({...e,label:`${e.nom} ${e.qté_cdt}${e.unite_cdt} - ${e.forme.nom} - ${e.fournisseur.name}`,id:e.id,unite:e.unite_mesure.nom,cmr:e.cmr}))),this.formuleId&&(this.rows=this.compoRows.map((e=>({num_formule:this.formuleId,matiere:`${e.matiere.nom} ${e.matiere.qté_cdt}${e.matiere.unite_cdt} - ${e.matiere.forme.nom} - ${e.matiere.fournisseur.name}`,"qté":e.qté,calcul:e.calcul,calculInput:"",type_appareil:e.type_appareil.nom,unite_mesure:e.matiere.unite_mesure.nom,matiereId:e.matiere.id}))))},methods:{...(0,u.i0)("matieresPremieres",["loadMatieresPremieres","loadUnites"]),...(0,u.i0)("formules",["addComposition"]),...(0,u.i0)("formules",["loadParametres","loadParametresFormules"]),...(0,u.i0)("notifications",["showNotification"]),...(0,u.i0)("chatGPT",["askQuestion","newChat"]),...(0,u.PY)("chatGPT",["deleteResponse"]),async gptCalculate(e){this.currentRow.calcul="Analyse de la demande en cours...";const t=this.parametresRows.map((e=>`${e.parametre.nom} - ${e.parametre.unite}`)),o="Avant de traiter cette demande, vérifie bien les données que tu possèdes ou que tu trouves sur internet. ",a=this.compoRows.map((e=>`${e.matiere.nom} ${e.matiere.forme.nom}`)).join(", "),l="Pour une "+this.prep+" de "+this.name+" dont les composants sont "+a+" donne moi le calcul qui sera utilisé pour mesurer la quantité de "+this.rows[e].matiere+" sachant que les parametres de calcul disponibles sont ";let s=". Ces paramètres sont fournis sous le format: paramètre - unité. Ta réponse doit uniquement comporter le calcul litéral effectué à l'aide des paramètres (et leur unité), en respectant le format des paramètres fournis.Tu as le droit d'utiliser des nombres et de faire autant d'opérations que tu veux. Fait bien attention aux unités des paramètres pour générer ton calcul.Exemple: (parametre1 + parametre2)/parametre1. La valeur de chaque paramètre sera fourni par l'utilisateur plus tard, lors de la préparation, elle remplacera les paramètres pour calculer les quantités, c'est pourquoi tu dois fournir uniquement le calcul littéral et ne mettre aucune égalité.Je tiens absolument a ce que ta réponse ne contienne que le calcul littéral, tu n'as pas le droit de faire de phrases, c'est très important, sauf si tu as un doute, que tu constate une incohérence, ta réponse sera: ",i="Erreur: (explique ici en 10 mots maximum d'où vient l'erreur)";this.context=o+l+t+s+i,this.question.trim()?(this.question=this.question+s+i,await this.askQuestion(this.question),this.question=""):(this.ask=!0,await this.askQuestion(this.context),this.ask=!1),this.currentRow.calcul=this.response},updateControlesRows(){this.$emit("compoRows",this.rows),console.log("rows",this.rows),console.log("comporows",this.compoRows)},validRows(){this.updateControlesRows(),this.showNotification({message:"Composition ajoutée",type:"success"})},addLine(){this.updateControlesRows(),this.rows.push({num_formule:this.formuleId?this.formuleId:this.newId,matiere:"","qté":"",calcul:"",type_appareil:""}),console.log("rows",this.rows)},removeLine(e){this.rows.splice(e,1),this.updateControlesRows()},openCalculDialog(e){this.currentRow=this.rows[e],this.calculDialog=!0,this.indexRow=e},validerCalcul(e){this.rows[e].calcul=this.currentRow.calcul,this.newChat(),this.deleteResponse(),this.calculDialog=!1},annulerCalcul(){this.newChat(),this.deleteResponse(),this.calculDialog=!1},inputParametre(e,t){this.currentRow.calcul+=e,this.rows[t].calcul=this.currentRow.calcul},effacerCalcul(e){this.currentRow.calcul=" ",this.deleteResponse(),this.rows[e].calcul=this.currentRow.calcul},async submitForm(){const e={compositions:this.rows.map((e=>({num_formule:e.num_formule,matiere:e.matiere.id,"qté":e.qté,calcul:e.calcul,type_apparel:e.type_appareil.id})))};this.addComposition(e)}}},ud=o(1450);const dd=(0,m.A)(cd,[["render",nd]]);var pd=dd;E()(cd,"components",{QList:F.A,QItem:w.A,QItemSection:C.A,QSelect:Fs.A,QImg:ns.A,QInput:Ae.A,QAvatar:ud.A,QBtn:v.A,QTooltip:sr.A,QDialog:we.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A,QCardActions:Cu.A,QBtnGroup:Y.A});const md={class:"row"};function fd(e,t,o,a,s,i){const r=(0,l.g2)("q-select"),n=(0,l.g2)("q-item-section"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-item"),d=(0,l.g2)("q-list");return(0,l.uX)(),(0,l.CE)("div",md,[s.rows.length>0?((0,l.uX)(),(0,l.Wv)(d,{key:0,bordered:"",class:"col-3"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.rows,((e,t)=>((0,l.uX)(),(0,l.Wv)(u,{key:t,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(n,null,{default:(0,l.k6)((()=>[(0,l.bF)(r,{label:e.parametre?"Parametre n° "+(t+1):"Ajouter un paramètre",modelValue:e.parametre,"onUpdate:modelValue":t=>e.parametre=t,color:"cyan-4",class:"hover-effect",options:s.parametres,"option-label":"nom","option-value":"id"},null,8,["label","modelValue","onUpdate:modelValue","options"])])),_:2},1024),(0,l.bF)(n,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",size:"md",onClick:e=>i.removeLine(t),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(c,{flat:"",size:"md",onClick:i.addLine,icon:"add_box",color:"cyan-4",class:"hover-effect",label:"Ajouter"},null,8,["onClick"]),s.rows.length>0?((0,l.uX)(),(0,l.Wv)(c,{key:1,flat:"",size:"md",onClick:i.validRows,icon:"check_circle",color:"green-4",label:"Valider"},null,8,["onClick"])):(0,l.Q3)("",!0)])}var hd={props:["newId","formuleId","parametresRows"],data(){return{parametre:"",unite:"",parametreDialog:!1,selectedRowIndex:null,rows:[{num_formule:"",parametre:"",unite:""}],parametres:[]}},computed:{...(0,u.L8)("formules",["allParametres","allParametresFormules"])},async created(){this.parametres=this.allParametres.map((e=>({nom:`${e.nom} - ${e.unite}`,id:e.id}))),this.rows=this.parametresRows},methods:{...(0,u.i0)("formules",["loadParametres","loadParametresFormules","addParametre"]),updateParametresRows(){this.$emit("parametresRows",this.rows)},validRows(){this.updateParametresRows(),this.showNotification({message:"Parametres ajoutés",type:"success"})},addLine(){this.updateParametresRows(),this.formuleId?this.rows.push({num_formule:this.formuleId,parametre:""}):this.rows.push({num_formule:this.newId,parametre:""}),console.log("rows",this.rows)},removeLine(e){this.rows.splice(e,1),this.updateParametresRows()}}};const bd=(0,m.A)(hd,[["render",fd]]);var gd=bd;E()(hd,"components",{QList:F.A,QItem:w.A,QItemSection:C.A,QSelect:Fs.A,QBtn:v.A});const kd={class:"row"},_d=(0,l.Lk)("div",{class:"row text-subtitle1 text-cyan-4 justify-center"}," Créer un epi ",-1),vd={class:"row justify-center"};function yd(e,t,o,a,s,i){const r=(0,l.g2)("q-btn"),n=(0,l.g2)("q-select"),c=(0,l.g2)("q-card-section"),u=(0,l.g2)("q-separator"),d=(0,l.g2)("q-input"),p=(0,l.g2)("q-card"),m=(0,l.g2)("q-dialog"),f=(0,l.g2)("q-item-section"),h=(0,l.g2)("q-item"),b=(0,l.g2)("q-list");return(0,l.uX)(),(0,l.CE)("div",kd,[s.rows.length>0?((0,l.uX)(),(0,l.Wv)(b,{key:0,bordered:"",class:"col-6"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.rows,((o,a)=>((0,l.uX)(),(0,l.Wv)(h,{key:a,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{label:o.epi?"Epi n° "+(a+1):"Ajouter un Epi",modelValue:o.epi,"onUpdate:modelValue":e=>o.epi=e,color:"cyan-4",class:"hover-effect",options:s.epis,"option-label":"nom","option-value":"id"},(0,l.eX)({_:2},[o.epi?void 0:{name:"append",fn:(0,l.k6)((()=>[(0,l.bF)(r,{flat:"",onClick:t[0]||(t[0]=e=>s.epiDialog=!0),icon:"add_box",color:"green-4",class:"q-px-none hover-effect"})])),key:"0"}]),1032,["label","modelValue","onUpdate:modelValue","options"]),(0,l.bF)(m,{modelValue:s.epiDialog,"onUpdate:modelValue":t[7]||(t[7]=e=>s.epiDialog=e)},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,null,{default:(0,l.k6)((()=>[_d])),_:1}),(0,l.bF)(u),(0,l.bF)(c,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{modelValue:s.newEpi,"onUpdate:modelValue":t[1]||(t[1]=e=>s.newEpi=e),label:"Nom",color:"cyan-4",onMouseover:t[2]||(t[2]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[3]||(t[3]=t=>e.changeLabelColor("nameInput","")),onFocus:t[4]||(t[4]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[5]||(t[5]=t=>e.onBlur("name"))},null,8,["modelValue"])])),_:1}),(0,l.bF)(u),(0,l.Lk)("div",vd,[(0,l.bF)(r,{flat:"",onClick:i.creerEpi,label:"Ajouter",color:"green-4"},null,8,["onClick"]),(0,l.bF)(r,{flat:"",onClick:t[6]||(t[6]=e=>s.epiDialog=!1),label:"Annuler",color:"red-4"})])])),_:1})])),_:1},8,["modelValue"])])),_:2},1024),(0,l.bF)(f,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{flat:"",size:"md",onClick:e=>i.removeLine(a),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(r,{flat:"",size:"md",onClick:i.addLine,icon:"add_box",color:"cyan-4",class:"hover-effect",label:"Ajouter"},null,8,["onClick"]),s.rows.length>0?((0,l.uX)(),(0,l.Wv)(r,{key:1,flat:"",size:"md",onClick:i.validRows,icon:"check_circle",color:"green-4",label:"Valider"},null,8,["onClick"])):(0,l.Q3)("",!0)])}var Fd={props:["newId","formuleId","episRows"],data(){return{epiDialog:!1,selectedRowIndex:null,newEpi:null,epis:[],rows:[{num_formule:null,epi:null}]}},computed:{...(0,u.L8)("epi",["allEpis","allEpisFormules"])},async created(){this.epis=this.allEpis,this.rows=this.episRows,console.log("epis",this.epis)},methods:{...(0,u.i0)("epi",["addEpi","loadEpis"]),...(0,u.PY)("epi",["SET_EPI_FORMULES","SET_EPI"]),...(0,u.i0)("notifications",["showNotification"]),async creerEpi(){const e={nom:this.newEpi};await this.addEpi(e),await this.loadEpis,this.epis=this.allEpis,this.epiDialog=!1},updateEpisRows(){this.$emit("episRows",this.rows)},validRows(){this.updateEpisRows(),this.showNotification({message:"Epis ajoutés",type:"success"})},addLine(){let e=this.allEpisFormules.length+1;this.formuleId?this.rows.push({id:e,num_formule:this.formuleId,epi:""}):this.rows.push({id:e,num_formule:this.newId,epi:""}),this.updateEpisRows()},removeLine(e){this.rows.splice(e,1),this.updateEpisRows()}}};const wd=(0,m.A)(Fd,[["render",yd]]);var Cd=wd;E()(Fd,"components",{QList:F.A,QItem:w.A,QItemSection:C.A,QSelect:Fs.A,QBtn:v.A,QDialog:we.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A,QInput:Ae.A});const Ld={class:"row"};function xd(e,t,o,a,s,i){const r=(0,l.g2)("q-select"),n=(0,l.g2)("q-item-section"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-item"),d=(0,l.g2)("q-list");return(0,l.uX)(),(0,l.CE)("div",Ld,[s.rows.length>0?((0,l.uX)(),(0,l.Wv)(d,{key:0,bordered:"",class:"col-3"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.rows,((e,t)=>((0,l.uX)(),(0,l.Wv)(u,{key:t,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(n,null,{default:(0,l.k6)((()=>[(0,l.bF)(r,{label:e.article?"Article n° "+(t+1):"Ajouter un article",modelValue:e.article,"onUpdate:modelValue":t=>e.article=t,color:"cyan-4",class:"hover-effect",options:s.articles,"option-label":"nom","option-value":"id"},null,8,["label","modelValue","onUpdate:modelValue","options"])])),_:2},1024),(0,l.bF)(n,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",size:"md",onClick:e=>i.removeLine(t),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(c,{flat:"",size:"md",onClick:i.addLine,icon:"add_box",color:"cyan-4",class:"hover-effect",label:"Ajouter"},null,8,["onClick"]),s.rows.length>0?((0,l.uX)(),(0,l.Wv)(c,{key:1,flat:"",size:"md",onClick:i.validRows,icon:"check_circle",color:"green-4",label:"Valider"},null,8,["onClick"])):(0,l.Q3)("",!0)])}var Ad={props:["newId","formuleId","articlesRows"],data(){return{id:null,articles:[],rows:[{num_formule:null,article:null}]}},computed:{...(0,u.L8)("matieresPremieres",["allMatieres"]),...(0,u.L8)("formules",["allArticlesFormules"])},async created(){this.articles=this.allMatieres.filter((e=>"Matériel & Articles de conditionnement"===e.categorie.nom)),this.rows=this.articlesRows,this.rows.forEach((e=>{const t=this.articles.find((t=>t.id===e.article));t&&(e.article=t)})),console.log("articles",this.articles)},methods:{...(0,u.i0)("notifications",["showNotification"]),updateArticlesRows(){this.$emit("articlesRows",this.rows),console.log(this.rows)},validRows(){this.updateArticlesRows(),this.showNotification({message:"Articles ajoutés",type:"success"})},addLine(){this.formuleId?this.rows.push({num_formule:this.formuleId,article:""}):this.rows.push({num_formule:this.newId,article:""}),this.updateArticlesRows()},removeLine(e){this.rows.splice(e,1),this.updateArticlesRows()}}};const qd=(0,m.A)(Ad,[["render",xd]]);var Ed=qd;E()(Ad,"components",{QList:F.A,QItem:w.A,QItemSection:C.A,QSelect:Fs.A,QBtn:v.A});const Id={class:"row"},Pd={key:3,class:"row justify-center items-center q-px-md"},Sd={class:"col-4"},Vd=(0,l.Lk)("div",{class:"text-subtitle1 text-purple-4"},"Mode opératoire suggéré (à titre informatif) :",-1);function Qd(e,t,o,s,i,r){const n=(0,l.g2)("q-input"),c=(0,l.g2)("q-item-section"),u=(0,l.g2)("q-btn"),d=(0,l.g2)("q-item"),p=(0,l.g2)("q-list"),m=(0,l.g2)("atom-spinner"),f=(0,l.g2)("q-card-section"),h=(0,l.g2)("q-item-label"),b=(0,l.g2)("q-scroll-area"),k=(0,l.g2)("q-card");return(0,l.uX)(),(0,l.CE)("div",Id,[i.rows.length>0?((0,l.uX)(),(0,l.Wv)(p,{key:0,bordered:"",class:"col-8"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.rows,((e,t)=>((0,l.uX)(),(0,l.Wv)(d,{key:t,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{class:"col-4"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{label:"Nom",modelValue:e.nom,"onUpdate:modelValue":t=>e.nom=t,color:"cyan-4",class:"hover-effect"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(c,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{autogrow:"",label:"Description",modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,color:"cyan-4",class:"hover-effect"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(c,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",size:"md",onClick:e=>r.removeLine(t),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(u,{flat:"",size:"md",onClick:r.addLine,icon:"add_box",color:"cyan-4",class:"hover-effect",label:"Ajouter"},null,8,["onClick"]),i.rows.length>0?((0,l.uX)(),(0,l.Wv)(u,{key:1,flat:"",size:"md",onClick:r.validFormRows,icon:"check_circle",color:"green-4",label:"Valider"},null,8,["onClick"])):(0,l.Q3)("",!0),i.ask?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(u,{key:2,flat:"",class:"hover-effect fade-blink",size:"md",color:"purple-4",label:"V-PPH",onClick:(0,a.D$)(r.GptMod,["stop"])},null,8,["onClick"])),i.ask&&!e.response?((0,l.uX)(),(0,l.CE)("div",Pd,[(0,l.bF)(m,{class:"bg-op-8","animation-duration":1e3,size:40,color:"#ff1d5e"})])):(0,l.Q3)("",!0),e.response?((0,l.uX)(),(0,l.Wv)(k,{key:4,class:"col-8 bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"row justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Sd,[(0,l.bF)(n,{modelValue:i.question,"onUpdate:modelValue":t[0]||(t[0]=e=>i.question=e),label:"Effectuer une demande",onKeyup:(0,a.jR)(r.GptMod,["enter"])},{append:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",color:"purple-4",class:"hover-effect-success",size:"md",icon:"send",onClick:r.GptMod},null,8,["onClick"])])),_:1},8,["modelValue","onKeyup"])])])),_:1}),(0,l.bF)(f,null,{default:(0,l.k6)((()=>[Vd,(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{"thumb-style":i.thumbStyle,"bar-style":i.barStyle,style:{height:"300px"}},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.etapes,((e,t)=>((0,l.uX)(),(0,l.Wv)(d,{key:t,class:"q-mb-md"},{default:(0,l.k6)((()=>[(0,l.bF)(c,null,{default:(0,l.k6)((()=>[(0,l.bF)(h,{class:"text-subtitle1 text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.title),1)])),_:2},1024),(0,l.bF)(h,{caption:"",class:"text-subtitle2"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.description),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(u,{flat:"",icon:"add_box",size:"sm",color:"purple-4",class:"hover-effect",onClick:(0,a.D$)((e=>r.addEtape(t)),["stop"])},null,8,["onClick"])])),_:2},1024)))),128))])),_:1},8,["thumb-style","bar-style"])])),_:1})])),_:1}),(0,l.bF)(f,{class:"row justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",class:"hover-effect",size:"md",color:"green-4",label:"Ajouter",onClick:(0,a.D$)(r.addGptModOp,["stop"])},null,8,["onClick"]),(0,l.bF)(u,{flat:"",class:"hover-effect",size:"md",color:"red-4",label:"Fermer",onClick:(0,a.D$)(r.closeGpt,["stop"])},null,8,["onClick"])])),_:1})])),_:1})):(0,l.Q3)("",!0)])}var Md={components:{AtomSpinner:il.F},props:["newId","formuleId","controleId","etapesRows","name","prep","compoRows"],data(){return{thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#027be3",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#027be3",width:"9px",opacity:.2},rows:[],question:"",context:"",result:"",etapes:[],ask:!1}},computed:{...(0,u.L8)("etapes",["allEtapes"]),...(0,u.aH)("chatGPT",["response"])},async created(){this.rows=this.etapesRows,this.newChat(),this.question=""},methods:{...(0,u.i0)("notifications",["showNotification"]),...(0,u.i0)("chatGPT",["askQuestion","newChat"]),...(0,u.PY)("chatGPT",["deleteResponse"]),async GptMod(){const e=this.prep+" de "+this.name,t=this.compoRows.map((e=>`${e.matiere.nom} ${e.matiere.forme.nom}(${e.matiere.type.nom}) `)).join(", ");console.log("compo",t);const o="Pour une "+e+" dont les composants sont "+t+". Ton mode opératoire doit contenir uniquement les composants fournis. donne moi un mode opératoire impérativement sous forme d'étapes pour chaque composants. Chaque étape doit comporter un titre contenu entre deux *Ta réponse ne doit comporter que les étapes et préciser le matériel utilisé.";this.context=o,this.question.trim()?await this.askQuestion(this.question):(this.ask=!0,await this.askQuestion(this.context),this.ask=!1);const a=/\*([^*]+)\*\n?([^*]+)/g;let l,s=[];while(null!==(l=a.exec(this.response))){let e=l[1].trim(),t=e.replace(/^[^:-]+[-:]\s*/,""),o=l[2].trim().replace(/\n/g," ");s.push({title:t,description:o})}console.log("etapes",s),this.etapes=s,this.question=""},addEtape(e){let t=this.etapes[e];t&&(this.updateFormRows(),"CreateControles"===this.$route.name?this.rows.push({num:"c"+this.newId,nom:t.title,description:t.description}):this.rows.push({num:"f"+this.newId,nom:t.title,description:t.description}))},addGptModOp(){this.etapes.forEach((e=>{e&&(this.updateFormRows(),"CreateControles"===this.$route.name?this.rows.push({num:"c"+this.newId,nom:e.title,description:e.description}):this.rows.push({num:"f"+this.newId,nom:e.title,description:e.description}))})),this.question="",this.newChat(),this.deleteResponse()},closeGpt(){this.newChat(),this.deleteResponse()},updateFormRows(){this.$emit("etapesRows",this.rows)},validFormRows(){this.updateFormRows(),this.showNotification({message:"Etapes ajoutées",type:"success"})},addLine(){"CreateControles"===this.$route.name?(this.updateFormRows(),this.rows.push({num:"c"+this.newId,nom:"",description:""})):(this.updateFormRows(),this.rows.push({num:"f"+this.newId,nom:"",description:""}))},removeLine(e){this.rows.splice(e,1),this.updateFormRows()}}};const Td=(0,m.A)(Md,[["render",Qd]]);var Wd=Td;E()(Md,"components",{QList:F.A,QItem:w.A,QItemSection:C.A,QInput:Ae.A,QBtn:v.A,QCard:Ce.A,QCardSection:Le.A,QScrollArea:nr.A,QItemLabel:dr.A});const Dd={class:"row"};function Rd(e,t,o,a,s,i){const r=(0,l.g2)("q-select"),n=(0,l.g2)("q-item-section"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-item"),d=(0,l.g2)("q-list");return(0,l.uX)(),(0,l.CE)("div",Dd,[s.rows.length>0?((0,l.uX)(),(0,l.Wv)(d,{key:0,bordered:"",class:"col-3"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.rows,((e,t)=>((0,l.uX)(),(0,l.Wv)(u,{key:t,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(n,null,{default:(0,l.k6)((()=>[(0,l.bF)(r,{label:e.controle?"Contrôle n° "+(t+1):"Ajouter un contrôle",modelValue:e.controle,"onUpdate:modelValue":t=>e.controle=t,color:"cyan-4",class:"hover-effect",options:s.controles,"option-label":"nom","option-value":"id"},null,8,["label","modelValue","onUpdate:modelValue","options"])])),_:2},1024),(0,l.bF)(n,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",size:"md",onClick:e=>i.removeLine(t),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(c,{flat:"",size:"md",onClick:i.addLine,icon:"add_box",color:"cyan-4",class:"hover-effect",label:"Ajouter"},null,8,["onClick"]),s.rows.length>0?((0,l.uX)(),(0,l.Wv)(c,{key:1,flat:"",size:"md",onClick:i.validRows,icon:"check_circle",color:"green-4",label:"Valider"},null,8,["onClick"])):(0,l.Q3)("",!0)])}var Ud={props:["controlesRows"],data(){return{controles:[],rows:[]}},computed:{...(0,u.L8)("controles",["allTypesControles"])},async created(){await this.loadTypes(),this.controles=this.allTypesControles,this.rows=this.controlesRows,console.log("controles",this.allTypesControles)},methods:{...(0,u.i0)("controles",["loadTypes"]),...(0,u.i0)("notifications",["showNotification"]),updateControlesRows(){this.$emit("controleRows",this.rows)},validRows(){this.updateControlesRows(),this.showNotification({message:"Contrôles ajoutés",type:"success"})},addLine(){this.updateControlesRows(),this.rows.push({controle:""}),console.log("rows",this.rows)},removeLine(e){this.rows.splice(e,1),this.updateControlesRows()}}};const Nd=(0,m.A)(Ud,[["render",Rd]]);var Xd=Nd;E()(Ud,"components",{QList:F.A,QItem:w.A,QItemSection:C.A,QSelect:Fs.A,QBtn:v.A});var Od={components:{CompositionForm:pd,ParametresForm:gd,EpiForm:Cd,ArticlesForm:Ed,EtapesForm:Wd,ControlesForm:Xd,AtomSpinner:il.F},data(){return{loading:!1,step:1,name:"",typePrep:null,prep:"",liste:null,voie:null,duree:"",froid:!1,lumiere:!1,agiter:!1,modeOperatoire:"",emploi:"",publications:"",cloud:!1,pediatric:!1,hospital:!1,specialite:!1,newId:null,formuleId:null,formule:[],episRows:[],typesAppareils:[],controleRows:[],articlesRows:[],parametresRows:[],compoRows:[],etapesRows:[],typesPrep:[],listes:[],voies:[]}},computed:{...(0,u.L8)("formules",["allFormules","allTypesPrep","allListes","allArticlesFormules","allParametresFormules","allParametres","allCompositions"]),...(0,u.L8)("voiesAdministration",["allVoies"]),...(0,u.L8)("epi",["allEpis","allEpisFormules"]),...(0,u.L8)("appareils",["allTypes"]),...(0,u.L8)("etapes",["allEtapes"]),...(0,u.L8)("matieresPremieres",["allMatieres"])},async created(){this.$route.params.id?this.formuleId=Number(this.$route.params.id):this.newId=this.allFormules.length+1,await Promise.all([this.loadFormules(),this.loadUnites(),this.loadVoies(),this.loadTypes(),this.loadListes(),this.loadTypesAppareils(),this.loadParametres(),this.loadMatieresPremieres(),this.loadEpis(),this.loadEtapes()]),this.typesAppareils=this.allTypes,this.typesPrep=this.allTypesPrep,this.listes=this.allListes,this.voies=this.allVoies,this.formuleId||(this.loading=!0),this.formuleId&&(await Promise.all([this.loadArticlesFormules(),this.loadParametresFormules(),this.loadEpisFormules(),this.loadCompositions()]),this.formule=this.allFormules.find((e=>e.id===this.formuleId)),this.name=this.formule.nom,this.typePrep=this.formule.type.nom,this.liste=this.formule.liste.nom,this.voie=this.formule.voie.nom,this.duree=this.formule.duree,this.froid=this.formule.froid,this.lumiere=this.formule.lumiere,this.agiter=this.formule.agiter,this.modeOperatoire=this.formule.mode_operatoire,this.emploi=this.formule.contre_indications,this.publications=this.formule.publications,this.cloud=this.formule.cloud,this.pediatric=this.formule.pediatric,this.hospital=this.formule.hospitaliere,this.specialite=this.formule.specialite,this.episRows=this.allEpisFormules.filter((e=>e.num_formule===this.formuleId)),this.formule.controles?this.controleRows=this.formule.controles:this.controleRows=[],this.articlesRows=this.allArticlesFormules.filter((e=>e.num_formule===this.formuleId)),this.parametresRows=this.allParametresFormules.filter((e=>e.num_formule===this.formuleId)),this.etapesRows=this.allEtapes.filter((e=>e.num==="f"+this.formuleId)),this.compoRows=this.allCompositions.filter((e=>e.num_formule===this.formuleId)),this.loading=!0)},methods:{...(0,u.i0)("formules",["loadTypes","loadListes","addFormule","loadArticlesFormules","loadFormules","loadParametres","loadCompositions","addArticles","loadParametresFormules","addParametres","updateParametres","updateArticles","updateFormule"]),...(0,u.i0)("voiesAdministration",["loadVoies"]),...(0,u.i0)("epi",["loadEpis","loadEpisFormules","updateEpis","addEpis"]),...(0,u.i0)("appareils",["loadTypesAppareils"]),...(0,u.i0)("etapes",["loadEtapes"]),...(0,u.i0)("matieresPremieres",["loadMatieresPremieres","loadUnites"]),rowsArticles(e){this.articlesRows=e},rowsParametres(e){this.parametresRows=e},rowsEtapes(e){this.etapesRows=e},rowsEpis(e){this.episRows=e},rowsCompo(e){this.compoRows=e},rows(e){this.controleRows=e},async submitForm(){this.articlesRows.forEach((e=>{e.article=e.article.id}));const e=this.articlesRows;await this.updateArticles({formData:e,formuleId:Number(this.formuleId)}),this.articlesRows.forEach((e=>{const t=this.allMatieres.filter((e=>"Matériel & Articles de conditionnement"===e.categorie.nom)).find((t=>t.id===e.article));t&&(e.article=t)}))},async submitForms(){const e={nom:this.name,type:this.typePrep,liste:this.liste,voie:this.voie,duree:this.duree,froid:this.froid,lumiere:this.lumiere,agiter:this.agiter,mode_operatoire:this.modeOperatoire,contre_indications:this.emploi,publications:this.publications,cloud:this.cloud,pediatric:this.pediatric,hospitaliere:this.hospital,specialite:this.specialite};if(this.formuleId){this.articlesRows.forEach((e=>{this.updateArticles(e)})),this.parametresRows.forEach((e=>{this.updateParametres(e)})),this.episRows.forEach((e=>{this.updateEpis(e)})),this.etapesRows.forEach((e=>{this.updateEtapes(e)}));const t=this.formuleId;await this.updateFormule({formData:e,formuleId:t})}else this.articlesRows.forEach((e=>{this.addArticles(e)})),this.parametresRows.forEach((e=>{this.addParametres(e)})),this.episRows.map((e=>({id:e.id,num_formule:e.num_formule,epi:e.epi.id}))).forEach((e=>{if(this.allEpisFormules){const t=this.allEpisFormules.some((t=>t.num_formule===e.num_formule&&t.id===e.id));t?(console.log("row",e),this.updateEpis({formData:e,id:e.id})):(console.log("add"),this.addEpis(e))}else this.addEpis(e)})),this.etapesRows.forEach((e=>{this.addEtapes(e)})),await this.addFormule(e);this.name="",this.typePrep=null,this.liste=null,this.voie=null,this.duree="",this.froid=!1,this.lumiere=!1,this.agiter=!1,this.modeOperatoire="",this.emploi="",this.publications="",this.cloud=!1,this.pediatric=!1,this.specialite=!1,this.controlesRows=[],this.step=1}}};const jd=(0,m.A)(Od,[["render",zu]]);var $d=jd;E()(Od,"components",{QPage:Qe.A,QStepper:Nl.A,QStep:Xl.A,QInput:Ae.A,QIcon:x.A,QSelect:Fs.A,QToggle:mr.A,QStepperNavigation:Ol.A,QBtn:v.A,QBtnGroup:Y.A});const Bd={class:"q-pa-md"},Hd=(0,l.Lk)("div",{class:"text-h5 text-center text-cyan-4"},"Fiche de fabrication",-1),zd={class:"row"},Gd=(0,l.Lk)("div",{class:"text-cyan-4 text-subtitle2",color:"cyan-4"},"ans",-1),Kd={class:"row"},Yd={class:"row"},Jd={class:"row"},Zd={class:"row"},ep={key:0,class:"row"},tp={class:"col-1"},op={class:"text-cyan-4 text-subtitle2"},ap={key:1,class:"text-center text-cyan-4"},lp={key:0,class:"row"},sp={class:"col-2"},ip={key:1,class:"text-center text-cyan-4"},rp={class:"row justify-center"};function np(e,t,o,a,s,i){const r=(0,l.g2)("q-icon"),n=(0,l.g2)("q-input"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-stepper-navigation"),d=(0,l.g2)("q-step"),p=(0,l.g2)("q-select"),m=(0,l.g2)("q-item-section"),f=(0,l.g2)("q-item"),h=(0,l.g2)("q-list"),b=(0,l.g2)("router-link"),k=(0,l.g2)("q-btn-group"),_=(0,l.g2)("q-stepper"),v=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.CE)("div",Bd,[(0,l.bF)(_,{modelValue:s.step,"onUpdate:modelValue":t[24]||(t[24]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[Hd,(0,l.bF)(d,{name:1,title:"Patient",icon:"personal_injury",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",zd,[(0,l.bF)(n,{ref:"nomInput",class:"q-mr-lg col-3",modelValue:s.patient,"onUpdate:modelValue":t[0]||(t[0]=e=>s.patient=e),label:"Nom et prénom",color:"cyan-4",onMouseover:t[1]||(t[1]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[2]||(t[2]=t=>e.changeLabelColor("nameInput","")),onFocus:t[3]||(t[3]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[4]||(t[4]=t=>e.onBlur("name"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"badge",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(n,{ref:"ageInput",class:"q-mr-lg col-1",modelValue:s.age,"onUpdate:modelValue":t[5]||(t[5]=e=>s.age=e),label:"Age",color:"cyan-4",onMouseover:t[6]||(t[6]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[7]||(t[7]=t=>e.changeLabelColor("nameInput","")),onFocus:t[8]||(t[8]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[9]||(t[9]=t=>e.onBlur("name"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"badge",color:"cyan-4"})])),append:(0,l.k6)((()=>[Gd])),_:1},8,["modelValue"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[10]||(t[10]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:2,title:"Demandeur",icon:"person_book",done:s.step>2},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Kd,[(0,l.bF)(p,{modelValue:s.service,"onUpdate:modelValue":t[11]||(t[11]=e=>s.service=e),color:"cyan-4",class:"col-2 hover-effect",label:"Service",options:s.allServicesLabel,"option-label":"label","option-value":"value"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"groups",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",Yd,[(0,l.bF)(n,{modelValue:s.prescripteur,"onUpdate:modelValue":t[12]||(t[12]=e=>s.prescripteur=e),color:"cyan-4",class:"col-3 hover-effect",label:"Prescripteur"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"badge",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[13]||(t[13]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[14]||(t[14]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:3,title:"Formule",icon:"local_pharmacy",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Jd,[(0,l.bF)(p,{modelValue:s.typePrep,"onUpdate:modelValue":t[15]||(t[15]=e=>s.typePrep=e),color:"cyan-4",class:"col-2 hover-effect",label:"Type",options:s.allTypePrepLabel,"option-label":"label","option-value":"value",onInput:i.onTypeChange},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"local_pharmacy",color:"cyan-4"})])),_:1},8,["modelValue","options","onInput"])]),(0,l.Lk)("div",Zd,[(0,l.bF)(p,{modelValue:s.formule,"onUpdate:modelValue":t[16]||(t[16]=e=>s.formule=e),color:"cyan-4",class:"col-3 hover-effect",label:"Formule",options:s.allFormulesLabel,"option-label":"label","option-value":"value",onInput:i.onFormuleChange},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"local_pharmacy",color:"cyan-4"})])),_:1},8,["modelValue","options","onInput"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[17]||(t[17]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[18]||(t[18]=e=>s.step=4),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:4,title:"Paramètres",icon:"settings",done:s.step>4},{default:(0,l.k6)((()=>[s.parametres.length>0?((0,l.uX)(),(0,l.CE)("div",ep,[(0,l.Lk)("div",tp,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.parametres,((e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:t},[(0,l.bF)(n,{label:e.parametre.nom,color:"cyan-4",modelValue:e.valeur_parametre,"onUpdate:modelValue":t=>e.valeur_parametre=t},{append:(0,l.k6)((()=>[(0,l.Lk)("div",op,(0,g.v_)(e.parametre.unite),1)])),_:2},1032,["label","modelValue","onUpdate:modelValue"])])))),128))])])):((0,l.uX)(),(0,l.CE)("div",ap,"Aucun paramètre trouvé pour cette formule.")),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[19]||(t[19]=e=>s.step=3),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[20]||(t[20]=e=>s.step=5),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:5,title:"Composition",icon:"science",done:s.step>5},{default:(0,l.k6)((()=>[s.compositions.length>0?((0,l.uX)(),(0,l.CE)("div",lp,[(0,l.Lk)("div",sp,[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.compositions,((e,t)=>(0,l.bo)(((0,l.uX)(),(0,l.Wv)(f,{clickable:"",key:t},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.matiere.nom)+" "+(0,g.v_)(e.qté)+" "+(0,g.v_)(e.matiere.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024)),[[v]]))),128))])),_:1})])])):((0,l.uX)(),(0,l.CE)("div",ip,"Aucune composition trouvée pour cette formule.")),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[21]||(t[21]=e=>s.step=4),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[22]||(t[22]=e=>s.step=6),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",rp,[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:i.validFiche,color:"green-4",label:"Enregistrer",class:"btn-flat-success-pph"},null,8,["onClick"]),e.demandeId?((0,l.uX)(),(0,l.Wv)(b,{key:0,to:"/demandes/"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",color:"red-4",label:"Annuler",class:"btn-flat-danger-pph",onClick:t[23]||(t[23]=t=>e.toggleProduction({demandeId:e.demande.id,isProduction:e.demande.production}))})])),_:1})):(0,l.Q3)("",!0)])),_:1})])])),_:1},8,["modelValue"])])}var cp={data(){return{step:1,patient:"",age:"",typePrep:null,formule:null,prescripteur:"",service:"",allTypePrepLabel:[],allFormulesLabel:[],allServicesLabel:[],parametres:[],valeurParametre:null,compositions:[],isLoading:!0,ficheId:null}},computed:{...(0,u.L8)("formules",["allTypes","allListes","allFormules","allParametresFormules","allParametres","allCompositions"]),...(0,u.L8)("voiesAdministration",["allVoies"]),...(0,u.L8)("services",["allServices"]),...(0,u.L8)("fiches",["allFiches","lastFicheId"]),...(0,u.L8)("demandes",["allDemandes"])},async created(){await Promise.all([this.loadTypes(),this.loadFormules(),this.loadParametres(),this.loadParametresFormules(),this.loadCompositions(),this.loadServices(),this.loadFiches()]),this.allTypePrepLabel=this.allTypes.map((e=>({label:e.nom,value:e.id}))),this.allServicesLabel=this.allServices.map((e=>({label:e.nom,value:e.id})))},watch:{typePrep:"onTypeChange",formule:"onFormuleChange"},methods:{...(0,u.i0)("formules",["loadTypes","loadFormules","loadParametresFormules","loadParametres","loadCompositions"]),...(0,u.i0)("fiches",["addFiche","addParametresValues","loadFiches"]),...(0,u.i0)("services",["addService","loadServices"]),...(0,u.i0)("demandes",["loadDemandes","toggleProduction"]),...(0,u.i0)("notifications",["showNotification"]),...(0,u.PY)("fiches",["ADD_FICHE","ADD_PARAMETRES_FICHES"]),onFormuleChange(){this.formule?(this.parametres=this.allParametresFormules.filter((e=>e.num_formule===this.formule.value)),console.log("params",this.parametres),this.compositions=this.allCompositions.filter((e=>e.num_formule===this.formule.value))):(this.parametres=[],this.compositions=[])},onTypeChange(){this.typePrep?this.allFormulesLabel=this.allFormules.filter((e=>e.type.id===this.typePrep.value&&!0===e.is_activate)).map((e=>({label:e.nom,value:e.id}))):this.allFormulesLabel=this.allFormules.map((e=>({label:e.nom,value:e.id})))},redirectToLink(e){this.$router.push(`/fiche/${e}`)},async validFiche(){const e=this.allFiches;if(0===e.length)return void console.error("Aucune fiche n'a été trouvée.");const t=Math.max(...e.map((e=>e.id)));this.ficheId=t+1,this.parametres.forEach((e=>{this.ADD_PARAMETRES_FICHES({num_fiche:t+1,parametre:e.parametre,valeur_parametre:e.valeur_parametre})})),this.ADD_FICHE({id:t+1,prep:this.allFormules.find((e=>e.id===this.formule.value)),typePrep:this.allTypes.find((e=>e.id===this.typePrep.value)),service:this.allServices.find((e=>e.id===this.service.value)),patient:this.patient,age:this.age,prescripteur:this.prescripteur}),this.formule=null,this.typePrep=null,this.service="",this.patient="",this.age="",this.prescripteur="",this.step=1,this.$router.push({name:"CompoFiche",params:{ficheId:this.ficheId}})}}};const up=(0,m.A)(cp,[["render",np]]);var dp=up;E()(cp,"components",{QStepper:Nl.A,QStep:Xl.A,QInput:Ae.A,QIcon:x.A,QStepperNavigation:Ol.A,QBtn:v.A,QSelect:Fs.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A}),E()(cp,"directives",{ClosePopup:A.A});const pp={class:"row"},mp={class:"col-3 q-mt-md q-pl-lg"},fp={class:"col-6 text-h6 text-cyan-4 q-mt-lg text-center"},hp={class:"row justify-evenly q-mt-md"},bp={class:"col-2"},gp={key:0},kp={key:1},_p={class:"col-7"},vp=(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," Ajouter un certificat d'analyse ou un echantillon pour le lot ",-1),yp=(0,l.Lk)("br",null,null,-1),Fp={class:"row justify-center text-subtitle1 text-orange-4"},wp=(0,l.Lk)("br",null,null,-1),Cp={class:"row justify-center"},Lp={class:"col-12"},xp={key:0,class:"row"},Ap={class:"col-2 q-mt-sm"},qp={class:"col-2 offset-2"},Ep={class:"text-cyan-4 text-subtitle2 q-pt-md"},Ip={class:"row justify-center"},Pp={class:"text-cyan-4 text-subtitle2 q-pt-md"},Sp={class:"col-2"},Vp={key:0},Qp={class:"text-cyan-4 text-subtitle2 text-center"},Mp={class:"text-center text-h6 text-cyan-1"},Tp={class:"text-subtiltle1"},Wp={class:"col-4"},Dp={class:"row justify-center"};function Rp(e,t,o,s,i,r){const n=(0,l.g2)("q-fab-action"),c=(0,l.g2)("q-fab"),u=(0,l.g2)("q-item-section"),d=(0,l.g2)("q-item"),p=(0,l.g2)("q-card-section"),m=(0,l.g2)("q-separator"),f=(0,l.g2)("q-list"),h=(0,l.g2)("q-slide-transition"),b=(0,l.g2)("q-card"),k=(0,l.g2)("q-icon"),_=(0,l.g2)("q-img"),v=(0,l.g2)("q-input"),y=(0,l.g2)("q-tooltip"),F=(0,l.g2)("q-btn"),w=(0,l.g2)("q-item-label"),C=(0,l.g2)("q-file"),L=(0,l.g2)("q-toggle"),x=(0,l.g2)("q-btn-group"),A=(0,l.g2)("q-dialog"),q=(0,l.g2)("q-form"),E=(0,l.g2)("q-card-actions"),I=(0,l.g2)("q-select"),P=(0,l.g2)("q-page"),S=(0,l.g2)("atom-spinner");return i.loading?((0,l.uX)(),(0,l.Wv)(P,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",pp,[(0,l.Lk)("div",mp,[(0,l.bF)(c,{glossy:"",class:"glossy btn-cyan-pph",icon:"print",direction:"right"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"","external-label":"","label-position":"bottom",label:"Fiche",color:"cyan-4",icon:"description"}),(0,l.bF)(n,{flat:"","external-label":"","label-position":"bottom",label:"Etiquettes",color:"cyan-4",icon:"note_stack"})])),_:1})]),(0,l.Lk)("div",fp," Fiche n°"+(0,g.v_)(i.fiche.id)+" - "+(0,g.v_)(i.fiche.prep.nom),1)]),(0,l.Lk)("div",hp,[(0,l.Lk)("div",bp,[this.articles.length?((0,l.uX)(),(0,l.CE)("div",gp,[(0,l.bF)(b,{class:"q-mb-md bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{clickable:"",class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:(0,g.C4)(["text-subtitle1 text-center",i.materiel?"text-orange-4":"text-cyan-4"]),onClick:t[0]||(t[0]=e=>i.materiel=!i.materiel)},{default:(0,l.k6)((()=>[(0,l.eW)(" Matériel ")])),_:1},8,["class"])])),_:1})])),_:1}),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("div",null,[(0,l.bF)(m),(0,l.bF)(p,{class:"text-subtitle2"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.articles,(e=>((0,l.uX)(),(0,l.Wv)(f,{key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.article.nom),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})],512),[[a.aG,i.materiel]])])),_:1})])),_:1})])):(0,l.Q3)("",!0),this.epis.length?((0,l.uX)(),(0,l.CE)("div",kp,[(0,l.bF)(b,{class:"q-mb-md bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{clickable:"",class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(k,{class:"fade-blink",name:"warning",color:"red-4",size:"sm"}),(0,l.bF)(u,{class:(0,g.C4)(["text-subtitle1 text-center q-mr-md",i.expanded?"text-orange-4":"text-cyan-4"]),onClick:t[1]||(t[1]=e=>i.expanded=!i.expanded)},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(this.epis.length)+" EPI ",1)])),_:1},8,["class"])])),_:1})])),_:1}),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("div",null,[(0,l.bF)(m),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.epis,(e=>((0,l.uX)(),(0,l.Wv)(f,{key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.epi.nom),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})],512),[[a.aG,i.expanded]])])),_:1})])),_:1})])):(0,l.Q3)("",!0),(0,l.Lk)("div",null,[(0,l.bF)(b,{class:"bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,{clickable:"",class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:(0,g.C4)(["text-subtitle1 text-center",i.modeOp?"text-orange-4":"text-cyan-4"]),onClick:t[2]||(t[2]=e=>i.modeOp=!i.modeOp)},{default:(0,l.k6)((()=>[(0,l.eW)(" Mode opératoire ")])),_:1},8,["class"])])),_:1})])),_:1}),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("div",null,[(0,l.bF)(m),(0,l.bF)(p,{class:"text-subtitle2"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,(0,g.v_)(i.fiche.prep.mode_operatoire),1)])),_:1})],512),[[a.aG,i.modeOp]])])),_:1})])),_:1})])]),(0,l.Lk)("div",_p,[(0,l.bF)(b,{class:"bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"text-subtitle1 text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Composition de la formule ")])),_:1})])),_:1})])),_:1}),(0,l.bF)(m),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.composition,(o=>((0,l.uX)(),(0,l.Wv)(f,{key:o.id},{default:(0,l.k6)((()=>[(0,l.bF)(d,{clickable:"",class:(0,g.C4)(["row justify-evenly",i.activeCompo===o?"bg-cyan-1":""]),onClick:e=>{i.activeCompo=o,r.appareils(),r.updateQteTheory(o)}},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"col-4 q-pl-sm text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.matiere.nom),1)])),_:2},1024),(0,l.bF)(u,{class:"col-1 text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.result)+(0,g.v_)(o.matiere.unite_mesure.nom),1)])),_:2},1024),(0,l.bF)(u,{class:"col-1 text-orange-4"},{default:(0,l.k6)((()=>[o.matiere.cmr?((0,l.uX)(),(0,l.Wv)(_,{key:0,class:"q-ml-xs fade-blink",src:ri,style:{width:"20px",height:"20px"}})):(0,l.Q3)("",!0)])),_:2},1024),(0,l.bF)(u,{class:"col-2"},{default:(0,l.k6)((()=>[(0,l.bF)(v,{modelValue:o.num_reception,"onUpdate:modelValue":e=>o.num_reception=e,label:"N° réception",color:"cyan-4",onChange:e=>r.updateReception(o)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1024),(0,l.bF)(u,{class:(0,g.C4)(["col-2 text-subtitle2 text-center",o.reception.certificat||o.reception.echantillon?"text-green-4":"text-red-4"])},{default:(0,l.k6)((()=>[(0,l.bF)(w,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.reception.lot)+" ",1),o.reception.isValid&&!o.reception.certificat?((0,l.uX)(),(0,l.Wv)(F,{key:0,flat:"",icon:"add_box",color:"cyan-4",class:"q-pa-none hover-effect-success",size:"xs",onClick:e=>r.addMatiereCertif(o)},{default:(0,l.k6)((()=>[(0,l.bF)(y,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Ajouter un certificat")])),_:1})])),_:2},1032,["onClick"])):(0,l.Q3)("",!0)])),_:2},1024),(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.bF)(A,{modelValue:i.addMatiereLot,"onUpdate:modelValue":t[7]||(t[7]=e=>i.addMatiereLot=e)},{default:(0,l.k6)((()=>[(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[vp,yp,(0,l.Lk)("div",Fp,(0,g.v_)(i.lot),1),wp])),_:1}),(0,l.bF)(m),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Cp,[(0,l.Lk)("div",Lp,[(0,l.bF)(C,{label:"Sélectionner un certificat(.pdf)",accept:".pdf",modelValue:i.certificatReception,"onUpdate:modelValue":t[3]||(t[3]=e=>i.certificatReception=e)},null,8,["modelValue"])])]),i.reception.echantillon?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",xp,[(0,l.Lk)("div",Ap,[(0,l.bF)(L,{label:"Echantillon",color:"green-4",modelValue:i.echantillon,"onUpdate:modelValue":t[4]||(t[4]=e=>i.echantillon=e)},null,8,["modelValue"])]),(0,l.bo)((0,l.Lk)("div",qp,[(0,l.bF)(v,{label:"Quantité",color:"cyan-4",modelValue:i.qte,"onUpdate:modelValue":t[5]||(t[5]=e=>i.qte=e)},{append:(0,l.k6)((()=>[(0,l.Lk)("div",Ep,(0,g.v_)(e.unite),1)])),_:1},8,["modelValue"])],512),[[a.aG,i.echantillon]])]))])),_:1}),(0,l.bF)(m),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ip,[(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.bF)(F,{flat:"",label:"Ajouter",onClick:e=>r.addCertif(o),color:"green-4"},null,8,["onClick"]),(0,l.bF)(F,{flat:"",label:"Annuler",onClick:t[6]||(t[6]=e=>i.addMatiereLot=!1),color:"red-4"})])),_:2},1024)])])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue"])])),_:2},1024),(0,l.bF)(w,{class:"text-subtitle2"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.reception.peremption),1)])),_:2},1024)])),_:2},1032,["class"]),(0,l.bF)(u,{class:"col-2 q-pr-sm"},{default:(0,l.k6)((()=>[o.reception.isValid?((0,l.uX)(),(0,l.Wv)(v,{key:0,modelValue:o.pesee,"onUpdate:modelValue":e=>o.pesee=e,label:"Quantité",color:"cyan-4"},{append:(0,l.k6)((()=>[(0,l.Lk)("div",Pp,(0,g.v_)(o.matiere.unite_mesure.nom),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])])),_:2},1024)))),128))])),_:1}),(0,l.bF)(m),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(E,{class:"justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.bF)(F,{flat:"",color:"green-4",label:"Valider",onClick:r.saveData},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l.Lk)("div",Sp,[i.activeCompo?((0,l.uX)(),(0,l.CE)("div",Vp,[(0,l.bF)(b,{class:"bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"q-pt-none q-pb-xs"},{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(I,{class:"q-mb-xs q-py-none",modelValue:i.appareil,"onUpdate:modelValue":t[8]||(t[8]=e=>i.appareil=e),color:"cyan-4",label:i.activeCompo.type_appareil.nom,options:i.typesAppareil,"option-label":"nom","option-value":"id"},null,8,["modelValue","label","options"])])),_:1})])),_:1})])),_:1}),(0,l.bF)(m),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Qp,(0,g.v_)(i.activeCompo.matiere.nom),1),(0,l.Lk)("div",{class:(0,g.C4)(["row justify-center",r.getDeviationPercentageColor()])},[(0,l.Lk)("div",Mp,(0,g.v_)(this.selectedCompoPesee)+(0,g.v_)(i.qteTheory.unite)+" / "+(0,g.v_)(i.qteTheory.value)+(0,g.v_)(i.qteTheory.unite),1)],2),(0,l.Lk)("div",{class:(0,g.C4)(["row justify-center text-cyan-1",r.getDeviationPercentageColor()])},[(0,l.Lk)("div",Tp," Ecart : "+(0,g.v_)(r.calculateDeviationPercentage())+"% ",1)],2)])),_:1}),i.appareil&&i.btns.length>0?((0,l.uX)(),(0,l.Wv)(m,{key:0})):(0,l.Q3)("",!0),i.appareil&&i.btns.length>0?((0,l.uX)(),(0,l.Wv)(p,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(d,{clickable:"",class:"row",onClick:t[9]||(t[9]=e=>i.buttons=!i.buttons)},{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:(0,g.C4)(["text-center text-subtitle1",i.buttons?"text-orange-4":"text-cyan-4"])},{default:(0,l.k6)((()=>[(0,l.eW)(" Fonctions ")])),_:1},8,["class"])])),_:1})])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("div",null,[(0,l.bF)(m),(0,l.bF)(p,{class:"row justify-evenly"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.btns,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id},[(0,l.Lk)("div",Wp,[(0,l.bF)(F,{flat:"",label:e.action,class:"hover-effect",color:"cyan-4"},{default:(0,l.k6)((()=>[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.description),1)])),_:2},1024)])),_:2},1032,["label"])])])))),128))])),_:1})],512),[[a.aG,i.buttons]])])),_:1})])),_:1})])):(0,l.Q3)("",!0)])])])),_:1})):((0,l.uX)(),(0,l.Wv)(P,{key:1,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Dp,[(0,l.bF)(S,{class:"bg-op-8","animation-duration":1e3,size:100,color:"#ff1d5e"})])])),_:1}))}var Up=o(3949),Np={name:"InfosFiche",components:{AtomSpinner:il.F},data(){return{activeCompo:null,loading:!1,id:null,fiche:[],composition:[],parametres:[],epis:[],articles:[],result:[],expanded:!1,modeOp:!1,habillage:!1,materiel:!1,qteTheory:{value:null,unite:null},selectedCompoPesee:null,typesAppareil:[],appareil:null,lastId:null,reception:[],num_reception:null,addMatiereLot:!1,lot:null,certificatReception:null,echantillon:!1,qte:null,btns:[],buttons:!1}},computed:{...(0,u.L8)("fiches",["allFiches","allParametresFiches"]),...(0,u.L8)("formules",["allCompositions","allParametresFormules","allArticlesFormules"]),...(0,u.L8)("epi",["allEpis","allEpisFormules"]),...(0,u.L8)("appareils",["allAppareils","allInstructionsAppareils"]),...(0,u.L8)("demandes",["allDemandes","allParametresDemandes"]),...(0,u.L8)("matieresPremieres",["allReceptions"])},async created(){await Promise.all([this.loadReceptions(),this.loadCompositions(),this.loadParametresFormules(),this.loadEpisFormules(),this.loadArticlesFormules(),this.loadAppareils(),this.loadInstructionsAppareils()]);const e=this.allFiches;if(this.lastId=Math.max(...e.map((e=>e.id))),this.$route.params.demandeId){this.loadDemandes(),this.loadParametresDemandes(),this.id=this.$route.params.demandeId,this.fiche=this.allDemandes.find((e=>e.id===Number(this.id))),this.fiche.commentaire&&this.showNotification({message:this.fiche.commentaire,type:"info",position:"center"}),this.parametres=this.allParametresDemandes.filter((e=>e.num_demande===this.fiche.id)),this.parametres.forEach((e=>{this.ADD_PARAMETRES_FICHES({num_fiche:this.lastId+1,parametre:e.parametre,valeur_parametre:e.valeur_parametre})})),this.ADD_FICHE({id:this.lastId+1,prep:this.fiche.prep.id,typePrep:this.fiche.typePrep.id,service:this.fiche.service.id,patient:this.fiche.patient,age:this.fiche.age,prescripteur:this.fiche.prescripteur});const e=this.allFiches;this.lastId=Math.max(...e.map((e=>e.id))),this.id=this.lastId}else this.id=this.$route.params.ficheId,this.fiche=this.allFiches.find((e=>e.id===Number(this.id)));this.parametres=this.allParametresFiches.filter((e=>e.num_fiche===this.fiche.id)),this.epis=this.allEpisFormules.filter((e=>e.num_formule===this.fiche.prep.id)),this.articles=this.allArticlesFormules.filter((e=>e.num_formule===this.fiche.prep.id)),this.composition=this.allCompositions.filter((e=>e.num_formule===this.fiche.prep.id)).map((e=>{const t={...e};t.num_reception="",t.reception={isValid:!1},t.pesee=0;const o=e.calcul,a=this.parametres,l=e.qté,s=e.matiere.unite_mesure.nom;return t.result=(0,Up.lE)(o,a,l,s),"ml"===t.matiere.unite_mesure.nom&&t.matiere.densite&&(t.result=(t.result*t.matiere.densite).toFixed(2),t.matiere.unite_mesure.nom="g"),t})),this.loading=!0},watch:{appareil(e){this.handleInput(e)}},methods:{...(0,u.i0)("fiches",["loadFiches","loadParametresFiches","loadLastFicheId","addFiche","addParametresValues"]),...(0,u.i0)("formules",["loadCompositions","loadParametresFormules","loadArticlesFormules"]),...(0,u.i0)("epi",["loadEpis","loadEpisFormules"]),...(0,u.i0)("demandes",["loadDemandes","loadParametresDemandes","loadLastDemandeId"]),...(0,u.i0)("appareils",["loadAppareils","loadInstructionsAppareils"]),...(0,u.i0)("notifications",["showNotification"]),...(0,u.i0)("matieresPremieres",["loadReceptions","addCertificat"]),...(0,u.PY)("fiches",["ADD_FICHE","ADD_PARAMETRES_FICHES"]),appareils(){this.typesAppareil=this.allAppareils.filter((e=>e.type.nom===this.activeCompo.type_appareil.nom)),this.appareil=null,this.btns=[],this.buttons=!1},addMatiereCertif(){this.addMatiereLot=!0,this.lot=this.reception.lot,this.unite=this.reception.matiere.unite_mesure.nom},addCertif(){const e=this.reception.id,t={certificat:this.certificatReception,echantillon:this.echantillon,qte_echantillon:this.qte};this.addCertificat({formData:t,id:e}),this.loadReceptions()},async addReception(e,t,o){e.reception=JSON.parse(JSON.stringify(t))||{},e.reception.peremption=(0,Up.Yq)(o),e.reception.isValid=!0,e.reception.certificat||e.reception.echantillon?!e.reception.certificat&&e.reception.echantillon?(this.showNotification({message:"Aucun certificat d'analyse pour le lot "+e.reception.lot,type:"info"}),this.showNotification({message:"Réception ajoutée",type:"success"})):this.showNotification({message:"Réception ajoutée",type:"success"}):(this.showNotification({message:"Aucun certificat d'analyse, ni d'échantillon pour le lot "+e.reception.lot,type:"info"}),this.showNotification({message:"Réception ajoutée",type:"success"}))},async updateReception(e){const t=await this.allReceptions.find((t=>t.id===Number(e.num_reception)&&t.matiere.id===e.matiere.id)),o=new Date;this.reception=t,o.setDate(o.getDate()+Number(this.fiche.prep.duree));const a=o;let l;t&&(l=new Date(t.peremption)),t?t&&l>a?this.addReception(e,t,l):t&&l<a&&this.showNotification({message:"Date de péremption: "+(0,Up.Yq)(l),type:"info",position:"center",time:2e5,options:{actions:[{label:"Ajouter",color:"green",handler:()=>{this.addReception(e,t,l)}},{label:"Annuler",color:"red",handler:()=>{e.num_reception=""}}]}}):(this.showNotification({message:"Erreur de numéro de réception",type:"error"}),e.num_reception="")},handleInput(e){e?this.btns=this.allInstructionsAppareils.filter((t=>t.modele_appareil===e.id&&!0===t.button)):console.error("Invalid appareil object or ID")},updateQteTheory(e){this.selectedCompoPesee=e.pesee,this.qteTheory.value=e.result,e.matiere.densite?this.qteTheory.unite="g":this.qteTheory.unite=e.matiere.unite_mesure.nom},calculateDeviationPercentage(){const e=Number(this.selectedCompoPesee),t=Number(this.qteTheory.value),o=Math.abs(e-t)/t*100;return o.toFixed(2)},getDeviationPercentageColor(){const e=this.calculateDeviationPercentage();return e<5?"bg-green-4":"bg-red-4"},saveData(){this.parametres.forEach((e=>{const t={num_fiche:this.lastId+1,parametre:e.parametre.id,valeur_parametre:e.valeur_parametre},o=JSON.stringify(t);this.addParametresValues(o)}));const e={id:this.lastId+1,prep:this.fiche.prep.id,typePrep:this.fiche.typePrep.id,service:this.fiche.service.id,patient:this.fiche.patient,age:this.fiche.age,prescripteur:this.fiche.prescripteur};this.addFiche(e)}}},Xp=o(2267);const Op=(0,m.A)(Np,[["render",Rp]]);var jp=Op;E()(Np,"components",{QPage:Qe.A,QFab:fe.A,QFabAction:he.A,QCard:Ce.A,QCardSection:Le.A,QItem:w.A,QItemSection:C.A,QSlideTransition:Xp.A,QSeparator:L.A,QList:F.A,QIcon:x.A,QImg:ns.A,QInput:Ae.A,QItemLabel:dr.A,QBtn:v.A,QTooltip:sr.A,QForm:xe.A,QDialog:we.A,QFile:wu.A,QToggle:mr.A,QBtnGroup:Y.A,QCardActions:Cu.A,QSelect:Fs.A});const $p={class:"row justify-center"},Bp={class:"col-md-12"},Hp={class:"row q-mx-sm"},zp={class:"col-4 offset-4 q-mt-md text-cyan-4 text-h6"},Gp={class:"row justify-center"},Kp={class:"col-2 offset-2 q-mt-sm"},Yp={class:"row q-mt-sm"},Jp={class:"col col-12 justify-center"},Zp={class:"row justify-start"},em={class:"card-content"},tm={class:"absolute-top hover-effect q-my-none text-cyan-1"},om={key:0},am={class:"absolute-top-left hover-effect q-ml-xs q-my-none text-red-4"},lm={class:"absolute-bottom-left"},sm={class:"row q-mb-xs"};function im(e,t,o,s,i,r){const n=(0,l.g2)("q-icon"),c=(0,l.g2)("q-input"),u=(0,l.g2)("q-spinner-rings"),d=(0,l.g2)("q-img"),p=(0,l.g2)("q-btn"),m=(0,l.g2)("q-item-section"),f=(0,l.g2)("q-item"),h=(0,l.g2)("q-list"),b=(0,l.g2)("q-menu"),k=(0,l.g2)("font-awesome-icon"),_=(0,l.g2)("q-btn-group"),v=(0,l.g2)("q-item-label"),y=(0,l.g2)("q-card"),F=(0,l.g2)("q-page"),w=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(F,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",$p,[(0,l.Lk)("div",Bp,[(0,l.Lk)("div",Hp,[(0,l.Lk)("div",zp,[(0,l.Lk)("div",Gp,(0,g.v_)(r.controlCount)+" fiches en attente de contrôle ",1)]),(0,l.Lk)("div",Kp,[(0,l.bF)(c,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e),label:"Recherche...",onInput:r.filteredFiches,color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("searchInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(n,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",Yp,[(0,l.Lk)("div",Jp,[(0,l.Lk)("div",Zp,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredFiches,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:t.id},[t.destruction?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(y,{key:0,bordered:"",class:"card-maxi justify-center items-center text-center relative",onClick:(0,a.D$)((e=>r.redirectToLink(t.id)),["stop"])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",em,[(0,l.bF)(d,{class:"logo-card-mini",src:Bl,alt:t.prep.nom,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(u,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",tm,[(0,l.Lk)("div",null,(0,g.v_)(t.date_fab),1),t.patient?((0,l.uX)(),(0,l.CE)("div",om,(0,g.v_)(t.patient),1)):(0,l.Q3)("",!0),(0,l.Lk)("div",null,(0,g.v_)(t.prep.nom),1)])])),_:2},1032,["alt"]),(0,l.bF)(p,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(b,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(h,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(f,{clickable:"",onClick:(0,a.D$)((o=>e.toggleControle({ficheId:t.id,isControl:t.controle_valide})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"hover-effect-success"},{default:(0,l.k6)((()=>[(0,l.eW)(" Valider contrôle ")])),_:1})])),_:2},1032,["onClick"])),[[w]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(f,{clickable:"",onClick:(0,a.D$)((o=>e.toggleDestruction({ficheId:t.id,isDestroy:t.destruction})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"hover-effect-warning"},{default:(0,l.k6)((()=>[(0,l.eW)("Destruction")])),_:1})])),_:2},1032,["onClick"])),[[w]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",am,[(0,l.Lk)("div",null,"n°"+(0,g.v_)(t.id),1)]),(0,l.Lk)("div",lm,[(0,l.Lk)("div",sm,[t.prep.pediatric?((0,l.uX)(),(0,l.Wv)(k,{key:0,icon:"fa-solid fa-child",class:"q-ml-xs fa-lg",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.prep.froid?((0,l.uX)(),(0,l.Wv)(k,{key:1,fade:"",icon:"fa-solid fa-snowflake",class:"q-ml-xs fa-lg",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.prep.agiter?((0,l.uX)(),(0,l.Wv)(n,{key:2,name:"waving_hand",class:"q-ml-xs",color:"cyan-4",size:"xs"})):(0,l.Q3)("",!0),t.prep.lumiere?((0,l.uX)(),(0,l.Wv)(n,{key:3,name:"light_mode",class:"q-ml-xs",color:"red-4",size:"xs"})):(0,l.Q3)("",!0)])]),(0,l.bF)(_,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"q-pa-none hover-effect",flat:"",color:e.compo[t.id]?"orange-4":"cyan-4",icon:"science",size:"sm",onClick:(0,a.D$)((o=>e.toggleCompo(t.id)),["stop"])},null,8,["color","onClick"]),(0,l.bF)(p,{class:"q-pa-none hover-effect",flat:"",color:e.settings[t.id]?"orange-4":"cyan-4",icon:"settings",size:"sm",onClick:(0,a.D$)((o=>e.toggleSettings(t.id)),["stop"])},null,8,["color","onClick"]),(0,l.bF)(p,{class:"hover-effect",color:e.info[t.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((o=>e.toggleInfo(t.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(b,{class:"row",fit:"",anchor:"bottom right",self:"top middle",modelValue:e.compo[t.id],"onUpdate:modelValue":o=>e.compo[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(h,{class:"col-12"},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Composition de la formule ")])),_:1})])),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredCompositions(t.prep.id),(e=>((0,l.uX)(),(0,l.Wv)(f,{class:"row",key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"col-auto text-orange-4 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.matiere.nom)+" : ",1)])),_:2},1024),(0,l.bF)(m,{class:"col-auto text-grey-7"},{default:(0,l.k6)((()=>[(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(r.getCalculatedQty(e.calcul,r.filteredParametres(t.id),e.qté,e.matiere.unite_mesure.nom))+" "+(0,g.v_)(e.matiere.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024),e.matiere.cmr?((0,l.uX)(),(0,l.Wv)(m,{key:0,class:"col-auto q-ml-none text-grey-7"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"fade-blink",src:ri,style:{width:"20px",height:"20px"}})])),_:1})):(0,l.Q3)("",!0)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(b,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.settings[t.id],"onUpdate:modelValue":o=>e.settings[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(h,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Paramètres de la formule ")])),_:1})])),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredParametres(t.id),(e=>((0,l.uX)(),(0,l.Wv)(f,{class:"row",key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"col-auto text-orange-4 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.parametre.nom)+" : ",1)])),_:2},1024),(0,l.bF)(m,{class:"col-auto text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.valeur_parametre)+(0,g.v_)(e.parametre.unite),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(b,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.info[t.id],"onUpdate:modelValue":o=>e.info[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(h,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Détails de la fiche n° "+(0,g.v_)(t.id),1)])),_:2},1024)])),_:2},1024),t.date_fab?((0,l.uX)(),(0,l.Wv)(f,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(m,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Date d'émission : ")])),_:1}),(0,l.bF)(m,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.date_fab),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.patient?((0,l.uX)(),(0,l.Wv)(f,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(m,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Patient : ")])),_:1}),(0,l.bF)(m,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.patient)+" - "+(0,g.v_)(t.age)+" ans ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.service.nom?((0,l.uX)(),(0,l.Wv)(f,{key:2},{default:(0,l.k6)((()=>[(0,l.bF)(m,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Service : ")])),_:1}),(0,l.bF)(m,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.service.nom),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.prescripteur?((0,l.uX)(),(0,l.Wv)(f,{key:3},{default:(0,l.k6)((()=>[(0,l.bF)(m,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prescripteur : ")])),_:1}),(0,l.bF)(m,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.prescripteur),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["onClick"]))])))),128))])])])])])])),_:1})}var rm=o(1078);const nm=(0,m.A)(rm.A,[["render",im]]);var cm=nm;E()(rm.A,"components",{QPage:Qe.A,QInput:Ae.A,QIcon:x.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A,QItemLabel:dr.A,QField:Qa.A}),E()(rm.A,"directives",{ClosePopup:A.A});const um={class:"row"},dm={class:"col-3 q-mt-md q-pl-lg"},pm={class:"col-6 text-h6 text-cyan-4 q-mt-lg text-center"},mm={class:"row justify-evenly q-mt-md"},fm={class:"col-2"},hm={key:0},bm={class:"row"},gm=(0,l.Lk)("div",{class:"col-10 offset-1 text-subtitle1 text-cyan-4 text-center"}," Matériel ",-1),km={class:"col-1"},_m={key:1},vm={class:"row"},ym={class:"col-1"},Fm={class:"col-10 text-subtitle1 text-cyan-4 text-center"},wm={class:"col-1"},Cm={class:"row"},Lm=(0,l.Lk)("div",{class:"col-10 offset-1 text-subtitle1 text-cyan-4 text-center"}," Mode opératoire ",-1),xm={class:"col-1"},Am={class:"col-7"},qm=(0,l.Lk)("div",{class:"text-subtitle1 text-cyan-4 text-center"}," Composition de la formule ",-1),Em=(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," Ajouter un certificat d'analyse ou un echantillon pour le lot ",-1),Im=(0,l.Lk)("br",null,null,-1),Pm={class:"row justify-center text-subtitle1 text-orange-4"},Sm=(0,l.Lk)("br",null,null,-1),Vm={class:"row justify-center"},Qm={class:"col-12"},Mm={key:0,class:"row"},Tm={class:"col-2 q-mt-sm"},Wm={class:"col-2 offset-2"},Dm={class:"text-cyan-4 text-subtitle2 q-pt-md"},Rm={class:"row justify-center"},Um={class:"text-cyan-4 text-subtitle2 q-pt-md"},Nm={class:"col-2"},Xm={class:"text-center text-h6 text-cyan-1"},Om={class:"text-subtiltle1"},jm={class:"row justify-center"};function $m(e,t,o,s,i,r){const n=(0,l.g2)("q-fab-action"),c=(0,l.g2)("q-fab"),u=(0,l.g2)("q-btn"),d=(0,l.g2)("q-card-section"),p=(0,l.g2)("q-separator"),m=(0,l.g2)("q-item-section"),f=(0,l.g2)("q-item"),h=(0,l.g2)("q-list"),b=(0,l.g2)("q-slide-transition"),k=(0,l.g2)("q-card"),_=(0,l.g2)("q-icon"),v=(0,l.g2)("q-img"),y=(0,l.g2)("q-input"),F=(0,l.g2)("q-tooltip"),w=(0,l.g2)("q-item-label"),C=(0,l.g2)("q-file"),L=(0,l.g2)("q-toggle"),x=(0,l.g2)("q-btn-group"),A=(0,l.g2)("q-dialog"),q=(0,l.g2)("q-form"),E=(0,l.g2)("q-card-actions"),I=(0,l.g2)("q-select"),P=(0,l.g2)("q-page"),S=(0,l.g2)("atom-spinner");return i.loading?((0,l.uX)(),(0,l.Wv)(P,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",um,[(0,l.Lk)("div",dm,[(0,l.bF)(c,{glossy:"",class:"glossy btn-cyan-pph",icon:"print",direction:"right"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"","external-label":"","label-position":"bottom",label:"Fiche",color:"cyan-4",icon:"description"}),(0,l.bF)(n,{flat:"","external-label":"","label-position":"bottom",label:"Etiquettes",color:"cyan-4",icon:"note_stack"})])),_:1})]),(0,l.Lk)("div",pm," Fiche n°"+(0,g.v_)(i.fiche.id)+" - "+(0,g.v_)(i.fiche.prep.nom),1)]),(0,l.Lk)("div",mm,[(0,l.Lk)("div",fm,[this.articles.length?((0,l.uX)(),(0,l.CE)("div",hm,[(0,l.bF)(k,{class:"q-mb-md bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",bm,[gm,(0,l.Lk)("div",km,[(0,l.bF)(u,{color:"grey",class:"hover-effect",round:"",flat:"",dense:"",icon:i.materiel?"keyboard_arrow_up":"keyboard_arrow_down",onClick:t[0]||(t[0]=e=>i.materiel=!i.materiel)},null,8,["icon"])])])])),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("div",null,[(0,l.bF)(p),(0,l.bF)(d,{class:"text-subtitle2"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.articles,(e=>((0,l.uX)(),(0,l.Wv)(h,{key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.article.nom),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})],512),[[a.aG,i.materiel]])])),_:1})])),_:1})])):(0,l.Q3)("",!0),this.epis.length?((0,l.uX)(),(0,l.CE)("div",_m,[(0,l.bF)(k,{class:"q-mb-md bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",vm,[(0,l.Lk)("div",ym,[(0,l.bF)(_,{class:"fade-blink",name:"warning",color:"red-4",size:"sm"})]),(0,l.Lk)("div",Fm,(0,g.v_)(this.epis.length)+" EPI ",1),(0,l.Lk)("div",wm,[(0,l.bF)(u,{color:"grey",class:"hover-effect q-pa-none",round:"",flat:"",dense:"",icon:i.expanded?"keyboard_arrow_up":"keyboard_arrow_down",onClick:t[1]||(t[1]=e=>i.expanded=!i.expanded)},null,8,["icon"])])])])),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("div",null,[(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.epis,(e=>((0,l.uX)(),(0,l.Wv)(h,{key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.epi.nom),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})],512),[[a.aG,i.expanded]])])),_:1})])),_:1})])):(0,l.Q3)("",!0),(0,l.Lk)("div",null,[(0,l.bF)(k,{class:"bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Cm,[Lm,(0,l.Lk)("div",xm,[(0,l.bF)(u,{color:"grey",class:"hover-effect",round:"",flat:"",dense:"",icon:i.modeOp?"keyboard_arrow_up":"keyboard_arrow_down",onClick:t[2]||(t[2]=e=>i.modeOp=!i.modeOp)},null,8,["icon"])])])])),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("div",null,[(0,l.bF)(p),(0,l.bF)(d,{class:"text-subtitle2"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,(0,g.v_)(i.fiche.prep.mode_operatoire),1)])),_:1})],512),[[a.aG,i.modeOp]])])),_:1})])),_:1})])]),(0,l.Lk)("div",Am,[(0,l.bF)(k,{class:"bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[qm])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.composition,(o=>((0,l.uX)(),(0,l.Wv)(h,{key:o.id},{default:(0,l.k6)((()=>[(0,l.bF)(f,{clickable:"",class:"row justify-evenly",onMouseover:e=>r.updateQteTheory(o)},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"col-4 q-pl-sm text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.matiere.nom),1)])),_:2},1024),(0,l.bF)(m,{class:"col-1 text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.result)+(0,g.v_)(o.matiere.unite_mesure.nom),1)])),_:2},1024),(0,l.bF)(m,{class:"col-1 text-orange-4"},{default:(0,l.k6)((()=>[o.matiere.cmr?((0,l.uX)(),(0,l.Wv)(v,{key:0,class:"q-ml-xs fade-blink",src:ri,style:{width:"20px",height:"20px"}})):(0,l.Q3)("",!0)])),_:2},1024),(0,l.bF)(m,{class:"col-2"},{default:(0,l.k6)((()=>[(0,l.bF)(y,{modelValue:o.num_reception,"onUpdate:modelValue":e=>o.num_reception=e,label:"N° réception",color:"cyan-4",onChange:e=>r.updateReception(o)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:2},1024),(0,l.bF)(m,{class:(0,g.C4)(["col-2 text-subtitle2 text-center",o.reception.certificat||o.reception.echantillon?"text-green-4":"text-red-4"])},{default:(0,l.k6)((()=>[(0,l.bF)(w,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.reception.lot)+" ",1),o.reception.isValid&&!o.reception.certificat?((0,l.uX)(),(0,l.Wv)(u,{key:0,flat:"",icon:"add_box",color:"cyan-4",class:"q-pa-none hover-effect-success",size:"xs",onClick:e=>r.addMatiereCertif(o)},{default:(0,l.k6)((()=>[(0,l.bF)(F,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Ajouter un certificat")])),_:1})])),_:2},1032,["onClick"])):(0,l.Q3)("",!0)])),_:2},1024),(0,l.bF)(q,null,{default:(0,l.k6)((()=>[(0,l.bF)(A,{modelValue:i.addMatiereLot,"onUpdate:modelValue":t[7]||(t[7]=e=>i.addMatiereLot=e)},{default:(0,l.k6)((()=>[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[Em,Im,(0,l.Lk)("div",Pm,(0,g.v_)(i.lot),1),Sm])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Vm,[(0,l.Lk)("div",Qm,[(0,l.bF)(C,{label:"Sélectionner un certificat(.pdf)",accept:".pdf",modelValue:i.certificatReception,"onUpdate:modelValue":t[3]||(t[3]=e=>i.certificatReception=e)},null,8,["modelValue"])])]),i.reception.echantillon?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",Mm,[(0,l.Lk)("div",Tm,[(0,l.bF)(L,{label:"Echantillon",color:"green-4",modelValue:i.echantillon,"onUpdate:modelValue":t[4]||(t[4]=e=>i.echantillon=e)},null,8,["modelValue"])]),(0,l.bo)((0,l.Lk)("div",Wm,[(0,l.bF)(y,{label:"Quantité",color:"cyan-4",modelValue:i.qte,"onUpdate:modelValue":t[5]||(t[5]=e=>i.qte=e)},{append:(0,l.k6)((()=>[(0,l.Lk)("div",Dm,(0,g.v_)(e.unite),1)])),_:1},8,["modelValue"])],512),[[a.aG,i.echantillon]])]))])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Rm,[(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",label:"Ajouter",onClick:e=>r.addCertif(o),color:"green-4"},null,8,["onClick"]),(0,l.bF)(u,{flat:"",label:"Annuler",onClick:t[6]||(t[6]=e=>i.addMatiereLot=!1),color:"red-4"})])),_:2},1024)])])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue"])])),_:2},1024),(0,l.bF)(w,{class:"text-subtitle2"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.reception.peremption),1)])),_:2},1024)])),_:2},1032,["class"]),(0,l.bF)(m,{class:"col-2 q-pr-sm"},{default:(0,l.k6)((()=>[o.reception.isValid?((0,l.uX)(),(0,l.Wv)(y,{key:0,modelValue:o.pesee,"onUpdate:modelValue":e=>o.pesee=e,label:"Quantité",color:"cyan-4"},{append:(0,l.k6)((()=>[(0,l.Lk)("div",Um,(0,g.v_)(o.matiere.unite_mesure.nom),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["onMouseover"])])),_:2},1024)))),128))])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(E,{class:"justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",color:"green-4",label:"Valider",onClick:r.saveData},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l.Lk)("div",Nm,[(0,l.Lk)("div",null,[(0,l.bF)(k,{class:"bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"q-pt-none q-pb-xs"},{default:(0,l.k6)((()=>[(0,l.bF)(I,{class:"q-my-none q-py-none",modelValue:i.appareil,"onUpdate:modelValue":t[8]||(t[8]=e=>i.appareil=e),color:"cyan-4",label:"Balance",options:i.balances,"option-label":"nom","option-value":"id",onChange:r.handleInput},null,8,["modelValue","options","onChange"])])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",{class:(0,g.C4)(["row justify-center",r.getDeviationPercentageColor()])},[(0,l.Lk)("div",Xm,(0,g.v_)(this.selectedCompoPesee)+(0,g.v_)(i.qteTheory.unite)+" / "+(0,g.v_)(i.qteTheory.value)+(0,g.v_)(i.qteTheory.unite),1)],2),(0,l.Lk)("div",{class:(0,g.C4)(["row justify-center text-cyan-1",r.getDeviationPercentageColor()])},[(0,l.Lk)("div",Om," Ecart : "+(0,g.v_)(r.calculateDeviationPercentage())+"% ",1)],2)])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(E,{class:"justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",color:"green-4",label:"Valider",class:"hover-effect-succes",onClick:r.saveData},null,8,["onClick"]),(0,l.bF)(u,{flat:"",color:"cyan-4",label:"Tare",class:"hover-effect",onClick:e.Tare},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])])])])),_:1})):((0,l.uX)(),(0,l.Wv)(P,{key:1,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",jm,[(0,l.bF)(S,{class:"bg-op-8","animation-duration":1e3,size:100,color:"#ff1d5e"})])])),_:1}))}var Bm={name:"InfosFiche",components:{AtomSpinner:il.F},data(){return{loading:!1,id:null,fiche:[],composition:[],parametres:[],epis:[],articles:[],result:[],expanded:!1,modeOp:!1,habillage:!1,materiel:!1,qteTheory:{value:null,unite:null},selectedCompoPesee:null,balances:[],appareil:null,lastId:null,reception:[],num_reception:null,addMatiereLot:!1,lot:null,certificatReception:null,echantillon:!1,qte:null}},computed:{...(0,u.L8)("fiches",["allFiches","allParametresFiches"]),...(0,u.L8)("formules",["allCompositions","allParametresFormules","allArticlesFormules"]),...(0,u.L8)("epi",["allEpis","allEpisFormules"]),...(0,u.L8)("appareils",["allAppareils","allInstructionsAppareils"]),...(0,u.L8)("demandes",["allDemandes","allParametresDemandes"]),...(0,u.L8)("matieresPremieres",["allReceptions"])},async created(){await Promise.all([this.loadReceptions(),this.loadCompositions(),this.loadParametresFormules(),this.loadEpisFormules(),this.loadArticlesFormules(),this.loadAppareils()]);const e=this.allFiches;if(this.lastId=Math.max(...e.map((e=>e.id))),this.$route.params.demandeId){this.loadDemandes(),this.loadParametresDemandes(),this.id=this.$route.params.demandeId,this.fiche=this.allDemandes.find((e=>e.id===Number(this.id))),this.fiche.commentaire&&this.showNotification({message:this.fiche.commentaire,type:"info",position:"center"}),this.parametres=this.allParametresDemandes.filter((e=>e.num_demande===this.fiche.id)),this.parametres.forEach((e=>{this.ADD_PARAMETRES_FICHES({num_fiche:this.lastId+1,parametre:e.parametre,valeur_parametre:e.valeur_parametre})})),this.ADD_FICHE({id:this.lastId+1,prep:this.fiche.prep.id,typePrep:this.fiche.typePrep.id,service:this.fiche.service.id,patient:this.fiche.patient,age:this.fiche.age,prescripteur:this.fiche.prescripteur});const e=this.allFiches;this.lastId=Math.max(...e.map((e=>e.id))),this.id=this.lastId}else this.id=this.$route.params.ficheId,this.fiche=this.allFiches.find((e=>e.id===Number(this.id)));this.parametres=this.allParametresFiches.filter((e=>e.num_fiche===this.fiche.id)),this.epis=this.allEpisFormules.filter((e=>e.num_formule===this.fiche.prep.id)),this.articles=this.allArticlesFormules.filter((e=>e.num_formule===this.fiche.prep.id)),this.balances=this.allAppareils.filter((e=>"Balance"===e.type.nom)),this.composition=this.allCompositions.filter((e=>e.num_formule===this.fiche.prep.id)).map((e=>{const t={...e};t.num_reception="",t.reception={isValid:!1},t.pesee=0;const o=e.calcul,a=this.parametres,l=e.qté,s=e.matiere.unite_mesure.nom;return t.result=(0,Up.lE)(o,a,l,s),"ml"===t.matiere.unite_mesure.nom&&t.matiere.densite&&(t.result=(t.result*t.matiere.densite).toFixed(2),t.matiere.unite_mesure.nom="g"),t})),this.loading=!0},methods:{...(0,u.i0)("fiches",["loadFiches","loadParametresFiches","loadLastFicheId","addFiche","addParametresValues"]),...(0,u.i0)("formules",["loadCompositions","loadParametresFormules","loadArticlesFormules"]),...(0,u.i0)("epi",["loadEpis","loadEpisFormules"]),...(0,u.i0)("demandes",["loadDemandes","loadParametresDemandes","loadLastDemandeId"]),...(0,u.i0)("appareils",["loadAppareils","loadInstructionsAppareils","getCalibration"]),...(0,u.i0)("notifications",["showNotification"]),...(0,u.i0)("matieresPremieres",["loadReceptions","addCertificat"]),...(0,u.PY)("fiches",["ADD_FICHE","ADD_PARAMETRES_FICHES"]),addMatiereCertif(){this.addMatiereLot=!0,this.lot=this.reception.lot,this.unite=this.reception.matiere.unite_mesure.nom},addCertif(){const e=this.reception.id;console.log("id",e);const t={certificat:this.certificatReception,echantillon:this.echantillon,qte_echantillon:this.qte};this.addCertificat({formData:t,id:e}),this.loadReceptions()},async addReception(e,t,o){e.reception=JSON.parse(JSON.stringify(t))||{},e.reception.peremption=(0,Up.Yq)(o),e.reception.isValid=!0,console.log("Reception",e.reception),e.reception.certificat||e.reception.echantillon?!e.reception.certificat&&e.reception.echantillon?(this.showNotification({message:"Aucun certificat d'analyse pour le lot "+e.reception.lot,type:"info"}),this.showNotification({message:"Réception ajoutée",type:"success"})):this.showNotification({message:"Réception ajoutée",type:"success"}):(this.showNotification({message:"Aucun certificat d'analyse, ni d'échantillon pour le lot "+e.reception.lot,type:"info"}),this.showNotification({message:"Réception ajoutée",type:"success"}))},async updateReception(e){const t=await this.allReceptions.find((t=>t.id===Number(e.num_reception)&&t.matiere.id===e.matiere.id)),o=new Date;this.reception=t,o.setDate(o.getDate()+Number(this.fiche.prep.duree));const a=o;let l;t&&(l=new Date(t.peremption)),t?t&&l>a?this.addReception(e,t,l):t&&l<a&&this.showNotification({message:"Date de péremption: "+(0,Up.Yq)(l),type:"info",position:"center",time:2e5,options:{actions:[{label:"Ajouter",color:"green",handler:()=>{this.addReception(e,t,l)}},{label:"Annuler",color:"red",handler:()=>{e.num_reception=""}}]}}):(this.showNotification({message:"Erreur de numéro de réception",type:"error"}),e.num_reception="")},handleInput(){console.log("Input event triggered. Selected appareil ID:",this.appareil.id),this.appareil&&this.appareil.id?this.getCalibration(this.appareil.id):console.error("Invalid appareil object or ID")},updateQteTheory(e){this.selectedCompoPesee=e.pesee,this.qteTheory.value=e.result,e.matiere.densite?this.qteTheory.unite="g":this.qteTheory.unite=e.matiere.unite_mesure.nom},calculateDeviationPercentage(){const e=Number(this.selectedCompoPesee),t=Number(this.qteTheory.value),o=Math.abs(e-t)/t*100;return o.toFixed(2)},getDeviationPercentageColor(){const e=this.calculateDeviationPercentage();return e<5?"bg-green-4":"bg-red-4"},saveData(){this.parametres.forEach((e=>{const t={num_fiche:this.lastId+1,parametre:e.parametre.id,valeur_parametre:e.valeur_parametre},o=JSON.stringify(t);this.addParametresValues(o)}));const e={id:this.lastId+1,prep:this.fiche.prep.id,typePrep:this.fiche.typePrep.id,service:this.fiche.service.id,patient:this.fiche.patient,age:this.fiche.age,prescripteur:this.fiche.prescripteur};this.addFiche(e)}}};const Hm=(0,m.A)(Bm,[["render",$m]]);var zm=Hm;E()(Bm,"components",{QPage:Qe.A,QFab:fe.A,QFabAction:he.A,QCard:Ce.A,QCardSection:Le.A,QBtn:v.A,QSlideTransition:Xp.A,QSeparator:L.A,QList:F.A,QItem:w.A,QItemSection:C.A,QIcon:x.A,QImg:ns.A,QInput:Ae.A,QItemLabel:dr.A,QTooltip:sr.A,QForm:xe.A,QDialog:we.A,QFile:wu.A,QToggle:mr.A,QBtnGroup:Y.A,QCardActions:Cu.A,QSelect:Fs.A});const Gm={class:"q-pa-md"},Km=(0,l.Lk)("div",{class:"text-h5 text-center text-cyan-4"},"Nouveau Contrôle",-1),Ym={class:"row"},Jm={class:"row"},Zm={class:"row"},ef={class:"col-8"},tf={class:"row"},of={class:"row justify-center"};function af(e,t,o,a,s,i){const r=(0,l.g2)("q-input"),n=(0,l.g2)("q-select"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-stepper-navigation"),d=(0,l.g2)("q-step"),p=(0,l.g2)("EtapesForm"),m=(0,l.g2)("q-item-section"),f=(0,l.g2)("q-item"),h=(0,l.g2)("q-list"),b=(0,l.g2)("q-btn-group"),g=(0,l.g2)("q-stepper");return(0,l.uX)(),(0,l.CE)("div",Gm,[(0,l.bF)(g,{modelValue:s.step,"onUpdate:modelValue":t[7]||(t[7]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[Km,(0,l.bF)(d,{name:1,title:"Type de contrôle",icon:"biotech",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ym,[(0,l.bF)(r,{required:"",modelValue:s.typeControle.nom,"onUpdate:modelValue":t[0]||(t[0]=e=>s.typeControle.nom=e),color:"cyan-4",class:"col-3 hover-effect",label:"Type de contrôle"},null,8,["modelValue"])]),(0,l.Lk)("div",Jm,[(0,l.bF)(n,{modelValue:s.typeControle.type_appareil,"onUpdate:modelValue":t[1]||(t[1]=e=>s.typeControle.type_appareil=e),color:"cyan-4",class:"col-2 hover-effect",label:"Type d'appareil",options:s.typesAppareils,"option-label":"nom","option-value":"id"},null,8,["modelValue","options"])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[2]||(t[2]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:2,title:"Mode opératoire",icon:"vaccines",done:s.step>2},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Zm,[(0,l.Lk)("div",ef,[(0,l.bF)(p,{controleId:s.controleId,newId:s.newId,rows:s.formRows,onRows:i.rows},null,8,["controleId","newId","rows","onRows"])])]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[3]||(t[3]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[4]||(t[4]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(d,{name:3,title:"Paramètres",icon:"settings",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.Lk)("div",tf,[s.typeControle.structure_formulaire.length>0?((0,l.uX)(),(0,l.Wv)(h,{key:0,bordered:"",class:"col-4"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.typeControle.structure_formulaire,((e,t)=>((0,l.uX)(),(0,l.Wv)(f,{key:t,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(r,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,label:"Nom du champ",required:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{modelValue:e.type,"onUpdate:modelValue":t=>e.type=t,options:s.fieldTypes,label:"Type du champ"},null,8,["modelValue","onUpdate:modelValue","options"])])),_:2},1024),(0,l.bF)(m,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",icon:"delete_forever",onClick:e=>i.removeField(t),color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(c,{flat:"",color:"cyan-4",onClick:i.addField,icon:"add_box",label:"Ajouter",size:"md",class:"hover-effect"},null,8,["onClick"]),s.typeControle.structure_formulaire.length>0?((0,l.uX)(),(0,l.Wv)(c,{key:1,flat:"",color:"green-4",onClick:i.validParametres,icon:"check_circle",label:"Valider",size:"md"},null,8,["onClick"])):(0,l.Q3)("",!0)]),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[5]||(t[5]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(c,{flat:"",onClick:t[6]||(t[6]=e=>s.step=4),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",of,[(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:i.submitForm,color:"green-4",label:"Enregistrer",class:"btn-flat-success-pph"},null,8,["onClick"])])),_:1})])])),_:1},8,["modelValue"])])}var lf={components:{EtapesForm:Wd},data(){return{step:1,newId:"",formRows:[],controleId:"",typesAppareils:[],typeControle:{nom:"",structure_formulaire:[],type_appareil:""},fieldTypes:[{label:"Texte",value:"text"},{label:"Nombre",value:"number"},{label:"Booléen",value:"boolean"}]}},computed:{...(0,u.L8)("controles",["allTypesControles"]),...(0,u.L8)("appareils",["allTypes"])},created(){this.loadTypes(),this.loadTypesAppareils(),this.typesAppareils=this.allTypes,console.log("typesAppareils",this.typesAppareils),this.$route.params.id?this.controleId=this.$route.params.id:this.newId=this.allTypesControles.length+1},methods:{...(0,u.i0)("controles",["addType","loadTypes"]),...(0,u.i0)("appareils",["loadTypesAppareils"]),...(0,u.i0)("notifications",["showNotification"]),...(0,u.i0)("etapes",["addEtapes"]),validParametres(){this.showNotification({message:"Paramètres ajoutés",type:"success"})},addField(){this.typeControle.structure_formulaire.push({name:"",type:""})},removeField(e){this.typeControle.structure_formulaire.splice(e,1)},rows(e){this.formRows=e},submitForm(){this.formRows.forEach((e=>{this.addEtapes(e)}));const e={nom:this.typeControle.nom,structure_formulaire:this.typeControle.structure_formulaire,type_appareil:this.typeControle.type_appareil.id};this.addType(e),this.formRows=[],this.typeControle.nom="",this.typeControle.type_appareil="",this.typeControle.structure_formulaire=[],this.loadTypes()}}};const sf=(0,m.A)(lf,[["render",af]]);var rf=sf;E()(lf,"components",{QStepper:Nl.A,QStep:Xl.A,QInput:Ae.A,QSelect:Fs.A,QStepperNavigation:Ol.A,QBtn:v.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A});const nf={class:"row justify-center"},cf={class:"col-md-12"},uf={class:"row q-mx-sm"},df={class:"col-4 offset-4 q-mt-md text-cyan-4 text-h6"},pf={class:"row justify-center"},mf={class:"col-2 offset-2"},ff={class:"row q-mt-sm"},hf={class:"col col-12 justify-center"},bf={class:"row justify-start"},gf={class:"card-content"},kf={class:"absolute-top hover-effect q-my-none text-cyan-1"},_f={key:0},vf={class:"absolute-top-left hover-effect q-ml-xs q-my-none text-red-4"},yf={class:"absolute-bottom-left"},Ff={class:"row q-mb-xs"};function wf(e,t,o,s,i,r){const n=(0,l.g2)("q-icon"),c=(0,l.g2)("q-input"),u=(0,l.g2)("q-spinner-rings"),d=(0,l.g2)("q-img"),p=(0,l.g2)("q-btn"),m=(0,l.g2)("q-item-section"),f=(0,l.g2)("q-item"),h=(0,l.g2)("q-list"),b=(0,l.g2)("q-menu"),k=(0,l.g2)("font-awesome-icon"),_=(0,l.g2)("q-btn-group"),v=(0,l.g2)("q-item-label"),y=(0,l.g2)("q-card"),F=(0,l.g2)("q-page"),w=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(F,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",nf,[(0,l.Lk)("div",cf,[(0,l.Lk)("div",uf,[(0,l.Lk)("div",df,[(0,l.Lk)("div",pf,(0,g.v_)(r.controlCount)+" fiches validées ",1)]),(0,l.Lk)("div",mf,[(0,l.bF)(c,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e),label:"Recherche...",onInput:r.filteredFiches,color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("searchInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(n,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",ff,[(0,l.Lk)("div",hf,[(0,l.Lk)("div",bf,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredFiches,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:t.id},[(0,l.bF)(y,{bordered:"",class:"card-maxi justify-center items-center text-center relative"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",gf,[(0,l.bF)(d,{class:"logo-card-mini",src:Bl,alt:t.prep.nom,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(u,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",kf,[(0,l.Lk)("div",null,(0,g.v_)(t.date_fab),1),t.patient?((0,l.uX)(),(0,l.CE)("div",_f,(0,g.v_)(t.patient),1)):(0,l.Q3)("",!0),(0,l.Lk)("div",null,(0,g.v_)(t.prep.nom),1)])])),_:2},1032,["alt"]),(0,l.bF)(p,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(b,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(h,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(f,{clickable:"",onClick:(0,a.D$)((o=>e.toggleControle({ficheId:t.id,isControl:t.controle_valide})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"hover-effect-warning"},{default:(0,l.k6)((()=>[(0,l.eW)(" Réattribuer ")])),_:1})])),_:2},1032,["onClick"])),[[w]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",vf,[(0,l.Lk)("div",null,"n°"+(0,g.v_)(t.id),1)]),(0,l.Lk)("div",yf,[(0,l.Lk)("div",Ff,[t.prep.pediatric?((0,l.uX)(),(0,l.Wv)(k,{key:0,icon:"fa-solid fa-child",class:"q-ml-xs fa-lg",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.prep.froid?((0,l.uX)(),(0,l.Wv)(k,{key:1,fade:"",icon:"fa-solid fa-snowflake",class:"q-ml-xs fa-lg",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.prep.agiter?((0,l.uX)(),(0,l.Wv)(n,{key:2,name:"waving_hand",class:"q-ml-xs",color:"cyan-4",size:"xs"})):(0,l.Q3)("",!0),t.prep.lumiere?((0,l.uX)(),(0,l.Wv)(n,{key:3,name:"light_mode",class:"q-ml-xs",color:"red-4",size:"xs"})):(0,l.Q3)("",!0)])]),(0,l.bF)(_,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(p,{class:"q-pa-none hover-effect",flat:"",color:e.compo[t.id]?"orange-4":"cyan-4",icon:"list",size:"sm",onClick:(0,a.D$)((o=>e.toggleCompo(t.id)),["stop"])},null,8,["color","onClick"]),(0,l.bF)(p,{class:"q-pa-none hover-effect",flat:"",color:e.settings[t.id]?"orange-4":"cyan-4",icon:"settings",size:"sm",onClick:(0,a.D$)((o=>e.toggleSettings(t.id)),["stop"])},null,8,["color","onClick"]),(0,l.bF)(p,{class:"hover-effect",color:e.info[t.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((o=>e.toggleInfo(t.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(b,{class:"row",fit:"",anchor:"bottom right",self:"top middle",modelValue:e.compo[t.id],"onUpdate:modelValue":o=>e.compo[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(h,{class:"col-12"},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Composition de la formule ")])),_:1})])),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredCompositions(t.prep.id),(e=>((0,l.uX)(),(0,l.Wv)(f,{class:"row",key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"col-auto text-orange-4 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.matiere.nom)+" : ",1)])),_:2},1024),(0,l.bF)(m,{class:"col-auto text-grey-7"},{default:(0,l.k6)((()=>[(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(r.getCalculatedQty(e.calcul,r.filteredParametres(t.id),e.qté,e.matiere.unite_mesure.nom))+" "+(0,g.v_)(e.matiere.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024),e.matiere.cmr?((0,l.uX)(),(0,l.Wv)(m,{key:0,class:"col-auto q-ml-none text-grey-7"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"fade-blink",src:ri,style:{width:"20px",height:"20px"}})])),_:1})):(0,l.Q3)("",!0)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(b,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.settings[t.id],"onUpdate:modelValue":o=>e.settings[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(h,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Paramètres de la formule ")])),_:1})])),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredParametres(t.id),(e=>((0,l.uX)(),(0,l.Wv)(f,{class:"row",key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"col-auto text-orange-4 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.parametre.nom)+" : ",1)])),_:2},1024),(0,l.bF)(m,{class:"col-auto text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.valeur_parametre)+(0,g.v_)(e.parametre.unite),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(b,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.info[t.id],"onUpdate:modelValue":o=>e.info[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(h,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Détails de la fiche n° "+(0,g.v_)(t.id),1)])),_:2},1024)])),_:2},1024),t.date_fab?((0,l.uX)(),(0,l.Wv)(f,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(m,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Date d'émission : ")])),_:1}),(0,l.bF)(m,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.date_fab),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.patient?((0,l.uX)(),(0,l.Wv)(f,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(m,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Patient : ")])),_:1}),(0,l.bF)(m,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.patient)+" - "+(0,g.v_)(t.age)+" ans ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.service.nom?((0,l.uX)(),(0,l.Wv)(f,{key:2},{default:(0,l.k6)((()=>[(0,l.bF)(m,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Service : ")])),_:1}),(0,l.bF)(m,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.service.nom),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.prescripteur?((0,l.uX)(),(0,l.Wv)(f,{key:3},{default:(0,l.k6)((()=>[(0,l.bF)(m,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prescripteur : ")])),_:1}),(0,l.bF)(m,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.prescripteur),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])))),128))])])])])])])),_:1})}var Cf=o(7151);const Lf=(0,m.A)(Cf.A,[["render",wf]]);var xf=Lf;E()(Cf.A,"components",{QPage:Qe.A,QInput:Ae.A,QIcon:x.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A,QItemLabel:dr.A,QField:Qa.A}),E()(Cf.A,"directives",{ClosePopup:A.A});const Af={class:"q-pa-md"},qf=(0,l.Lk)("div",{class:"text-h5 text-center text-cyan-4"},"Demande",-1),Ef={class:"row"},If={class:"row"},Pf=(0,l.Lk)("div",{class:"text-cyan-4 text-subtitle2"},"Jours",-1),Sf=(0,l.Lk)("div",{class:"text-cyan-4 text-subtitle2"},"Jours",-1),Vf={class:"row"},Qf=(0,l.Lk)("div",{class:"text-cyan-4 text-subtitle2",color:"cyan-4"},"ans",-1),Mf={class:"row"},Tf={class:"row"},Wf={class:"row"},Df={class:"row"},Rf={key:0,class:"row"},Uf={class:"col-1"},Nf={class:"text-cyan-4 text-subtitle2"},Xf={key:1,class:"text-center text-cyan-4"},Of={key:0,class:"row"},jf={class:"col-2"},$f={key:1,class:"text-center text-cyan-4"},Bf={class:"row"},Hf={class:"row justify-center"};function zf(e,t,o,a,s,i){const r=(0,l.g2)("q-icon"),n=(0,l.g2)("q-input"),c=(0,l.g2)("q-toggle"),u=(0,l.g2)("q-btn"),d=(0,l.g2)("q-stepper-navigation"),p=(0,l.g2)("q-step"),m=(0,l.g2)("q-select"),f=(0,l.g2)("q-item-section"),h=(0,l.g2)("q-item"),b=(0,l.g2)("q-list"),k=(0,l.g2)("q-btn-group"),_=(0,l.g2)("q-stepper"),v=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.CE)("div",Af,[(0,l.bF)(_,{modelValue:s.step,"onUpdate:modelValue":t[48]||(t[48]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[qf,(0,l.bF)(p,{name:1,title:"Plannification",icon:"calendar_month",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Ef,[(0,l.bF)(n,{type:"date",ref:"dateInput",class:"q-mr-lg col-2",modelValue:s.date_prevu,"onUpdate:modelValue":t[0]||(t[0]=e=>s.date_prevu=e),label:"Date prévue",color:"cyan-4",onMouseover:t[1]||(t[1]=t=>e.changeLabelColor("dateInput","#ffb74d")),onMouseleave:t[2]||(t[2]=t=>e.changeLabelColor("dateInput","")),onFocus:t[3]||(t[3]=t=>e.onFocus("date_prevu","#4dd0e1")),onBlur:t[4]||(t[4]=t=>e.onBlur("date_prevu"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"calendar_month",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(c,{modelValue:s.toggleRepeat,"onUpdate:modelValue":t[5]||(t[5]=e=>s.toggleRepeat=e),icon:"calendar_month",color:"purple-4",size:"md",label:"Répéter",class:"col-2"},null,8,["modelValue"])]),(0,l.Lk)("div",If,[s.toggleRepeat?((0,l.uX)(),(0,l.Wv)(n,{key:0,ref:"repeatInput",class:"q-mr-lg col-2",modelValue:s.repeat,"onUpdate:modelValue":t[6]||(t[6]=e=>s.repeat=e),label:"Répétition",color:"cyan-4",onMouseover:t[7]||(t[7]=t=>e.changeLabelColor("dateInput","#ffb74d")),onMouseleave:t[8]||(t[8]=t=>e.changeLabelColor("dateInput","")),onFocus:t[9]||(t[9]=t=>e.onFocus("date_prevu","#4dd0e1")),onBlur:t[10]||(t[10]=t=>e.onBlur("date_prevu"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"update",color:"cyan-4"})])),append:(0,l.k6)((()=>[Pf])),_:1},8,["modelValue"])):(0,l.Q3)("",!0),s.toggleRepeat?((0,l.uX)(),(0,l.Wv)(n,{key:1,ref:"repeatInput",class:"q-mr-lg col-2",modelValue:s.delai,"onUpdate:modelValue":t[11]||(t[11]=e=>s.delai=e),label:"Délai",color:"cyan-4",onMouseover:t[12]||(t[12]=t=>e.changeLabelColor("dateInput","#ffb74d")),onMouseleave:t[13]||(t[13]=t=>e.changeLabelColor("dateInput","")),onFocus:t[14]||(t[14]=t=>e.onFocus("date_prevu","#4dd0e1")),onBlur:t[15]||(t[15]=t=>e.onBlur("date_prevu"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"alarm",color:"cyan-4"})])),append:(0,l.k6)((()=>[Sf])),_:1},8,["modelValue"])):(0,l.Q3)("",!0)]),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[16]||(t[16]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(p,{name:2,title:"Patient",icon:"personal_injury",done:s.step>2},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Vf,[(0,l.bF)(n,{ref:"nomInput",class:"q-mr-lg col-3",modelValue:s.patient,"onUpdate:modelValue":t[17]||(t[17]=e=>s.patient=e),label:"Nom et prénom",color:"cyan-4",onMouseover:t[18]||(t[18]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[19]||(t[19]=t=>e.changeLabelColor("nameInput","")),onFocus:t[20]||(t[20]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[21]||(t[21]=t=>e.onBlur("name"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"badge",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(n,{ref:"ageInput",class:"q-mr-lg col-1",modelValue:s.age,"onUpdate:modelValue":t[22]||(t[22]=e=>s.age=e),label:"Age",color:"cyan-4",onMouseover:t[23]||(t[23]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[24]||(t[24]=t=>e.changeLabelColor("nameInput","")),onFocus:t[25]||(t[25]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[26]||(t[26]=t=>e.onBlur("name"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"badge",color:"cyan-4"})])),append:(0,l.k6)((()=>[Qf])),_:1},8,["modelValue"])]),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[27]||(t[27]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(u,{flat:"",onClick:t[28]||(t[28]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(p,{name:3,title:"Demandeur",icon:"person_book",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Mf,[(0,l.bF)(m,{modelValue:s.service,"onUpdate:modelValue":t[29]||(t[29]=e=>s.service=e),color:"cyan-4",class:"col-2 hover-effect",label:"Service",options:s.allServicesLabel,"option-label":"label","option-value":"value"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"groups",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",Tf,[(0,l.bF)(n,{modelValue:s.prescripteur,"onUpdate:modelValue":t[30]||(t[30]=e=>s.prescripteur=e),color:"cyan-4",class:"col-3 hover-effect",label:"Prescripteur"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"badge",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[31]||(t[31]=e=>s.step=4),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(u,{flat:"",onClick:t[32]||(t[32]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(p,{name:4,title:"Formule",icon:"local_pharmacy",done:s.step>4},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Wf,[(0,l.bF)(m,{modelValue:s.typePrep,"onUpdate:modelValue":t[33]||(t[33]=e=>s.typePrep=e),color:"cyan-4",class:"col-2 hover-effect",label:"Type",options:s.allTypePrepLabel,"option-label":"label","option-value":"value",onInput:i.onTypeChange},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"local_pharmacy",color:"cyan-4"})])),_:1},8,["modelValue","options","onInput"])]),(0,l.Lk)("div",Df,[(0,l.bF)(m,{modelValue:s.formule,"onUpdate:modelValue":t[34]||(t[34]=e=>s.formule=e),color:"cyan-4",class:"col-3 hover-effect",label:"Formule",options:s.allFormulesLabel,"option-label":"label","option-value":"value",onInput:i.onFormuleChange},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"local_pharmacy",color:"cyan-4"})])),_:1},8,["modelValue","options","onInput"])]),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[35]||(t[35]=e=>s.step=5),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(u,{flat:"",onClick:t[36]||(t[36]=e=>s.step=3),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(p,{name:5,title:"Paramètres",icon:"settings",done:s.step>5},{default:(0,l.k6)((()=>[s.parametres.length>0?((0,l.uX)(),(0,l.CE)("div",Rf,[(0,l.Lk)("div",Uf,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.parametres,((e,t)=>((0,l.uX)(),(0,l.CE)("div",{key:t},[(0,l.bF)(n,{label:e.parametre.nom,color:"cyan-4",modelValue:e.valeur_parametre,"onUpdate:modelValue":t=>e.valeur_parametre=t},{append:(0,l.k6)((()=>[(0,l.Lk)("div",Nf,(0,g.v_)(e.parametre.unite),1)])),_:2},1032,["label","modelValue","onUpdate:modelValue"])])))),128))])])):((0,l.uX)(),(0,l.CE)("div",Xf,"Aucun paramètre trouvé pour cette formule.")),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[37]||(t[37]=e=>s.step=6),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(u,{flat:"",onClick:t[38]||(t[38]=e=>s.step=4),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(p,{name:6,title:"Composition",icon:"science",done:s.step>6},{default:(0,l.k6)((()=>[s.compositions.length>0?((0,l.uX)(),(0,l.CE)("div",Of,[(0,l.Lk)("div",jf,[(0,l.bF)(b,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.compositions,((e,t)=>(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:"",key:t},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.matiere.nom)+" "+(0,g.v_)(e.qté)+" "+(0,g.v_)(e.matiere.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024)),[[v]]))),128))])),_:1})])])):((0,l.uX)(),(0,l.CE)("div",$f,"Aucune composition trouvée pour cette formule.")),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[39]||(t[39]=e=>s.step=7),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(u,{flat:"",onClick:t[40]||(t[40]=e=>s.step=5),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(p,{name:7,title:"Commentaire",icon:"edit_note",done:s.step>7},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Bf,[(0,l.bF)(n,{ref:"comInput",class:"q-mr-lg col-3",modelValue:s.commentaire,"onUpdate:modelValue":t[41]||(t[41]=e=>s.commentaire=e),label:"Commentaire",color:"cyan-4",onMouseover:t[42]||(t[42]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[43]||(t[43]=t=>e.changeLabelColor("nameInput","")),onFocus:t[44]||(t[44]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[45]||(t[45]=t=>e.onBlur("name"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"edit_note",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[46]||(t[46]=e=>s.step=8),color:"cyan-4",label:"Terminer",class:"hover-effect"}),(0,l.bF)(u,{flat:"",onClick:t[47]||(t[47]=e=>s.step=6),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",Hf,[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:i.validDemande,color:"green-4",label:"Enregistrer",class:"btn-flat-success-pph"},null,8,["onClick"]),(0,l.bF)(u,{flat:"",color:"red-4",label:"Supprimer",class:"btn-flat-danger-pph"})])),_:1})])])),_:1},8,["modelValue"])])}var Gf={data(){return{step:1,toggleRepeat:!1,repeat:"",delai:"",patient:"",age:"",typePrep:null,formule:null,prescripteur:null,commentaire:null,service:"",date_prevu:"",allTypePrepLabel:[],allFormulesLabel:[],allServicesLabel:[],parametres:[],valeurParametre:null,compositions:[]}},computed:{...(0,u.L8)("formules",["allTypes","allListes","allFormules","allParametresFormules","allParametres","allCompositions"]),...(0,u.L8)("voiesAdministration",["allVoies"]),...(0,u.L8)("services",["allServices"]),...(0,u.L8)("demandes",["allDemandes"])},created(){this.loadTypes(),this.loadFormules(),this.loadParametres(),this.loadParametresFormules(),this.loadCompositions(),this.loadServices(),this.loadDemandes(),this.allTypePrepLabel=this.allTypes.map((e=>({label:e.nom,value:e.id}))),this.allServicesLabel=this.allServices.map((e=>({label:e.nom,value:e.id}))),console.log("allservices: ",this.allServices),console.log("Service: ",this.service.nom)},watch:{typePrep:"onTypeChange",formule:"onFormuleChange"},methods:{...(0,u.i0)("formules",["loadTypes","loadFormules","loadParametresFormules","loadParametres","loadCompositions"]),...(0,u.i0)("demandes",["addDemande","addParametresValues","loadDemandes"]),...(0,u.i0)("services",["addService","loadServices"]),onFormuleChange(){this.formule?(this.parametres=this.allParametresFormules.filter((e=>e.num_formule===this.formule.value)),this.compositions=this.allCompositions.filter((e=>e.num_formule===this.formule.value))):(this.parametres=[],this.compositions=[])},onTypeChange(){this.typePrep?this.allFormulesLabel=this.allFormules.filter((e=>e.type.id===this.typePrep.value&&!0===e.is_activate)).map((e=>({label:e.nom,value:e.id}))):this.allFormulesLabel=this.allFormules.map((e=>({label:e.nom,value:e.id})))},async validDemande(){const e=this.allDemandes;if(0===e.length)return void console.error("Aucune demande n'a été trouvée.");const t=Math.max(...e.map((e=>e.id))),o=[];this.parametres.forEach((e=>{const a={num_demande:t+1,parametre:e.parametre.id,valeur_parametre:e.valeur_parametre};o.push(a)})),console.log(o);const a=JSON.stringify(o);console.log(a),this.addParametresValues(a);const l={date_prevu:this.date_prevu,recurence:this.repeat,delai:this.delai,prep:this.formule.value,typePrep:this.typePrep.value,service:this.service.value,patient:this.patient,age:this.age,prescripteur:this.prescripteur,commentaire:this.commentaire};this.addDemande(l),this.date_prevu="",this.toggleRepeat=!1,this.repeat="",this.delai="",this.formule=null,this.typePrep=null,this.service="",this.patient="",this.age="",this.prescripteur="",this.commentaire="",this.step=1}}};const Kf=(0,m.A)(Gf,[["render",zf]]);var Yf=Kf;E()(Gf,"components",{QStepper:Nl.A,QStep:Xl.A,QInput:Ae.A,QIcon:x.A,QToggle:mr.A,QStepperNavigation:Ol.A,QBtn:v.A,QSelect:Fs.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A}),E()(Gf,"directives",{ClosePopup:A.A});const Jf={class:"row justify-center"},Zf={class:"col-md-12"},eh={class:"row q-mx-sm q-mt-sm"},th={class:"col-3 q-mt-sm"},oh={class:"row"},ah={class:"col-4 offset-1 q-mt-md text-cyan-4 text-h6"},lh={class:"row justify-center"},sh={class:"col-2 offset-2"},ih={class:"row q-mt-sm"},rh={class:"col col-12 justify-center"},nh={class:"row justify-start"},ch={class:"card-content"},uh={class:"absolute-top hover-effect q-my-none text-cyan-1"},dh={class:"row justify-center text-h6 text-cyan-4"},ph={class:"row justify-center text-subtitle1 text-orange-4"},mh={class:"row"},fh={class:"col-4"},hh=(0,l.Lk)("div",{class:"text-subtitle2 text-cyan-4 q-mb-none q-pa-none"},"jours",-1),bh={class:"row justify-center"},gh={key:0,class:"absolute-top-left row q-ml-xs q-mt-xs"},kh={class:"text-cyan-4"},_h={class:"absolute-bottom-left"},vh={class:"row q-mb-xs"};function yh(e,t,o,s,i,r){const n=(0,l.g2)("q-btn"),c=(0,l.g2)("router-link"),u=(0,l.g2)("q-icon"),d=(0,l.g2)("q-input"),p=(0,l.g2)("q-spinner-rings"),m=(0,l.g2)("q-img"),f=(0,l.g2)("q-item-section"),h=(0,l.g2)("q-item"),b=(0,l.g2)("q-list"),k=(0,l.g2)("q-menu"),_=(0,l.g2)("q-card-section"),v=(0,l.g2)("q-separator"),y=(0,l.g2)("q-btn-group"),F=(0,l.g2)("q-card"),w=(0,l.g2)("q-dialog"),C=(0,l.g2)("q-form"),L=(0,l.g2)("font-awesome-icon"),x=(0,l.g2)("q-item-label"),A=(0,l.g2)("q-page"),q=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(A,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Jf,[(0,l.Lk)("div",Zf,[(0,l.Lk)("div",eh,[(0,l.Lk)("div",th,[(0,l.Lk)("div",oh,[(0,l.bF)(c,{to:"/demande/"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{round:"",class:"glossy btn-cyan-pph",icon:"add_box"})])),_:1})])]),(0,l.Lk)("div",ah,[(0,l.Lk)("div",lh,(0,g.v_)(r.controlCount)+" demandes en attente ",1)]),(0,l.Lk)("div",sh,[(0,l.bF)(d,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e),label:"Recherche...",onInput:r.filteredDemandes,color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("searchInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(u,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",ih,[(0,l.Lk)("div",rh,[(0,l.Lk)("div",nh,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredDemandes,(o=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:o.id},[o.production?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(F,{key:0,bordered:"",class:"card-maxi justify-center items-center text-center relative"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ch,[(0,l.bF)(m,{class:"logo-card-mini",src:Bl,alt:o.prep.nom,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(p,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",uh,[(0,l.Lk)("div",null,(0,g.v_)(o.prep.nom),1),(0,l.Lk)("div",null,(0,g.v_)(o.prep.type.nom),1),(0,l.Lk)("div",null,"Pour le "+(0,g.v_)(o.date_prevu),1)])])),_:2},1032,["alt"]),(0,l.bF)(n,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((t=>e.toggleMenu(o.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(k,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[o.id],"onUpdate:modelValue":t=>e.showMenu[o.id]=t},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{to:{name:"GenerateFiche",params:{demandeId:o.id}},class:"pph-link"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect-success text-black"},{default:(0,l.k6)((()=>[(0,l.eW)(" Mise en production ")])),_:1})])),_:2},1032,["to"])])),_:2},1024)),[[q]]),o.recurence?(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{key:0,clickable:"",onClick:(0,a.D$)((t=>e.stopRepeat({demandeId:o.id})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect-warning"},{default:(0,l.k6)((()=>[(0,l.eW)("Stopper répétition")])),_:1})])),_:2},1032,["onClick"])),[[q]]):(0,l.Q3)("",!0),o.recurence?(0,l.Q3)("",!0):(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{key:1,clickable:"",onClick:(0,a.D$)((t=>e.toggleRepeat(o.id)),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect-info"},{default:(0,l.k6)((()=>[(0,l.eW)("Ajouter répétition")])),_:1})])),_:2},1032,["onClick"])),[[q]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:"",onClick:(0,a.D$)((t=>e.deleteDemande(o.id)),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect-warning"},{default:(0,l.k6)((()=>[(0,l.eW)("Supprimer")])),_:1})])),_:2},1032,["onClick"])),[[q]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)(w,{modelValue:e.repeatDialog[o.id],"onUpdate:modelValue":t=>e.repeatDialog[o.id]=t},{default:(0,l.k6)((()=>[(0,l.bF)(F,null,{default:(0,l.k6)((()=>[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",dh," Répétition pour la demande n°"+(0,g.v_)(o.id),1),(0,l.Lk)("div",ph,(0,g.v_)(o.prep.nom),1)])),_:2},1024),(0,l.bF)(v),(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",mh,[(0,l.Lk)("div",fh,[(0,l.bF)(d,{modelValue:i.repeat,"onUpdate:modelValue":t[5]||(t[5]=e=>i.repeat=e),label:"Répétition",color:"cyan-4"},{append:(0,l.k6)((()=>[hh])),_:1},8,["modelValue"])])])])),_:1}),(0,l.bF)(v),(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",bh,[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"",label:"Valider",onClick:(0,a.D$)((t=>{e.addRepeat({demandeId:o.id,repeatTime:this.repeat}),e.toggleRepeat(o.id)}),["stop"]),color:"green-4"},null,8,["onClick"]),(0,l.bF)(n,{flat:"",label:"Annuler",onClick:(0,a.D$)((t=>e.toggleRepeat(o.id)),["stop"]),color:"red-4"},null,8,["onClick"])])),_:2},1024)])])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024),o.recurence?((0,l.uX)(),(0,l.CE)("div",gh,[(0,l.bF)(u,{name:"update",color:"cyan-4",size:"xs"}),(0,l.Lk)("div",kh,(0,g.v_)(o.recurence)+"j",1)])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",_h,[(0,l.Lk)("div",vh,[o.prep.pediatric?((0,l.uX)(),(0,l.Wv)(L,{key:0,icon:"fa-solid fa-child",class:"q-ml-xs fa-lg",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),o.prep.froid?((0,l.uX)(),(0,l.Wv)(L,{key:1,fade:"",icon:"fa-solid fa-snowflake",class:"q-ml-xs fa-lg",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),o.prep.agiter?((0,l.uX)(),(0,l.Wv)(u,{key:2,name:"waving_hand",class:"q-ml-xs",color:"cyan-4",size:"xs"})):(0,l.Q3)("",!0),o.prep.lumiere?((0,l.uX)(),(0,l.Wv)(u,{key:3,name:"light_mode",class:"q-ml-xs",color:"red-4",size:"xs"})):(0,l.Q3)("",!0)])]),(0,l.bF)(y,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"q-pa-none hover-effect",flat:"",color:e.compo[o.id]?"orange-4":"cyan-4",icon:"science",size:"sm",onClick:(0,a.D$)((t=>e.toggleCompo(o.id)),["stop"])},null,8,["color","onClick"]),(0,l.bF)(n,{class:"hover-effect",color:e.settings[o.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"settings",size:"sm",onClick:(0,a.D$)((t=>e.toggleSettings(o.id)),["stop"])},null,8,["color","onClick"]),(0,l.bF)(n,{class:"hover-effect",color:e.expanded[o.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((t=>e.toggleInfo(o.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(k,{class:"row",fit:"",anchor:"bottom right",self:"top middle",modelValue:e.compo[o.id],"onUpdate:modelValue":t=>e.compo[o.id]=t},{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:"col-12"},{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Composition de la formule ")])),_:1})])),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredCompositions(o.prep.id),(e=>((0,l.uX)(),(0,l.Wv)(h,{class:"row",key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"col-auto text-orange-4 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.matiere.nom)+" : ",1)])),_:2},1024),(0,l.bF)(f,{class:"col-auto text-grey-7"},{default:(0,l.k6)((()=>[(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(r.getCalculatedQty(e.calcul,r.filteredParametres(o.id),e.qté,e.matiere.unite_mesure.nom))+" "+(0,g.v_)(e.matiere.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024),e.matiere.cmr?((0,l.uX)(),(0,l.Wv)(f,{key:0,class:"col-auto q-ml-none text-grey-7"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"fade-blink",src:ri,style:{width:"20px",height:"20px"}})])),_:1})):(0,l.Q3)("",!0)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(k,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.settings[o.id],"onUpdate:modelValue":t=>e.settings[o.id]=t},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Paramètres de la formule ")])),_:1})])),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredParametres(o.id),(e=>((0,l.uX)(),(0,l.Wv)(h,{class:"row",key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"col-auto text-orange-4 text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.parametre.nom)+" : ",1)])),_:2},1024),(0,l.bF)(f,{class:"col-auto text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.valeur_parametre)+(0,g.v_)(e.parametre.unite),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(k,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[o.id],"onUpdate:modelValue":t=>e.expanded[o.id]=t},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Détails de la demande n° "+(0,g.v_)(o.id),1)])),_:2},1024)])),_:2},1024),o.date_demande?((0,l.uX)(),(0,l.Wv)(h,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Date d'émission : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.date_demande),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.patient?((0,l.uX)(),(0,l.Wv)(h,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Patient : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.patient)+" - "+(0,g.v_)(o.age)+" ans ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.service.nom?((0,l.uX)(),(0,l.Wv)(h,{key:2},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Service : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.service.nom),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.prescripteur?((0,l.uX)(),(0,l.Wv)(h,{key:3},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prescripteur : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.prescripteur),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.commentaire?((0,l.uX)(),(0,l.Wv)(h,{key:4},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Commentaire : ")])),_:1}),(0,l.bF)(f,{class:"row items-center text-grey-7 hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.commentaire),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024))])))),128))])])])])])])),_:1})}var Fh=o(1458);const wh=(0,m.A)(Fh.A,[["render",yh]]);var Ch=wh;E()(Fh.A,"components",{QPage:Qe.A,QBtn:v.A,QInput:Ae.A,QIcon:x.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QForm:xe.A,QDialog:we.A,QCardSection:Le.A,QSeparator:L.A,QBtnGroup:Y.A,QItemLabel:dr.A,QField:Qa.A}),E()(Fh.A,"directives",{ClosePopup:A.A});const Lh={class:"row justify-center"},xh={class:"col-md-12"},Ah={class:"row q-mx-sm q-mt-sm"},qh={class:"col-3 q-mt-sm"},Eh={class:"col-6 q-mt-md text-cyan-4 text-h6"},Ih={class:"row justify-center"},Ph={class:"col-2 offset-1"},Sh={class:"row q-mt-sm"},Vh={class:"col col-12 justify-center"},Qh={class:"row justify-start"},Mh=["onClick"],Th=["onClick"],Wh={class:"absolute-top-left row q-ml-xs q-mt-xs"},Dh={class:"absolute-bottom-left"},Rh={class:"row q-mb-xs"},Uh={class:"text-orange-4"},Nh={class:"text-grey-7"},Xh=(0,l.Lk)("div",{class:"text-bold"},"Calcul : ",-1),Oh={class:"text-italic"};function jh(e,t,o,s,i,r){const n=(0,l.g2)("q-fab-action"),c=(0,l.g2)("router-link"),u=(0,l.g2)("q-fab"),d=(0,l.g2)("q-icon"),p=(0,l.g2)("q-input"),m=(0,l.g2)("q-spinner-rings"),f=(0,l.g2)("q-img"),h=(0,l.g2)("q-btn"),b=(0,l.g2)("q-item-section"),k=(0,l.g2)("q-item"),_=(0,l.g2)("q-list"),v=(0,l.g2)("q-menu"),y=(0,l.g2)("font-awesome-icon"),F=(0,l.g2)("q-btn-group"),w=(0,l.g2)("q-item-label"),C=(0,l.g2)("q-card"),L=(0,l.g2)("q-page"),x=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(L,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Lh,[(0,l.Lk)("div",xh,[(0,l.Lk)("div",Ah,[(0,l.Lk)("div",qh,[(0,l.bF)(u,{glossy:"",class:"glossy btn-cyan-pph",icon:"add_box",direction:"right"},{default:(0,l.k6)((()=>[(0,l.bF)(c,{to:"/nouvelle-formule/"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"","external-label":"","label-position":"bottom",label:"Créer",color:"cyan-4",icon:"add"})])),_:1}),(0,l.bF)(c,{to:"/cloud"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"","external-label":"","label-position":"bottom",label:"Cloud",color:"cyan-4",icon:"cloud"})])),_:1})])),_:1})]),(0,l.Lk)("div",Eh,[(0,l.Lk)("div",Ih,(0,g.v_)(r.countFormules)+" formules référencées ",1)]),(0,l.Lk)("div",Ph,[(0,l.bF)(p,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e),label:"Recherche...",onInput:r.filterFormules,color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("searchInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(d,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",Sh,[(0,l.Lk)("div",Vh,[(0,l.Lk)("div",Qh,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredFormules,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:t.id,onClick:e=>r.redirectToLink(t.id)},[(0,l.bF)(C,{bordered:"",class:(0,g.C4)(["card-maxi justify-center items-center text-center relative",{"bd-red-4":!t.is_activate}])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",{onClick:e=>r.redirectToLink(t.id),class:"card-content"},[(0,l.bF)(f,{class:"logo-card-mini",src:Bl,alt:t.nom,loading:"lazy","spinner-color":"red-4"},{loading:(0,l.k6)((()=>[(0,l.bF)(m,{color:"red-4"})])),default:(0,l.k6)((()=>[t.is_valid?((0,l.uX)(),(0,l.Wv)(d,{key:0,name:"done_all",color:"green-4",class:"icon-background"})):(0,l.Q3)("",!0),t.is_valid?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(d,{key:1,name:"remove_done",color:"red-4",class:"icon-background"})),(0,l.Lk)("div",{class:(0,g.C4)(["absolute-top hover-effect q-my-none",{"text-cyan-1":t.is_activate,"text-red-4":!t.is_activate}])},[(0,l.Lk)("div",null,(0,g.v_)(t.nom),1),(0,l.Lk)("div",null,(0,g.v_)(t.type.nom),1)],2)])),_:2},1032,["alt"]),(0,l.bF)(h,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(v,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(_,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(k,{clickable:"",onClick:(0,a.D$)((o=>e.toggleCloud({formuleId:t.id,isCloud:t.cloud})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.cloud?"Retirer du cloud":"Ajouter au cloud"),1)])),_:2},1024)])),_:2},1032,["onClick"])),[[x]]),t.is_valid?(0,l.bo)(((0,l.uX)(),(0,l.Wv)(k,{key:0,clickable:"",onClick:(0,a.D$)((o=>e.toggleActivation({formuleId:t.id,isActive:t.is_activate})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:(0,g.C4)({"hover-effect-success":!t.is_activate,"hover-effect-warning":t.is_activate})},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.is_activate?"Désactiver":"Activer"),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])),[[x]]):(0,l.Q3)("",!0),t.is_valid?(0,l.Q3)("",!0):(0,l.bo)(((0,l.uX)(),(0,l.Wv)(k,{key:1,clickable:"",onClick:(0,a.D$)((o=>e.validFormule({formuleId:t.id,isValid:t.is_valid})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:"green-4 hover-effect-success"},{default:(0,l.k6)((()=>[(0,l.eW)(" Valider la formule ")])),_:1})])),_:2},1032,["onClick"])),[[x]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.Lk)("div",Wh,[t.cloud?((0,l.uX)(),(0,l.Wv)(d,{key:0,name:"cloud",color:"cyan-4",size:"xs"})):(0,l.Q3)("",!0)])],8,Th),(0,l.Lk)("div",Dh,[(0,l.Lk)("div",Rh,[t.pediatric?((0,l.uX)(),(0,l.Wv)(y,{key:0,icon:"fa-solid fa-child",class:"q-ml-xs fa-lg",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.froid?((0,l.uX)(),(0,l.Wv)(y,{key:1,fade:"",icon:"fa-solid fa-snowflake",class:"q-ml-xs fa-lg",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.agiter?((0,l.uX)(),(0,l.Wv)(d,{key:2,name:"waving_hand",class:"q-ml-xs",color:"cyan-4",size:"xs"})):(0,l.Q3)("",!0),t.lumiere?((0,l.uX)(),(0,l.Wv)(d,{key:3,name:"light_mode",class:"q-ml-xs",color:"red-4",size:"xs"})):(0,l.Q3)("",!0)])]),(0,l.bF)(F,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(h,{class:"q-pa-none hover-effect",flat:"",color:"cyan-4",icon:"bar_chart",size:"sm"}),(0,l.bF)(h,{class:"q-pa-none hover-effect",flat:"",color:e.compo[t.id]?"orange-4":"cyan-4",icon:"science",size:"sm",onClick:(0,a.D$)((o=>e.toggleCompo(t.id)),["stop"])},null,8,["color","onClick"]),(0,l.bF)(h,{class:"q-pa-none hover-effect",flat:"",color:e.settings[t.id]?"orange-4":"cyan-4",icon:"settings",size:"sm",onClick:(0,a.D$)((o=>e.toggleSettings(t.id)),["stop"])},null,8,["color","onClick"]),(0,l.bF)(h,{class:"hover-effect",color:e.expanded[t.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((o=>e.toggleInfo(t.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(v,{class:"row",fit:"",anchor:"bottom right",self:"top middle",modelValue:e.compo[t.id],"onUpdate:modelValue":o=>e.compo[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(_,{class:"col-12"},{default:(0,l.k6)((()=>[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Composition et calcul de la formule ")])),_:1})])),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredCompositions(t.id),(e=>((0,l.uX)(),(0,l.Wv)(k,{class:"row",key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:"col-auto"},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:"row"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Uh,(0,g.v_)(e.matiere.nom)+" : ",1),(0,l.Lk)("div",Nh,(0,g.v_)(e.qté)+" "+(0,g.v_)(e.matiere.unite_mesure.nom),1)])),_:2},1024),(0,l.bF)(w,{class:"row text-no-wrap",caption:""},{default:(0,l.k6)((()=>[Xh,(0,l.Lk)("div",Oh,(0,g.v_)(e.calcul),1)])),_:2},1024)])),_:2},1024),e.matiere.cmr?((0,l.uX)(),(0,l.Wv)(b,{key:0,top:"",class:"col-auto q-ml-none text-grey-7"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"fade-blink",src:ri,style:{width:"20px",height:"20px"}})])),_:1})):(0,l.Q3)("",!0)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(v,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.settings[t.id],"onUpdate:modelValue":o=>e.settings[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(_,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:"text-cyan-4 text-center"},{default:(0,l.k6)((()=>[(0,l.eW)(" Paramètres de la formule ")])),_:1})])),_:1}),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredParametres(t.id),(e=>((0,l.uX)(),(0,l.Wv)(k,{class:"row",key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(b,{class:"col-auto text-no-wrap"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(e.parametre.nom)+" - "+(0,g.v_)(e.parametre.unite),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,l.bF)(v,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[t.id],"onUpdate:modelValue":o=>e.expanded[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(_,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[t.voie?((0,l.uX)(),(0,l.Wv)(k,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(b,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Voie : ")])),_:1}),(0,l.bF)(b,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.voie.nom),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.liste?((0,l.uX)(),(0,l.Wv)(k,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(b,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Liste : ")])),_:1}),(0,l.bF)(b,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.liste.nom)+" € ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["class"])],8,Mh)))),128))])])])])])])),_:1})}var $h={name:"formulaCards",data(){return{searchQuery:"",id:null,epis:[],articles:[]}},computed:{...(0,u.L8)("formules",["allFormules","allCompositions","allParametresFormules","allArticlesFormules","compo","settings","showMenu","expanded"]),...(0,u.L8)("epi",["allEpis","allEpisFormules"]),countFormules(){return Array.isArray(this.filteredFormules)?this.filteredFormules.length:0},filteredFormules(){return this.searchQuery?this.allFormules.filter((e=>e.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.allFormules}},created(){this.loadFormules(),this.loadParametresFormules(),this.loadCompositions()},methods:{...(0,u.i0)("formules",["loadFormules","loadParametresFormules","loadCompositions","toggleActivation","validFormule","toggleInfo","toggleCompo","toggleSettings","toggleMenu","toggleCloud"]),filteredParametres(e){return this.allParametresFormules.filter((t=>t.num_formule===e))},filteredCompositions(e){return this.allCompositions.filter((t=>t.num_formule===e))},filterFormules(){return this.searchQuery?this.allFormules.filter((e=>e.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.allFormules},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/nouvelle-formule/${e}`)}}};const Bh=(0,m.A)($h,[["render",jh]]);var Hh=Bh;E()($h,"components",{QPage:Qe.A,QFab:fe.A,QFabAction:he.A,QInput:Ae.A,QIcon:x.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A,QItemLabel:dr.A,QField:Qa.A}),E()($h,"directives",{ClosePopup:A.A});const zh={class:"q-pa-md"},Gh=(0,l.Lk)("div",{class:"row text-h6 justify-center text-cyan-4"},"Matière première",-1),Kh={class:"row"},Yh=(0,l.Lk)("div",{class:"row text-subtitle1 text-cyan-4 justify-center"}," Ajouter un type de matière première ",-1),Jh={class:"row justify-center"},Zh={class:"row"},eb=(0,l.Lk)("div",{class:"row text-subtitle1 text-cyan-4 justify-center"}," Ajouter une forme de matière première ",-1),tb=(0,l.Lk)("br",null,null,-1),ob=(0,l.Lk)("div",{class:"row"},[(0,l.Lk)("div",{class:"text-cyan-4"},"Unités : ")],-1),ab={class:"row"},lb={class:"row justify-center"},sb={class:"row"},ib={class:"row"},rb={class:"col-8"},nb={class:"row"},cb=(0,l.Lk)("div",{class:"row text-subtitle1 text-cyan-4 justify-center"}," Ajouter un conditionnement ",-1),ub={class:"row justify-center"},db={class:"row"},pb={class:"uniteStockName text-subtitle2 text-cyan-4"},mb={class:"row"},fb=(0,l.Lk)("div",{class:"uniteStockName text-subtitle2 text-cyan-4"},"€",-1),hb={class:"row"},bb={class:"uniteStockName text-subtitle2 text-cyan-4"},gb={class:"row"},kb={class:"row"},_b={class:"row justify-center"};function vb(e,t,o,a,s,i){const r=(0,l.g2)("q-icon"),n=(0,l.g2)("q-input"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-select"),d=(0,l.g2)("q-card-section"),p=(0,l.g2)("q-separator"),m=(0,l.g2)("q-card"),f=(0,l.g2)("q-dialog"),h=(0,l.g2)("q-stepper-navigation"),b=(0,l.g2)("q-step"),k=(0,l.g2)("font-awesome-icon"),_=(0,l.g2)("q-toggle"),v=(0,l.g2)("q-btn-group"),y=(0,l.g2)("q-stepper");return(0,l.uX)(),(0,l.CE)("div",zh,[(0,l.bF)(y,{modelValue:s.step,"onUpdate:modelValue":t[64]||(t[64]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[Gh,(0,l.bF)(b,{name:1,title:"Identification",icon:"info",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Kh,[(0,l.bF)(n,{ref:"nomInput",class:"q-mr-lg col-3",modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.name=e),label:"Nom",color:"cyan-4",onMouseover:t[1]||(t[1]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[2]||(t[2]=t=>e.changeLabelColor("nameInput","")),onFocus:t[3]||(t[3]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[4]||(t[4]=t=>e.onBlur("name"))},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"local_pharmacy",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(u,{modelValue:s.type,"onUpdate:modelValue":t[6]||(t[6]=e=>s.type=e),color:"cyan-4",class:"col-3 hover-effect",label:"Type",options:i.allTypeLabel,"option-label":"label","option-value":"id"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"medication",color:"cyan-4"})])),append:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[5]||(t[5]=e=>s.typeDialog=!0),icon:"add_box",color:"green-4",class:"hover-effect"})])),_:1},8,["modelValue","options"]),(0,l.bF)(f,{modelValue:s.typeDialog,"onUpdate:modelValue":t[13]||(t[13]=e=>s.typeDialog=e)},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[Yh])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{modelValue:s.typeMat,"onUpdate:modelValue":t[7]||(t[7]=e=>s.typeMat=e),label:"Type",color:"cyan-4",onMouseover:t[8]||(t[8]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[9]||(t[9]=t=>e.changeLabelColor("nameInput","")),onFocus:t[10]||(t[10]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[11]||(t[11]=t=>e.onBlur("name"))},null,8,["modelValue"])])),_:1}),(0,l.bF)(p),(0,l.Lk)("div",Jh,[(0,l.bF)(c,{flat:"",onClick:i.validerType,label:"Ajouter",color:"green-4"},null,8,["onClick"]),(0,l.bF)(c,{flat:"",onClick:t[12]||(t[12]=e=>s.typeDialog=!1),label:"Annuler",color:"red-4"})])])),_:1})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Zh,[(0,l.bF)(u,{modelValue:s.forme,"onUpdate:modelValue":t[15]||(t[15]=e=>s.forme=e),color:"cyan-4",class:"col-2 hover-effect",label:"Forme",options:i.allFormeLabel,"option-label":"label","option-value":"id",onInput:i.updateForme},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"medication_liquid",color:"cyan-4"})])),append:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[14]||(t[14]=e=>s.formeDialog=!0),icon:"add_box",color:"green-4",class:"hover-effect"})])),_:1},8,["modelValue","options","onInput"]),(0,l.bF)(f,{modelValue:s.formeDialog,"onUpdate:modelValue":t[24]||(t[24]=e=>s.formeDialog=e)},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[eb])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{modelValue:s.formeMat,"onUpdate:modelValue":t[16]||(t[16]=e=>s.formeMat=e),label:"Forme",color:"cyan-4",onMouseover:t[17]||(t[17]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[18]||(t[18]=t=>e.changeLabelColor("nameInput","")),onFocus:t[19]||(t[19]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[20]||(t[20]=t=>e.onBlur("name"))},null,8,["modelValue"]),tb,ob,(0,l.Lk)("div",ab,[(0,l.bF)(u,{modelValue:s.uniteStock,"onUpdate:modelValue":t[21]||(t[21]=e=>s.uniteStock=e),color:"cyan-4",class:"col-4 hover-effect",label:"Stock",options:i.allUniteLabel,"option-label":"label","option-value":"id"},null,8,["modelValue","options"]),(0,l.bF)(u,{modelValue:s.uniteMes,"onUpdate:modelValue":t[22]||(t[22]=e=>s.uniteMes=e),color:"cyan-4",class:"col-4 offset-1 hover-effect",label:"Mesure",options:i.allUniteLabel,"option-label":"label","option-value":"id"},null,8,["modelValue","options"])])])),_:1}),(0,l.bF)(p),(0,l.Lk)("div",lb,[(0,l.bF)(c,{flat:"",onClick:i.validerForme,label:"Ajouter",color:"green-4"},null,8,["onClick"]),(0,l.bF)(c,{flat:"",onClick:t[23]||(t[23]=e=>s.formeDialog=!1),label:"Annuler",color:"red-4"})])])),_:1})])),_:1},8,["modelValue"])]),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[25]||(t[25]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(b,{name:2,title:"Fournisseur",icon:"forklift",done:s.step>2},{default:(0,l.k6)((()=>[(0,l.Lk)("div",sb,[(0,l.bF)(u,{modelValue:s.fournisseur,"onUpdate:modelValue":t[26]||(t[26]=e=>s.fournisseur=e),color:"cyan-4",class:"col-3 hover-effect",label:"Sélectionnez un fournisseur",options:i.allSuppliersLabel,"option-label":"label","option-value":"id"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"forklift",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[27]||(t[27]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(c,{flat:"",onClick:t[28]||(t[28]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(b,{name:3,title:"Conditionnement",icon:"science",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ib,[(0,l.Lk)("div",rb,[(0,l.Lk)("div",nb,[(0,l.bF)(u,{modelValue:s.cdt,"onUpdate:modelValue":t[30]||(t[30]=e=>s.cdt=e),color:"cyan-4",class:"col-3 hover-effect",label:"Conditionnement",options:i.allCdtLabel,"option-label":"label","option-value":"id"},{append:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[29]||(t[29]=e=>s.cdtDialog=!0),icon:"add_box",color:"green-4",class:"hover-effect"})])),before:(0,l.k6)((()=>[(0,l.bF)(k,{icon:"fa-solid fa-prescription-bottle",style:{color:"#4dd0e1"}})])),_:1},8,["modelValue","options"]),(0,l.bF)(f,{modelValue:s.cdtDialog,"onUpdate:modelValue":t[37]||(t[37]=e=>s.cdtDialog=e)},{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[cb])),_:1}),(0,l.bF)(p),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{modelValue:s.cdtMat,"onUpdate:modelValue":t[31]||(t[31]=e=>s.cdtMat=e),label:"Type",color:"cyan-4",onMouseover:t[32]||(t[32]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[33]||(t[33]=t=>e.changeLabelColor("nameInput","")),onFocus:t[34]||(t[34]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[35]||(t[35]=t=>e.onBlur("name"))},null,8,["modelValue"])])),_:1}),(0,l.bF)(p),(0,l.Lk)("div",ub,[(0,l.bF)(c,{flat:"",onClick:i.validerCdt,label:"Ajouter",color:"green-4"},null,8,["onClick"]),(0,l.bF)(c,{flat:"",onClick:t[36]||(t[36]=e=>s.cdtDialog=!1),label:"Annuler",color:"red-4"})])])),_:1})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",db,[(0,l.bF)(n,{ref:"qteInput",class:"my-0 col-2",modelValue:s.qté_cdt,"onUpdate:modelValue":t[38]||(t[38]=e=>s.qté_cdt=e),label:"Quantité cdt",color:"cyan-4",onMouseover:t[39]||(t[39]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[40]||(t[40]=t=>e.changeLabelColor("nameInput","")),onFocus:t[41]||(t[41]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[42]||(t[42]=t=>e.onBlur("name"))},{append:(0,l.k6)((()=>[(0,l.Lk)("div",pb,(0,g.v_)(i.uniteStockNom),1)])),before:(0,l.k6)((()=>[(0,l.bF)(k,{icon:"fa-solid fa-weight-scale",style:{color:"#4dd0e1"}})])),_:1},8,["modelValue"])])])]),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[43]||(t[43]=e=>s.step=4),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(c,{flat:"",onClick:t[44]||(t[44]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(b,{name:4,title:"Coût",icon:"point_of_sale",done:s.step>4},{default:(0,l.k6)((()=>[(0,l.Lk)("div",mb,[(0,l.bF)(n,{ref:"prixInput",class:"my-0 col-1",modelValue:s.prix,"onUpdate:modelValue":t[45]||(t[45]=e=>s.prix=e),label:"Prix",color:"cyan-4",onMouseover:t[46]||(t[46]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[47]||(t[47]=t=>e.changeLabelColor("nameInput","")),onFocus:t[48]||(t[48]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[49]||(t[49]=t=>e.onBlur("name"))},{append:(0,l.k6)((()=>[fb])),before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"euro",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[50]||(t[50]=e=>s.step=5),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(c,{flat:"",onClick:t[51]||(t[51]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(b,{name:5,title:"Stock",icon:"inventory",done:s.step>5},{default:(0,l.k6)((()=>[(0,l.Lk)("div",hb,[(0,l.bF)(n,{ref:"stockMini",class:"my-0 col-2",modelValue:s.stock_mini,"onUpdate:modelValue":t[52]||(t[52]=e=>s.stock_mini=e),label:"Stock mini",color:"cyan-4",onMouseover:t[53]||(t[53]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[54]||(t[54]=t=>e.changeLabelColor("nameInput","")),onFocus:t[55]||(t[55]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[56]||(t[56]=t=>e.onBlur("name"))},{append:(0,l.k6)((()=>[(0,l.Lk)("div",bb,(0,g.v_)(i.uniteStockNom),1)])),before:(0,l.k6)((()=>[(0,l.bF)(k,{icon:"fa-solid fa-flask",style:{color:"#4dd0e1"}})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",gb,[(0,l.bF)(_,{modelValue:s.stock,"onUpdate:modelValue":t[57]||(t[57]=e=>s.stock=e),color:"green-4",icon:"inventory",label:"Stockée",size:"md"},null,8,["modelValue"]),(0,l.bF)(_,{modelValue:s.cdeAuto,"onUpdate:modelValue":t[58]||(t[58]=e=>s.cdeAuto=e),color:"purple-4",icon:"shopping_cart",label:"Déclenchement des commande",size:"md"},null,8,["modelValue"])]),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[59]||(t[59]=e=>s.step=6),color:"cyan-4",label:"Suivant",class:"hover-effect"}),(0,l.bF)(c,{flat:"",onClick:t[60]||(t[60]=e=>s.step=4),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(b,{name:6,title:"Réglementation",icon:"settings",done:s.step>6},{default:(0,l.k6)((()=>[(0,l.Lk)("div",kb,[(0,l.bF)(u,{modelValue:s.liste,"onUpdate:modelValue":t[61]||(t[61]=e=>s.liste=e),color:"cyan-4",class:"col-2 hover-effect",label:"Liste",options:i.allListeLabel,"option-label":"label","option-value":"id"},{before:(0,l.k6)((()=>[(0,l.bF)(r,{name:"gavel",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[62]||(t[62]=e=>s.step=5),color:"cyan-4",label:"Précédent",class:"hover-effect"}),(0,l.bF)(c,{flat:"",onClick:t[63]||(t[63]=e=>s.step=7),color:"cyan-4",label:"Terminer",class:"hover-effect q-ml-sm"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",_b,[(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:i.submitForm,color:"green-4",label:"Enregistrer",class:"btn-flat-success-pph"},null,8,["onClick"]),(0,l.bF)(c,{flat:"",color:"red-4",label:"Supprimer",class:"btn-flat-danger-pph"})])),_:1})])])),_:1},8,["modelValue"])])}var yb={data(){return{cdtDialog:!1,cdtMat:"",uniteMes:[],uniteStock:[],typeDialog:!1,formeDialog:!1,typeMat:"",formeMat:"",step:1,name:"",type:null,forme:null,fournisseur:null,cdt:"","qté_cdt":"",prix_unit:"",prix:"","qté_stock":"",stock_mini:"",stock:!1,cdeAuto:!1,cde:!1,liste:null,attente_livraison:!1}},computed:{...(0,u.L8)("matieresPremieres",["allTypes","allUnites","allFormes","allCdts"]),...(0,u.L8)("formules",["allListes"]),...(0,u.L8)("suppliers",["allSuppliers"]),allCdtLabel(){return this.allCdts.map((e=>({...e,label:`${e.nom}`,id:`${e.id}`})))},allSuppliersLabel(){return this.allSuppliers.map((e=>({...e,label:`${e.name}`,id:`${e.id}`})))},allTypeLabel(){return this.allTypes.map((e=>({...e,label:`${e.nom}`,id:`${e.id}`})))},allListeLabel(){return this.allListes.map((e=>({...e,label:`${e.nom}`,id:`${e.id}`})))},allUniteLabel(){return this.allUnites.map((e=>({...e,label:`${e.nom}`,id:`${e.id}`})))},allFormeLabel(){return this.allFormes.map((e=>({...e,label:`${e.nom}`,id:`${e.id}`})))},uniteStockNom(){if(this.forme&&this.allUnites){const e=this.allUnites.find((e=>e.id===this.forme.unite_stock.id));return e?e.nom:""}return""}},async mounted(){await this.loadUnites(),await this.loadTypes(),await this.loadListes(),await this.loadFormes(),await this.loadSuppliers(),await this.loadCdt(),console.log("allCdt",this.allCdts)},methods:{...(0,u.i0)("matieresPremieres",["loadTypes","loadFormes","loadUnites","addMatiere","addType","addForme","loadCdt","addCdt"]),...(0,u.i0)("formules",["loadListes"]),...(0,u.i0)("suppliers",["loadSuppliers"]),updateForme(e){this.forme=this.allFormeLabel.find((t=>t.id===e))},async validerCdt(){const e={nom:this.cdtMat};await this.addCdt(e),await this.loadCdt(),this.cdtDialog=!1},async validerType(){const e={nom:this.typeMat};await this.addType(e),await this.loadTypes(),this.typeDialog=!1},async validerForme(){const e={nom:this.formeMat,unite_mesure:this.uniteMes.id,unite_stock:this.uniteStock.id};console.log("formData envoyé:",e),await this.addForme(e),await this.loadFormes(),this.formeDialog=!1},async submitForm(){const e={nom:this.name,type:this.type.id,forme:this.forme.id,fournisseur:this.fournisseur.id,cdt:this.cdt.id,"qté_cdt":this.qté_cdt,prix_unit:this.prix_unit,prix:this.prix,"qté_stock":0,stock_mini:this.stock_mini,stock:this.stock,cde_auto:this.cdeAuto,cde:!1,liste:this.liste.id,attente_livraison:!1};this.addMatiere(e)}}};const Fb=(0,m.A)(yb,[["render",vb]]);var wb=Fb;E()(yb,"components",{QStepper:Nl.A,QStep:Xl.A,QInput:Ae.A,QIcon:x.A,QSelect:Fs.A,QBtn:v.A,QDialog:we.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A,QStepperNavigation:Ol.A,QToggle:mr.A,QBtnGroup:Y.A});const Cb={class:"row justify-center"},Lb={class:"col-md-12"},xb={class:"row q-mx-sm q-mt-sm"},Ab={class:"col-6 offset-3 q-mt-md text-cyan-4 text-h6"},qb={class:"row justify-center"},Eb={class:"col-2 offset-1"},Ib={class:"row q-mt-sm"},Pb={class:"col-12 justify-center"},Sb={class:"row justify-start"},Vb={class:"absolute-top-left q-ml-sm q-mt-xs"},Qb={key:0,class:"text-red-4 text-subtitle2"},Mb={key:1,class:"text-green-4 text-subtitle2"},Tb={key:2,class:"text-red-4 text-subtitle2"},Wb={class:"absolute-bottom-left"},Db={class:"row q-mb-xs"},Rb=(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," Réceptionner ",-1),Ub=(0,l.Lk)("br",null,null,-1),Nb={class:"row justify-center text-subtitle1 text-orange-4"},Xb=(0,l.Lk)("br",null,null,-1),Ob=(0,l.Lk)("div",{class:"row justify-center text-h6 text-cyan-4"}," dans le stock du préparatoire ",-1),jb={class:"row"},$b={class:"col-4"},Bb={class:"row"},Hb={class:"col-5"},zb={class:"col-5 offset-1"},Gb={class:"row justify-center"},Kb={key:0,class:"col-12"},Yb={key:1,class:"col-8 q-mt-sm text-green-4 text-center"},Jb={key:0,class:"row"},Zb={class:"col-5 q-mt-md"},eg={class:"col-3 offset-1"},tg={class:"text-cyan-4 text-subtitle2 q-pt-md"},og={class:"row justify-center"},ag={class:"row justify-center"};function lg(e,t,o,s,i,r){const n=(0,l.g2)("q-icon"),c=(0,l.g2)("q-input"),u=(0,l.g2)("font-awesome-icon"),d=(0,l.g2)("q-spinner-rings"),p=(0,l.g2)("q-img"),m=(0,l.g2)("q-btn"),f=(0,l.g2)("q-item-section"),h=(0,l.g2)("q-item"),b=(0,l.g2)("q-list"),k=(0,l.g2)("q-menu"),_=(0,l.g2)("q-btn-group"),v=(0,l.g2)("q-card-section"),y=(0,l.g2)("q-separator"),F=(0,l.g2)("q-file"),w=(0,l.g2)("q-toggle"),C=(0,l.g2)("q-card"),L=(0,l.g2)("q-dialog"),x=(0,l.g2)("q-form"),A=(0,l.g2)("q-page"),q=(0,l.g2)("atom-spinner"),E=(0,l.gN)("close-popup");return e.loadMatieresPremieres?((0,l.uX)(),(0,l.Wv)(A,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Cb,[(0,l.Lk)("div",Lb,[(0,l.Lk)("div",xb,[(0,l.Lk)("div",Ab,[(0,l.Lk)("div",qb,(0,g.v_)(r.countMatieres)+" matières premières en attente de livraison ",1)]),(0,l.Lk)("div",Eb,[(0,l.bF)(c,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e),label:"Recherche...",onInput:e.filterMatieres,color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("searchInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(n,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",Ib,[(0,l.Lk)("div",Pb,[(0,l.Lk)("div",Sb,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieres,(o=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:o.id},[(0,l.bF)(C,{bordered:"",class:(0,g.C4)(["card-maxi justify-center items-center text-center relative",{"bd-red-4":!o.stockee}])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.bF)(p,{class:"logo-card-mini",src:Bl,loading:"lazy","spinner-color":"red-4",alt:o.type.nom},{loading:(0,l.k6)((()=>[(0,l.bF)(d,{color:"red-4"})])),default:(0,l.k6)((()=>["Conditionnement"===o.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:0,icon:"fa-solid fa-prescription-bottle",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Principe actif"===o.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:1,icon:"fa-solid fa-pills",size:"3x",class:"icon-background hover-effect"})):(0,l.Q3)("",!0),"Cosmétique"===o.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:2,icon:"fa-solid fa-hand-holding-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Complément alimentaire"===o.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:3,icon:"fa-solid fa-glass-water-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Technique"===o.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:4,icon:"fa-solid fa-book-medical",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Alimentaire"===o.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:5,icon:"fa-solid fa-bottle-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Excipient"===o.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:6,icon:"fa-solid fa-flask",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:(0,g.C4)(["absolute-top hover-effect q-my-none",{"text-cyan-1":o.stockee,"text-red-4":!o.stockee}])},[(0,l.Lk)("div",null,(0,g.v_)(o.nom),1),(0,l.Lk)("div",null,(0,g.v_)(o.forme.nom)+" "+(0,g.v_)(o.qté_cdt)+(0,g.v_)(o.unite_cdt),1),(0,l.Lk)("div",null,[o.qté_stock<o.stock_mini?((0,l.uX)(),(0,l.Wv)(u,{key:0,icon:"fa-solid fa-triangle-exclamation","beat-fade":"",size:"fa-xs",style:{color:"#e57373"}})):(0,l.Q3)("",!0),(0,l.eW)(" Stock : "+(0,g.v_)(o.qté_stock)+(0,g.v_)(o.unite_mesure.nom),1)])],2)])),_:2},1032,["alt"]),(0,l.bF)(m,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((t=>e.toggleMenu(o.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(k,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[o.id],"onUpdate:modelValue":t=>e.showMenu[o.id]=t},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:"",onClick:(0,a.D$)((t=>e.toggleLivraison({matiereId:o.id,isLivraison:o.attente_livraison})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect-warning"},{default:(0,l.k6)((()=>[(0,l.eW)("Annuler commande")])),_:1})])),_:2},1032,["onClick"])),[[E]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:"",onClick:(0,a.D$)((e=>r.selectMatiere(o)),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect-success"},{default:(0,l.k6)((()=>[(0,l.eW)(" Réceptionner ")])),_:1})])),_:2},1032,["onClick"])),[[E]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",Vb,["Liste 1"===o.liste.nom?((0,l.uX)(),(0,l.CE)("div",Qb,"1")):(0,l.Q3)("",!0),"Liste 2"===o.liste.nom?((0,l.uX)(),(0,l.CE)("div",Mb,"2")):(0,l.Q3)("",!0),"Stupéfiant"===o.liste.nom?((0,l.uX)(),(0,l.CE)("div",Tb,"S")):(0,l.Q3)("",!0)]),(0,l.Lk)("div",Wb,[(0,l.Lk)("div",Db,[o.froid?((0,l.uX)(),(0,l.Wv)(u,{key:0,fade:"",icon:"fa-solid fa-snowflake",class:"q-ml-xs fa-2x",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),o.cmr?((0,l.uX)(),(0,l.Wv)(p,{key:1,class:"q-ml-xs fade-blink",src:ri,style:{width:"20px",height:"20px"}})):(0,l.Q3)("",!0)])]),(0,l.bF)(_,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"hover-effect",color:e.expanded[o.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((t=>e.toggleInfo(o.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.bF)(L,{modelValue:i.addMatiereStock,"onUpdate:modelValue":t[13]||(t[13]=e=>i.addMatiereStock=e)},{default:(0,l.k6)((()=>[(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)(v,null,{default:(0,l.k6)((()=>[Rb,Ub,(0,l.Lk)("div",Nb,(0,g.v_)(i.selectedMatiere.nom)+" "+(0,g.v_)(i.selectedMatiere.qté_cdt)+(0,g.v_)(i.selectedMatiere.unite_cdt)+" "+(0,g.v_)(i.selectedMatiere.fournisseur.name)+" ref:"+(0,g.v_)(i.selectedMatiere.code_fournisseur),1),Xb,Ob])),_:1}),(0,l.bF)(y),(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",jb,[(0,l.Lk)("div",$b,[(0,l.bF)(c,{modelValue:i.qte,"onUpdate:modelValue":t[5]||(t[5]=e=>i.qte=e),label:"Quantité",color:"cyan-4",class:"hover-effect"},null,8,["modelValue"])])]),(0,l.Lk)("div",Bb,[(0,l.Lk)("div",Hb,[(0,l.bF)(c,{label:"Lot",class:"hover-effect",color:"cyan-4",modelValue:i.lot,"onUpdate:modelValue":t[6]||(t[6]=e=>i.lot=e),onBlur:t[7]||(t[7]=e=>r.checkCertif(i.lot))},null,8,["modelValue"])]),(0,l.Lk)("div",zb,[(0,l.bF)(c,{label:"Peremption",type:"date",class:"hover-effect",color:"cyan-4",modelValue:i.peremption,"onUpdate:modelValue":t[8]||(t[8]=e=>i.peremption=e)},null,8,["modelValue"])])]),(0,l.Lk)("div",Gb,[i.certif?((0,l.uX)(),(0,l.CE)("div",Yb," Un certificat d'analyse correspondant à ce lot a été trouvé. ")):((0,l.uX)(),(0,l.CE)("div",Kb,[(0,l.bF)(F,{label:"Sélectionner un certificat(.pdf)",accept:".pdf",modelValue:i.certificat,"onUpdate:modelValue":t[9]||(t[9]=e=>i.certificat=e)},null,8,["modelValue"])]))]),i.certif?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",Jb,[(0,l.Lk)("div",Zb,[(0,l.bF)(w,{label:"Echantillon",color:"green-4",modelValue:i.echantillon,"onUpdate:modelValue":t[10]||(t[10]=e=>i.echantillon=e)},null,8,["modelValue"])]),(0,l.bo)((0,l.Lk)("div",eg,[(0,l.bF)(c,{label:"Quantité",color:"cyan-4",modelValue:i.qte_echantillon,"onUpdate:modelValue":t[11]||(t[11]=e=>i.qte_echantillon=e)},{append:(0,l.k6)((()=>[(0,l.Lk)("div",tg,(0,g.v_)(i.selectedMatiere.unite_mesure.nom),1)])),_:1},8,["modelValue"])],512),[[a.aG,i.echantillon]])]))])),_:1}),(0,l.bF)(y),(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",og,[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{flat:"",label:"Réceptionner",onClick:r.receptionner,color:"green-4"},null,8,["onClick"]),(0,l.bF)(m,{flat:"",label:"Annuler",onClick:t[12]||(t[12]=e=>i.addMatiereStock=!1),color:"red-4"})])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(k,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[o.id],"onUpdate:modelValue":t=>e.expanded[o.id]=t},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(h,{class:"justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Détails ")])),_:1})])),_:1}),o.fournisseur?((0,l.uX)(),(0,l.Wv)(h,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Fournisseur : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.fournisseur.name),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.code_fournisseur?((0,l.uX)(),(0,l.Wv)(h,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Ref : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.code_fournisseur),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.ean?((0,l.uX)(),(0,l.Wv)(h,{key:2},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" EAN/CIP : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.ean),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.tva?((0,l.uX)(),(0,l.Wv)(h,{key:3},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" TVA : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.tva)+"% ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.prix?((0,l.uX)(),(0,l.Wv)(h,{key:4},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prix : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.prix)+" € HT - "+(0,g.v_)(o.prix_ttc)+" € TTC ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.prix_unit?((0,l.uX)(),(0,l.Wv)(h,{key:5},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prix unitaire : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.prix_unit)+" €/"+(0,g.v_)(o.unite_mesure.nom)+" HT - "+(0,g.v_)(o.prix_unit_ttc)+" €/"+(0,g.v_)(o.unite_mesure.nom)+" TTC ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),o.stock_mini?((0,l.uX)(),(0,l.Wv)(h,{key:6},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Stock mini : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(o.stock_mini)+(0,g.v_)(o.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["class"])])))),128))])])])])])])),_:1})):((0,l.uX)(),(0,l.Wv)(A,{key:1,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ag,[(0,l.bF)(q,{class:"bg-op-8","animation-duration":1e3,size:200,color:"#ff1d5e"})])])),_:1}))}var sg={name:"MatieresCards",components:{FontAwesomeIcon:sn.gc,AtomSpinner:il.F},data(){return{searchQuery:"",addMatiereStock:!1,selectedMatiere:null,qte:"",lot:"",peremption:"",certificat:"",echantillon:!1,qte_echantillon:"",reception:[],certif:!1}},computed:{...(0,u.L8)("matieresPremieres",["allMatieres","allReceptions","expanded","showMenu"]),countMatieres(){return this.filteredMatieresLivraison.length},filteredMatieresLivraison(){return this.allMatieres.filter((e=>!0===e.attente_livraison))},filteredMatieres(){return this.searchQuery?this.filteredMatieresLivraison.filter((e=>e.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.filteredMatieresLivraison}},async created(){await this.loadMatieresPremieres()},methods:{...(0,u.i0)("matieresPremieres",["loadMatieresPremieres","loadReceptions","addReception","toggleLivraison","toggleInfo","toggleMenu"]),selectMatiere(e){this.selectedMatiere={...e},this.addMatiereStock=!0},async checkCertif(e){await this.loadReceptions;let t=this.allReceptions.find((t=>t.lot===e));this.reception=t,t&&!this.certificat?(this.certificat=this.reception.certificat,fetch(this.certificat).then((e=>e.blob())).then((e=>{this.certificat=e})),this.certif=!0):(this.certificat="",this.certif=!1)},async receptionner(){const e=new FormData;e.append("matiere",this.selectedMatiere.id),e.append("qte",this.qte),e.append("lot",this.lot),e.append("peremption",this.peremption),this.certificat?e.append("certificat",this.certificat,`${this.lot}.pdf`):e.append("certificat",this.certificat),e.append("echantillon",this.echantillon),e.append("qte_echantillon",this.qte_echantillon),await this.addReception(e),await this.loadMatieresPremieres(),this.selectedMatiere=null,this.qte="",this.lot="",this.peremption="",this.certificat="",this.echantillon=!1,this.qte_echantillon="",this.addMatiereStock=!1},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1}}};const ig=(0,m.A)(sg,[["render",lg]]);var rg=ig;E()(sg,"components",{QPage:Qe.A,QInput:Ae.A,QIcon:x.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A,QForm:xe.A,QDialog:we.A,QCardSection:Le.A,QSeparator:L.A,QFile:wu.A,QToggle:mr.A,QField:Qa.A}),E()(sg,"directives",{ClosePopup:A.A});const ng={class:"row justify-center"},cg={class:"col-md-12"},ug={class:"row q-mx-sm q-mt-sm"},dg={class:"col-6 offset-3 q-mt-md text-cyan-4 text-h6"},pg={class:"row justify-center"},mg={class:"col-2 offset-1"},fg={class:"row q-mt-sm"},hg={class:"col-12 justify-center"},bg={class:"row justify-start"},gg={class:"absolute-top-left q-ml-sm q-mt-xs"},kg={key:0,class:"text-red-4 text-subtitle2"},_g={key:1,class:"text-green-4 text-subtitle2"},vg={key:2,class:"text-red-4 text-subtitle2"},yg={class:"absolute-bottom-left"},Fg={class:"row q-mb-xs"},wg={class:"row justify-center"};function Cg(e,t,o,s,i,r){const n=(0,l.g2)("q-icon"),c=(0,l.g2)("q-input"),u=(0,l.g2)("font-awesome-icon"),d=(0,l.g2)("q-spinner-rings"),p=(0,l.g2)("q-img"),m=(0,l.g2)("q-btn"),f=(0,l.g2)("q-item-section"),h=(0,l.g2)("q-item"),b=(0,l.g2)("q-list"),k=(0,l.g2)("q-menu"),_=(0,l.g2)("q-btn-group"),v=(0,l.g2)("q-card"),y=(0,l.g2)("q-page"),F=(0,l.g2)("atom-spinner"),w=(0,l.gN)("close-popup");return e.loadMatieresPremieres?((0,l.uX)(),(0,l.Wv)(y,{key:0},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ng,[(0,l.Lk)("div",cg,[(0,l.Lk)("div",ug,[(0,l.Lk)("div",dg,[(0,l.Lk)("div",pg,(0,g.v_)(r.countMatieres)+" matières premières en attente de commande ",1)]),(0,l.Lk)("div",mg,[(0,l.bF)(c,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e),label:"Recherche...",onInput:r.filteredMatieres,color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("searchInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(n,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",fg,[(0,l.Lk)("div",hg,[(0,l.Lk)("div",bg,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredMatieres,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:t.id},[(0,l.bF)(v,{bordered:"",class:(0,g.C4)(["card-maxi justify-center items-center text-center relative",{"bd-red-4":!t.stockee}])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.bF)(p,{class:"logo-card-mini",src:Bl,loading:"lazy","spinner-color":"red-4",alt:t.type.nom},{loading:(0,l.k6)((()=>[(0,l.bF)(d,{color:"red-4"})])),default:(0,l.k6)((()=>["Conditionnement"===t.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:0,icon:"fa-solid fa-prescription-bottle",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Principe actif"===t.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:1,icon:"fa-solid fa-pills",size:"3x",class:"icon-background hover-effect"})):(0,l.Q3)("",!0),"Cosmétique"===t.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:2,icon:"fa-solid fa-hand-holding-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Complément alimentaire"===t.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:3,icon:"fa-solid fa-glass-water-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Technique"===t.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:4,icon:"fa-solid fa-book-medical",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Alimentaire"===t.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:5,icon:"fa-solid fa-bottle-droplet",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),"Excipient"===t.type.nom?((0,l.uX)(),(0,l.Wv)(u,{key:6,icon:"fa-solid fa-flask",size:"3x",class:"icon-background"})):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:(0,g.C4)(["absolute-top hover-effect q-my-none",{"text-cyan-1":t.stockee,"text-red-4":!t.stockee}])},[(0,l.Lk)("div",null,(0,g.v_)(t.nom),1),(0,l.Lk)("div",null,(0,g.v_)(t.forme.nom)+" "+(0,g.v_)(t.qté_cdt)+(0,g.v_)(t.unite_cdt),1),(0,l.Lk)("div",null,[t.qté_stock<t.stock_mini?((0,l.uX)(),(0,l.Wv)(u,{key:0,icon:"fa-solid fa-triangle-exclamation","beat-fade":"",size:"fa-xs",style:{color:"#e57373"}})):(0,l.Q3)("",!0),(0,l.eW)(" Stock : "+(0,g.v_)(t.qté_stock)+(0,g.v_)(t.unite_mesure.nom),1)])],2)])),_:2},1032,["alt"]),(0,l.bF)(m,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(k,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:"",onClick:(0,a.D$)((o=>e.toggleCde({matiereId:t.id,isCde:t.cde})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect-warning"},{default:(0,l.k6)((()=>[(0,l.eW)("Supprimer")])),_:1})])),_:2},1032,["onClick"])),[[w]]),(0,l.bo)(((0,l.uX)(),(0,l.Wv)(h,{clickable:"",onClick:(0,a.D$)((o=>e.toggleLivraison({matiereId:t.id,isLivraison:t.attente_livraison})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(f,{class:"hover-effect-success"},{default:(0,l.k6)((()=>[(0,l.eW)(" Valider commande ")])),_:1})])),_:2},1032,["onClick"])),[[w]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",gg,["Liste 1"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",kg,"1")):(0,l.Q3)("",!0),"Liste 2"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",_g,"2")):(0,l.Q3)("",!0),"Stupéfiant"===t.liste.nom?((0,l.uX)(),(0,l.CE)("div",vg,"S")):(0,l.Q3)("",!0)]),(0,l.Lk)("div",yg,[(0,l.Lk)("div",Fg,[t.froid?((0,l.uX)(),(0,l.Wv)(u,{key:0,fade:"",icon:"fa-solid fa-snowflake",class:"q-ml-xs fa-2x",style:{color:"#4dd0e1"}})):(0,l.Q3)("",!0),t.cmr?((0,l.uX)(),(0,l.Wv)(p,{key:1,class:"q-ml-xs fade-blink",src:ri,style:{width:"20px",height:"20px"}})):(0,l.Q3)("",!0)])]),(0,l.bF)(_,{class:"absolute-bottom-right"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"hover-effect",color:e.expanded[t.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((o=>e.toggleInfo(t.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(k,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[t.id],"onUpdate:modelValue":o=>e.expanded[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(b,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(h,{class:"justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Détails ")])),_:1})])),_:1}),t.fournisseur?((0,l.uX)(),(0,l.Wv)(h,{key:0},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Fournisseur : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.fournisseur.name),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.code_fournisseur?((0,l.uX)(),(0,l.Wv)(h,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Ref : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.code_fournisseur),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.ean?((0,l.uX)(),(0,l.Wv)(h,{key:2},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" EAN/CIP : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.ean),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.tva?((0,l.uX)(),(0,l.Wv)(h,{key:3},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" TVA : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.tva)+"% ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.prix?((0,l.uX)(),(0,l.Wv)(h,{key:4},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prix : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.prix)+" € HT - "+(0,g.v_)(t.prix_ttc)+" € TTC ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.prix_unit?((0,l.uX)(),(0,l.Wv)(h,{key:5},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Prix unitaire : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.prix_unit)+" €/"+(0,g.v_)(t.unite_mesure.nom)+" HT - "+(0,g.v_)(t.prix_unit_ttc)+" €/"+(0,g.v_)(t.unite_mesure.nom)+" TTC ",1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0),t.stock_mini?((0,l.uX)(),(0,l.Wv)(h,{key:6},{default:(0,l.k6)((()=>[(0,l.bF)(f,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Stock mini : ")])),_:1}),(0,l.bF)(f,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.stock_mini)+(0,g.v_)(t.unite_mesure.nom),1)])),_:2},1024)])),_:2},1024)):(0,l.Q3)("",!0)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["class"])])))),128))])])])])])])),_:1})):((0,l.uX)(),(0,l.Wv)(y,{key:1,class:"row items-center justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",wg,[(0,l.bF)(F,{class:"bg-op-8","animation-duration":1e3,size:200,color:"#ff1d5e"})])])),_:1}))}var Lg={name:"MatieresCards",components:{FontAwesomeIcon:sn.gc,AtomSpinner:il.F},data(){return{searchQuery:"",addMatiereStock:!1,selectedMatiere:null,qte:"",lot:"",peremption:"",certificat:""}},computed:{...(0,u.L8)("matieresPremieres",["allMatieres","expanded","showMenu"]),countMatieres(){return this.filteredMatieresCommande.length},filteredMatieresCommande(){return this.allMatieres.filter((e=>!0===e.cde))},filteredMatieres(){return this.searchQuery?this.filteredMatieresCommande.filter((e=>e.nom.toLowerCase().startsWith(this.searchQuery.toLowerCase()))):this.filteredMatieresCommande}},async created(){await this.loadMatieresPremieres()},methods:{...(0,u.i0)("matieresPremieres",["loadMatieresPremieres","toggleMenu","toggleCde","toggleLivraison","toggleInfo"]),selectMatiere(e){this.selectedMatiere={...e},this.addMatiereStock=!0},async receptionner(){const e={matiere:this.selectedMatiere.id,qte:this.qte,lot:this.lot,peremption:this.peremption,certificat:this.certificat};console.log("formData",e),await this.addReception(e),await this.loadMatieresPremieres(),this.selectedMatiere=null,this.qte="",this.lot="",this.peremption="",this.certificat="",this.addMatiereStock=!1},changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1}}};const xg=(0,m.A)(Lg,[["render",Cg]]);var Ag=xg;E()(Lg,"components",{QPage:Qe.A,QInput:Ae.A,QIcon:x.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A,QField:Qa.A}),E()(Lg,"directives",{ClosePopup:A.A});const qg={class:"row justify-center"},Eg={class:"col-md-12"},Ig={class:"row q-mx-sm q-mt-sm"},Pg={class:"col-3"},Sg={class:"row"},Vg={class:"col-6 q-mt-md text-cyan-4 text-h6"},Qg={class:"row justify-center"},Mg={class:"col-2 offset-1"},Tg={class:"row q-mt-sm"},Wg={class:"col-12 justify-center"},Dg={class:"row justify-start"},Rg={class:"card-content"};function Ug(e,t,o,s,i,r){const n=(0,l.g2)("q-tooltip"),c=(0,l.g2)("q-fab-action"),u=(0,l.g2)("router-link"),d=(0,l.g2)("q-fab"),p=(0,l.g2)("q-icon"),m=(0,l.g2)("q-input"),f=(0,l.g2)("font-awesome-icon"),h=(0,l.g2)("q-spinner-rings"),b=(0,l.g2)("q-img"),k=(0,l.g2)("q-btn"),_=(0,l.g2)("q-item-section"),v=(0,l.g2)("q-item"),y=(0,l.g2)("q-list"),F=(0,l.g2)("q-menu"),w=(0,l.g2)("q-btn-group"),C=(0,l.g2)("q-card"),L=(0,l.g2)("q-page"),x=(0,l.gN)("close-popup");return(0,l.uX)(),(0,l.Wv)(L,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",qg,[(0,l.Lk)("div",Eg,[(0,l.Lk)("div",Ig,[(0,l.Lk)("div",Pg,[(0,l.Lk)("div",Sg,[(0,l.bF)(d,{glossy:"",class:"glossy btn-cyan-pph",icon:"add_box",direction:"right"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{to:{name:"CreateAppareilsSupplier"}},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",color:"cyan-4",icon:"forklift",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,null,{default:(0,l.k6)((()=>[(0,l.eW)("Fournisseur")])),_:1})])),_:1})])),_:1}),(0,l.bF)(u,{to:{name:"CreateAppareils"}},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",color:"cyan-4",icon:"appareil",class:"hover-effect"},{default:(0,l.k6)((()=>[(0,l.bF)(n,null,{default:(0,l.k6)((()=>[(0,l.eW)("appareil")])),_:1})])),_:1})])),_:1})])),_:1})])]),(0,l.Lk)("div",Vg,[(0,l.Lk)("div",Qg,(0,g.v_)(r.countAppareils)+" appareils référencées ",1)]),(0,l.Lk)("div",Mg,[(0,l.bF)(m,{ref:"searchInput",modelValue:i.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchQuery=e),label:"Recherche...",onInput:e.filterAppareils,color:"cyan-4",onMouseover:t[1]||(t[1]=e=>r.changeLabelColor("searchInput","#ffb74d")),onMouseleave:t[2]||(t[2]=e=>r.changeLabelColor("searchInput","")),onFocus:t[3]||(t[3]=e=>r.onFocus("searchQuery","#4dd0e1")),onBlur:t[4]||(t[4]=e=>r.onBlur("searchQuery"))},{append:(0,l.k6)((()=>[(0,l.bF)(p,{name:"search",color:"cyan-4"})])),_:1},8,["modelValue","onInput"])])]),(0,l.Lk)("div",Tg,[(0,l.Lk)("div",Wg,[(0,l.Lk)("div",Dg,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(r.filteredAppareils,(t=>((0,l.uX)(),(0,l.CE)("div",{class:"col-2 q-pa-sm",key:t.id},[(0,l.bF)(C,{bordered:"",class:(0,g.C4)(["card-maxi justify-center items-center text-center relative",{"bd-red-4":!t.is_activate}]),onClick:(0,a.D$)((e=>r.redirectToLink(t.id)),["stop"])},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Rg,[(0,l.bF)(b,{class:"logo-card-mini",src:Bl,loading:"lazy","spinner-color":"red-4",alt:t.nom},{loading:(0,l.k6)((()=>[(0,l.bF)(h,{color:"red-4"})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",{class:(0,g.C4)(["absolute-top hover-effect q-my-none",{"text-cyan-1":t.is_activate,"text-red-4":!t.is_activate}])},[(0,l.Lk)("div",null,(0,g.v_)(t.nom),1),(0,l.Lk)("div",null,(0,g.v_)(t.modele),1),(0,l.Lk)("div",null,[new Date(t.prochaine)-new Date(t.calibration)<2592e6?((0,l.uX)(),(0,l.Wv)(f,{key:0,icon:"fa-solid fa-triangle-exclamation","beat-fade":"",size:"fa-xs",style:{color:"#e57373"}})):(0,l.Q3)("",!0),(0,l.eW)(" Prochaine calibration : ")]),(0,l.Lk)("div",null,(0,g.v_)(t.prochaineFormatted),1)],2)])),_:2},1032,["alt"]),(0,l.bF)(k,{flat:"",color:"white",class:"absolute-top-right hover-effect q-pa-none q-ma-none",icon:"more_vert",onClick:(0,a.D$)((o=>e.toggleMenu(t.id)),["stop"])},null,8,["onClick"]),(0,l.bF)(F,{fit:"",anchor:"top right",self:"bottom middle",modelValue:e.showMenu[t.id],"onUpdate:modelValue":o=>e.showMenu[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(y,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(v,{clickable:"",onClick:(0,a.D$)((o=>e.toggleActivation({appareilId:t.id,isActive:t.is_activate,appareilName:t.nom})),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(_,{class:(0,g.C4)({"hover-effect-warning":t.is_activate,"hover-effect-success":!t.is_activate})},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.is_activate?"Désactiver":"Activer"),1)])),_:2},1032,["class"])])),_:2},1032,["onClick"])),[[x]])])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),(0,l.bF)(w,{class:"absolute-bottom-right q-pa-none q-ma-none"},{default:(0,l.k6)((()=>[(0,l.bF)(k,{class:"hover-effect",color:e.expanded[t.id]?"orange-4":"cyan-4",round:"",flat:"",dense:"",icon:"info",size:"sm",onClick:(0,a.D$)((o=>e.toggleInfo(t.id)),["stop"])},null,8,["color","onClick"])])),_:2},1024),(0,l.bF)(F,{fit:"",anchor:"bottom right",self:"top middle",modelValue:e.expanded[t.id],"onUpdate:modelValue":o=>e.expanded[t.id]=o},{default:(0,l.k6)((()=>[(0,l.bF)(y,{style:{"min-width":"100px"}},{default:(0,l.k6)((()=>[(0,l.bF)(v,{class:"justify-center"},{default:(0,l.k6)((()=>[(0,l.bF)(_,{avatar:"",class:"text-cyan-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Détails ")])),_:1})])),_:1}),(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.bF)(_,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Fournisseur : ")])),_:1}),(0,l.bF)(_,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.fabricant.name),1)])),_:2},1024)])),_:2},1024),(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.bF)(_,{avatar:"",class:"text-orange-4"},{default:(0,l.k6)((()=>[(0,l.eW)(" Calibration : ")])),_:1}),(0,l.bF)(_,{class:"text-grey-7"},{default:(0,l.k6)((()=>[(0,l.eW)((0,g.v_)(t.calibration),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["class","onClick"])])))),128))])])])])])])),_:1})}var Ng={name:"MatieresCards",components:{FontAwesomeIcon:sn.gc},data(){return{searchQuery:"",appareilId:""}},computed:{...(0,u.L8)("appareils",["allAppareils","showMenu","expanded"]),countAppareils(){return Array.isArray(this.filteredAppareils)?this.filteredAppareils.length:0},filteredAppareils(){return Array.isArray(this.allAppareils)?this.searchQuery?this.allAppareils.filter((e=>e.nom.toLowerCase().includes(this.searchQuery.toLowerCase())&&e.fabricant.name.toLowerCase().includes(this.searchQuery.toLowerCase()))):this.allAppareils.map((e=>(e.prochaineFormatted=(0,Up.Yq)(new Date(e.prochaine)),e))):[]}},async created(){await this.loadAppareils(),console.log("allappareil",this.allAppareils)},methods:{...(0,u.i0)("appareils",["loadAppareils","toggleMenu","toggleInfo","toggleActivation"]),changeLabelColor(e,t){this[e.replace("Input","")]||(this.$refs[e].$el.querySelector(".q-field__label").style.color=t)},onFocus(e,t){this[`${e}Focused`]=!0,this.changeLabelColor(`${e}Input`,t)},onBlur(e){this[`${e}Focused`]=!1},redirectToLink(e){this.$router.push(`/modifier-appareils/${e}`)}}};const Xg=(0,m.A)(Ng,[["render",Ug]]);var Og=Xg;E()(Ng,"components",{QPage:Qe.A,QFab:fe.A,QFabAction:he.A,QTooltip:sr.A,QInput:Ae.A,QIcon:x.A,QCard:Ce.A,QImg:ns.A,QSpinnerRings:cs.A,QBtn:v.A,QMenu:y.A,QList:F.A,QItem:w.A,QItemSection:C.A,QBtnGroup:Y.A,QField:Qa.A}),E()(Ng,"directives",{ClosePopup:A.A});const jg={class:"q-pa-md"},$g={key:0,class:"text-h5 text-center text-cyan-4"},Bg={key:1,class:"text-h5 text-center text-cyan-4"},Hg={class:"row"},zg={class:"row"},Gg={class:"row"},Kg={class:"row"},Yg=(0,l.Lk)("div",{class:"text-cyan-4 q-pt-md text-subtitle2"},"mois",-1),Jg={class:"q-pa-md q-gutter-sm"},Zg={class:"row"},ek={class:"row"},tk={class:"col-12"},ok={class:"row justify-center"};function ak(e,t,o,a,s,i){const r=(0,l.g2)("q-icon"),n=(0,l.g2)("q-input"),c=(0,l.g2)("q-select"),u=(0,l.g2)("q-btn"),d=(0,l.g2)("q-stepper-navigation"),p=(0,l.g2)("q-step"),m=(0,l.g2)("q-toggle"),f=(0,l.g2)("InstructionsForm"),h=(0,l.g2)("q-btn-group"),b=(0,l.g2)("q-stepper");return(0,l.uX)(),(0,l.CE)("div",jg,[(0,l.bF)(b,{modelValue:s.step,"onUpdate:modelValue":t[25]||(t[25]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[s.appareilId?((0,l.uX)(),(0,l.CE)("div",$g,(0,g.v_)(s.appareil.nom),1)):((0,l.uX)(),(0,l.CE)("div",Bg,"Nouvelle Appareil")),(0,l.bF)(p,{name:1,title:"Identification",icon:"info",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Hg,[(0,l.bF)(n,{ref:"nomInput",class:"q-mr-lg col-3",modelValue:s.nom,"onUpdate:modelValue":t[0]||(t[0]=e=>s.nom=e),label:"Nom de l'appareil",color:"cyan-4",onMouseover:t[1]||(t[1]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[2]||(t[2]=t=>e.changeLabelColor("nameInput","")),onFocus:t[3]||(t[3]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[4]||(t[4]=t=>e.onBlur("name"))},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"branding_watermark",color:"cyan-4"})])),_:1},8,["modelValue"]),(0,l.bF)(n,{modelValue:s.modele,"onUpdate:modelValue":t[5]||(t[5]=e=>s.modele=e),color:"cyan-4",class:"col-3 hover-effect",label:"Modèle"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"computer",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",zg,[(0,l.bF)(c,{modelValue:s.fabricant,"onUpdate:modelValue":t[6]||(t[6]=e=>s.fabricant=e),color:"cyan-4",class:"col-2 q-mr-lg hover-effect",label:"Fabricant",options:s.suppliers,"option-label":"label","option-value":"id"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"forklift",color:"cyan-4"})])),_:1},8,["modelValue","options"]),(0,l.bF)(c,{modelValue:s.type,"onUpdate:modelValue":t[7]||(t[7]=e=>s.type=e),color:"cyan-4",class:"col-2 offset-1 hover-effect",label:"Type",options:s.types,"option-label":"nom","option-value":"id"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"devices",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[8]||(t[8]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(p,{name:2,title:"Calibration",icon:"calendar_month",done:s.step>2},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Gg,[(0,l.bF)(n,{ref:"dureeInput",type:"date",class:"my-0 col-2",modelValue:s.date_calibration,"onUpdate:modelValue":t[9]||(t[9]=e=>s.date_calibration=e),label:"Dernière calibration",color:"cyan-4",onMouseover:t[10]||(t[10]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[11]||(t[11]=t=>e.changeLabelColor("nameInput","")),onFocus:t[12]||(t[12]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[13]||(t[13]=t=>e.onBlur("name"))},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"alarm",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Kg,[(0,l.bF)(n,{ref:"dureeInput",class:"my-0 col-2",modelValue:s.duree_calibration,"onUpdate:modelValue":t[14]||(t[14]=e=>s.duree_calibration=e),label:"Validitée",color:"cyan-4",onMouseover:t[15]||(t[15]=t=>e.changeLabelColor("nameInput","#ffb74d")),onMouseleave:t[16]||(t[16]=t=>e.changeLabelColor("nameInput","")),onFocus:t[17]||(t[17]=t=>e.onFocus("name","#4dd0e1")),onBlur:t[18]||(t[18]=t=>e.onBlur("name"))},{append:(0,l.k6)((()=>[Yg])),prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"alarm",color:"cyan-4"})])),_:1},8,["modelValue"])]),(0,l.Lk)("div",Jg,[(0,l.Lk)("div",null,[(0,l.bF)(m,{modelValue:s.blocage_calibration,"onUpdate:modelValue":t[19]||(t[19]=e=>s.blocage_calibration=e),color:"green-4",icon:"stop",label:"Autoriser dépassement de date",size:"md"},null,8,["modelValue"])])]),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[20]||(t[20]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(u,{flat:"",onClick:t[21]||(t[21]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(p,{name:3,title:"Communication",icon:"device_hub",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Zg,[(0,l.bF)(c,{modelValue:s.com,"onUpdate:modelValue":t[22]||(t[22]=e=>s.com=e),color:"cyan-4",class:"col-2 hover-effect",label:"Communication",options:s.coms,"option-label":"nom","option-value":"id"},{prepend:(0,l.k6)((()=>[(0,l.bF)(r,{name:"gavel",color:"cyan-4"})])),_:1},8,["modelValue","options"])]),(0,l.Lk)("div",ek,[(0,l.Lk)("div",tk,[3===s.step?((0,l.uX)(),(0,l.Wv)(f,{key:0,newId:s.newId,appareilId:s.appareilId,instructions:s.instructions,reponses:s.reponses},null,8,["newId","appareilId","instructions","reponses"])):(0,l.Q3)("",!0)])]),(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:t[23]||(t[23]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect q-ml-sm"}),(0,l.bF)(u,{flat:"",onClick:t[24]||(t[24]=e=>s.step=4),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",ok,[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{flat:"",onClick:e.submitForm,color:"green-4",label:"Enregistrer",class:"btn-flat-success-pph"},null,8,["onClick"])])),_:1})])])),_:1},8,["modelValue"])])}const lk={class:"row"},sk={class:"col-12"},ik={class:"col-1 q-mr-md"},rk={class:"col-5 q-mr-md"},nk={class:"col-1 q-mr-md"},ck={class:"col-1"},uk={class:"col-2 q-mt-md q-ml-smm"},dk=(0,l.Lk)("div",{class:"row text-cyan-4 text-h6 justify-center"}," Réponses à l'instruction ",-1),pk={class:"row text-orange-4 text-subtitle1 justify-center"},mk={class:"row text-italic justify-center"},fk={class:"row justify-center"};function hk(e,t,o,s,i,r){const n=(0,l.g2)("q-input"),c=(0,l.g2)("q-toggle"),u=(0,l.g2)("q-tooltip"),d=(0,l.g2)("q-btn"),p=(0,l.g2)("q-btn-group"),m=(0,l.g2)("q-card-section"),f=(0,l.g2)("q-separator"),h=(0,l.g2)("q-card"),b=(0,l.g2)("q-dialog");return(0,l.uX)(),(0,l.CE)("div",lk,[(0,l.Lk)("div",sk,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.formRows,((e,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o,class:"row"},[(0,l.Lk)("div",ik,[(0,l.bF)(n,{modelValue:e.action,"onUpdate:modelValue":t=>e.action=t,color:"cyan-4",label:"Action"},null,8,["modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",rk,[(0,l.bF)(n,{modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,color:"cyan-4",label:"Description"},null,8,["modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",nk,[(0,l.bF)(n,{modelValue:e.nom,"onUpdate:modelValue":t=>e.nom=t,color:"cyan-4",label:"Nom"},null,8,["modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",ck,[(0,l.bF)(n,{modelValue:e.instruction,"onUpdate:modelValue":t=>e.instruction=t,color:"cyan-4",label:"Instruction"},null,8,["modelValue","onUpdate:modelValue"])]),(0,l.Lk)("div",uk,[(0,l.bF)(c,{modelValue:e.button,"onUpdate:modelValue":t=>e.button=t,color:"green-4",label:"Bouton"},null,8,["modelValue","onUpdate:modelValue"])]),(0,l.bF)(p,{flat:"",class:"q-mt-sm"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",size:"sm",icon:"compare_arrows",class:"hover-effect-success",color:"cyan-4",onClick:(0,a.D$)((t=>r.editReponse(e)),["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.eW)("Réponses")])),_:1})])),_:2},1032,["onClick"]),(0,l.bF)(d,{flat:"",size:"sm",onClick:t=>r.addInstructionState(e),icon:"check_circle",color:"green-4"},null,8,["onClick"]),(0,l.bF)(d,{flat:"",size:"sm",onClick:t=>r.removeRow(e),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024),(0,l.bF)(b,{modelValue:i.reponseDialog,"onUpdate:modelValue":t[2]||(t[2]=e=>i.reponseDialog=e),"full-width":""},{default:(0,l.k6)((()=>[(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[dk,(0,l.Lk)("div",pk,(0,g.v_)(i.currentRow.action)+" ("+(0,g.v_)(i.currentRow.nom)+") ",1),(0,l.Lk)("div",mk," ("+(0,g.v_)(i.currentRow.description)+") ",1)])),_:1}),(0,l.bF)(f),(0,l.bF)(m,null,{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.reponseRows,((t,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o,class:"row"},[(0,l.bF)(n,{class:"col-2 q-mr-md",color:"cyan-4",label:"Nom",modelValue:t.nom,"onUpdate:modelValue":e=>t.nom=e},null,8,["modelValue","onUpdate:modelValue"]),(0,l.bF)(n,{class:"col-3 q-mr-md",color:"cyan-4",label:"Format",modelValue:t.format,"onUpdate:modelValue":e=>t.format=e},null,8,["modelValue","onUpdate:modelValue"]),(0,l.bF)(n,{class:"col-3 q-mr-md",color:"cyan-4",label:"Message",modelValue:t.message,"onUpdate:modelValue":e=>t.message=e},null,8,["modelValue","onUpdate:modelValue"]),(0,l.bF)(c,{class:"col-2 q-pt-sm",color:"red-4",modelValue:t.erreur,"onUpdate:modelValue":e=>t.erreur=e,icon:"error",label:"Erreur"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.bF)(p,{flat:"",class:"q-pa-xs"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{flat:"",size:"sm",onClick:t=>r.addInstructionState(e),icon:"check_circle",color:"green-4"},null,8,["onClick"]),(0,l.bF)(d,{flat:"",size:"sm",onClick:t=>r.removeRow(e),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])))),128))])),_:2},1024),(0,l.bF)(f),(0,l.Lk)("div",fk,[(0,l.bF)(d,{flat:"",label:"Valider",color:"green-4",onClick:t[0]||(t[0]=e=>i.reponseDialog=!1)}),(0,l.bF)(d,{flat:"",label:"Annuler",color:"red-4",onClick:t[1]||(t[1]=e=>i.reponseDialog=!1)})])])),_:2},1024)])),_:2},1032,["modelValue"])])))),128))])])}var bk={props:["newId","appareilId","instructions","reponses"],data(){return{currentRow:null,reponseDialog:!1,formRows:[{num_appareil:null,instructionId:null,nom:null,action:null,instruction:null,description:null,reponse:null,button:!1}],reponseRows:[{num_instruction:null,reponseId:null,nom:null,format:null,message:null,erreur:!1}]}},computed:{...(0,u.L8)("appareils",["allAppareils","allInstructionsAppareils"])},async created(){console.log("instructions",this.instructions),console.log("reponses",this.reponses),this.loadLastId(),this.fetchInstructionsAndAddRow(),this.appareilId&&(this.formRows=this.instructions.filter((e=>e.modele_appareil===this.appareilId)).map((e=>({num_appareil:e.modele_appareil,instructionId:e.id,instruction:e.instruction,nom:e.nom,action:e.action,description:e.description,reponse:e.format_reponse,button:e.button}))),this.addRow())},methods:{...(0,u.i0)("appareils",["loadAppareils","loadInstructionsAppareils","loadReponses"]),...(0,u.PY)("appareils",["ADD_INSTRUCTION","REMOVE_INSTRUCTION"]),async editReponse(e){if(e.instructionId)try{this.currentRow=e,this.reponseRows=this.reponses.filter((t=>t.num_instruction===e.instructionId)).map((e=>({num_instruction:e.num_instruction,reponseId:e.id,nom:e.nom,format:e.format,message:e.message,erreur:e.erreur}))),this.addReponseRow(e.instructionId)}catch(t){console.error("Erreur lors de la récupération des instructions",t)}this.reponseDialog=!0},async fetchInstructionsAndAddRow(){if(!this.appareilId)try{const e=await this.getInstructions();e.length>0&&(this.formRows=e.map((e=>({num_appareil:e.modele_appareil,instructionId:e.id,instruction:e.instruction,nom:e.nom,action:e.action,description:e.description,reponse:e.format_reponse,button:e.button}))),this.addRow())}catch(e){console.error("Erreur lors de la récupération des instructions",e)}},async getInstructions(){const e=this.newId;return this.instructions.filter((t=>t.modele_appareil===e))},async loadLastId(){try{this.formRows[0].num_appareil=this.newId,console.log("NewId",this.newId)}catch(e){console.error("Erreur lors de la récupération du dernier ID de la formule",e)}},async addRow(){try{this.appareilId?this.formRows.push({num_appareil:this.appareilId,instructionId:null,nom:null,action:null,instruction:null,description:null,reponse:null,button:!1}):this.formRows.push({num_appareil:this.newId,instructionId:null,nom:null,action:null,instruction:null,description:null,reponse:null,button:!1})}catch(e){console.error("Erreur lors de la récupération du dernier ID du modèle Formule",e)}},async addReponseRow(e){try{this.reponseRows.push({num_instruction:e,reponseId:null,nom:null,format:null,message:null,erreur:!1})}catch(t){console.error("Erreur lors de la récupération du dernier ID du modèle Formule",t)}},addInstructionState(e){this.ADD_INSTRUCTION({num_appareil:this.appareilId,instructionId:null,nom:null,action:null,instruction:null,description:null,reponse:null,button:!1}),this.formRows.indexOf(e)===this.formRows.length-1&&this.addRow()},removeRow(e){this.REMOVE_INSTRUCTION({num_appareil:e.num_appareil,instructionId:e.instructionId});const t=this.formRows.indexOf(e);this.formRows.splice(t,1)}}};const gk=(0,m.A)(bk,[["render",hk]]);var kk=gk;E()(bk,"components",{QInput:Ae.A,QToggle:mr.A,QBtnGroup:Y.A,QBtn:v.A,QTooltip:sr.A,QDialog:we.A,QCard:Ce.A,QCardSection:Le.A,QSeparator:L.A});var _k={components:{InstructionsForm:kk},data(){return{step:1,newId:"",appareilId:"",type:"",nom:"",modele:"",fabricant:"",date_calibration:"",duree_calibration:"",blocage_calibration:!1,appareil:[],types:[],com:"",coms:[],instructions:[],suppliers:[],reponses:[]}},computed:{...(0,u.L8)("suppliers",["allSuppliers"]),...(0,u.L8)("appareils",["allAppareils","allTypes","allComs","allInstructionsAppareils","allReponses"])},async created(){await this.loadSuppliersAppareils(),await this.loadAppareils(),await this.loadCom(),await this.loadTypesAppareils(),this.types=this.allTypes,this.coms=this.allComs,this.suppliers=this.allSuppliers,this.$route.params.id&&(this.appareilId=Number(this.$route.params.id),await this.loadInstructionsAppareils(),await this.loadReponses(),this.instructions=this.allInstructionsAppareils.filter((e=>e.modele_appareil===this.appareilId)),this.reponses=this.instructions.map((e=>this.allReponses.filter((t=>t.num_instruction===e.id)))),this.reponses=this.reponses.flat(),this.appareil=this.allAppareils.find((e=>e.id===this.appareilId)),this.nom=this.appareil.nom,this.modele=this.appareil.modele,this.fabricant=this.appareil.fabricant.name,this.date_calibration=this.appareil.calibration,this.duree_calibration=this.appareil.duree_calibration,this.blocage_calibration=this.appareil.bloque_calibration,this.type=this.appareil.type.nom,this.com=this.appareil.com.nom),this.newId=this.allAppareils.length},methods:{...(0,u.i0)("suppliers",["loadSuppliersAppareils"]),...(0,u.i0)("appareils",["addAppareil","loadAppareils","loadTypesAppareils","loadCom","loadInstructionsAppareils","loadReponses"]),addAppareil(){const e={nom:this.nom,modele:this.modele,fabricant:this.fabricant,calibration:this.calibration,duree_calibration:this.duree_calibration,blocage_calibration:this.blocage_calibration,type:this.type,com:this.com};this.addAppareil(e)}}};const vk=(0,m.A)(_k,[["render",ak]]);var yk=vk;E()(_k,"components",{QStepper:Nl.A,QStep:Xl.A,QInput:Ae.A,QIcon:x.A,QSelect:Fs.A,QStepperNavigation:Ol.A,QBtn:v.A,QToggle:mr.A,QBtnGroup:Y.A});const Fk={class:"col-8"},wk=(0,l.Lk)("div",{class:"row text-purple-4 text-h6 justify-center"},[(0,l.Lk)("div",{class:"q-mt-sm"},"Assistant V-PPH")],-1),Ck=(0,l.Lk)("div",{class:"row text-orange-4 text-subtitle2 text-italic justify-center"},[(0,l.Lk)("div",null,"Ne remplace pas une publication ou l'expertise d'un professionnel")],-1),Lk={class:"row justify-center"},xk={key:0,class:"row justify-center q-mt-xl q-pt-xl"},Ak={class:"text-purple-4 text-subtitle2"},qk={class:"q-mb-xs"};function Ek(e,t,o,s,i,r){const n=(0,l.g2)("q-btn"),c=(0,l.g2)("q-input"),u=(0,l.g2)("atom-spinner"),d=(0,l.g2)("q-tooltip"),p=(0,l.g2)("q-card-section"),m=(0,l.g2)("q-scroll-area"),f=(0,l.g2)("q-card"),h=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(h,{class:"row justify-center"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Fk,[wk,Ck,(0,l.Lk)("div",Lk,[(0,l.bF)(c,{class:"col-8",modelValue:i.question,"onUpdate:modelValue":t[0]||(t[0]=e=>i.question=e),label:"Posez votre question ici...",onKeyup:(0,a.jR)(r.demande,["enter"])},{append:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"",class:"hover-effect-success",color:"purple-4",size:"md",icon:"send",onClick:r.demande},null,8,["onClick"])])),_:1},8,["modelValue","onKeyup"])]),i.ask&&!e.response?((0,l.uX)(),(0,l.CE)("div",xk,[(0,l.bF)(u,{class:"bg-op-8","animation-duration":1e3,size:70,color:"#ff1d5e"})])):(0,l.Q3)("",!0),e.response?((0,l.uX)(),(0,l.Wv)(f,{key:1,class:"q-mt-md bg-op-8"},{default:(0,l.k6)((()=>[(0,l.bF)(m,{"thumb-style":i.thumbStyle,"bar-style":i.barStyle,style:{height:"350px"}},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(n,{flat:"",icon:"restart_alt",color:"purple-4",class:"hover-effect absolute-top-right q-mt-sm",onClick:(0,a.D$)(r.newGpt,["stop"])},{default:(0,l.k6)((()=>[(0,l.bF)(d,{class:"bg-blue-grey-4"},{default:(0,l.k6)((()=>[(0,l.eW)("Nouvelle conversation")])),_:1})])),_:1},8,["onClick"]),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(i.conversationHistory,((t,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o},[(0,l.Lk)("div",Ak,(0,g.v_)("user"===t.role?e.user.firstName:"V-PPH")+":",1),(0,l.Lk)("div",qk,(0,g.v_)(t.content),1)])))),128))])),_:1})])),_:1},8,["thumb-style","bar-style"])])),_:1})):(0,l.Q3)("",!0)])])),_:1})}var Ik={components:{AtomSpinner:il.F},data(){return{thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#027be3",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#027be3",width:"9px",opacity:.2},question:"",ask:!1,conversationHistory:[]}},computed:{...(0,u.aH)("auth",["user"]),...(0,u.L8)("chatGPT",["allHistory"]),...(0,u.aH)("chatGPT",["response","history"])},async created(){this.newChat()},methods:{...(0,u.i0)("chatGPT",["askQuestion","newChat","getHistory"]),...(0,u.PY)("chatGPT",["deleteResponse"]),async demande(){if(this.question.trim()){this.ask=!0;const e={message:this.question.trim()};await this.askQuestion(e),console.log(e),await this.getHistory(),this.conversationHistory=this.allHistory.conversation_history.slice().reverse(),this.question="",this.ask=!1}},newGpt(){this.newChat(),this.question="",this.deleteResponse(),this.ask=!1,this.conversationHistory=[]}}};const Pk=(0,m.A)(Ik,[["render",Ek]]);var Sk=Pk;E()(Ik,"components",{QPage:Qe.A,QInput:Ae.A,QBtn:v.A,QCard:Ce.A,QScrollArea:nr.A,QCardSection:Le.A,QTooltip:sr.A});const Vk={clas:"q-pa-md"},Qk={class:"row"},Mk={class:"row"},Tk={class:"row justify-center"};function Wk(e,t,o,a,s,i){const r=(0,l.g2)("q-input"),n=(0,l.g2)("q-item-section"),c=(0,l.g2)("q-btn"),u=(0,l.g2)("q-item"),d=(0,l.g2)("q-list"),p=(0,l.g2)("q-stepper-navigation"),m=(0,l.g2)("q-step"),f=(0,l.g2)("q-btn-group"),h=(0,l.g2)("q-stepper"),b=(0,l.g2)("q-page");return(0,l.uX)(),(0,l.Wv)(b,null,{default:(0,l.k6)((()=>[(0,l.Lk)("div",Vk,[(0,l.bF)(h,{modelValue:s.step,"onUpdate:modelValue":t[6]||(t[6]=e=>s.step=e),class:"bg-op-8",vertical:"","done-color":"cyan-4","active-color":"orange-4","header-nav":"",animated:""},{default:(0,l.k6)((()=>[(0,l.bF)(m,{name:1,title:"Profils",icon:"person",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Qk,[(0,l.bF)(d,{class:"col-8"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.profils,((e,t)=>((0,l.uX)(),(0,l.Wv)(u,{key:t,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"col-4"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{label:"Nom",modelValue:e.nom,"onUpdate:modelValue":t=>e.nom=t,color:"cyan-4",class:"hover-effect"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(n,{class:"col-6"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{autogrow:"",label:"Description",modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,color:"cyan-4",class:"hover-effect"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(n,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",size:"md",onClick:e=>i.removeLine(t),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,l.bF)(c,{flat:"",size:"md",onClick:i.addLine,icon:"add_box",color:"cyan-4",class:"hover-effect",label:"Ajouter"},null,8,["onClick"]),s.profils.length>0?((0,l.uX)(),(0,l.Wv)(c,{key:0,flat:"",size:"md",onClick:i.validProfils,icon:"check_circle",color:"green-4",label:"Valider"},null,8,["onClick"])):(0,l.Q3)("",!0)]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[0]||(t[0]=e=>s.step=2),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:2,title:"Compétences",icon:"person",done:s.step>1},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Mk,[(0,l.bF)(d,{class:"col-8"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.competences,((e,t)=>((0,l.uX)(),(0,l.Wv)(u,{key:t,class:"row"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{class:"col-4"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{label:"Nom",modelValue:e.nom,"onUpdate:modelValue":t=>e.nom=t,color:"cyan-4",class:"hover-effect"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(n,{class:"col-6"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{autogrow:"",label:"Description",modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,color:"cyan-4",class:"hover-effect"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.bF)(n,{side:""},{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",size:"md",onClick:e=>i.removeLineCompetences(t),icon:"delete_forever",color:"red-4"},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,l.bF)(c,{flat:"",size:"md",onClick:i.addLineCompetences,icon:"add_box",color:"cyan-4",class:"hover-effect",label:"Ajouter"},null,8,["onClick"])]),(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[1]||(t[1]=e=>s.step=1),color:"cyan-4",label:"Précédent",class:"hover-effect"}),(0,l.bF)(c,{flat:"",onClick:t[2]||(t[2]=e=>s.step=3),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:3,title:"Situations",icon:"person",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[3]||(t[3]=e=>s.step=2),color:"cyan-4",label:"Précédent",class:"hover-effect"}),(0,l.bF)(c,{flat:"",onClick:t[4]||(t[4]=e=>s.step=4),color:"cyan-4",label:"Suivant",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.bF)(m,{name:4,title:"Personnas",icon:"person",done:s.step>3},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:t[5]||(t[5]=e=>s.step=5),color:"cyan-4",label:"Terminer",class:"hover-effect"})])),_:1})])),_:1},8,["done"]),(0,l.Lk)("div",Tk,[(0,l.bF)(f,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{flat:"",onClick:i.postVpph,color:"green-4",label:"Enregistrer",class:"btn-flat-success-pph"},null,8,["onClick"]),(0,l.bF)(c,{flat:"",color:"red-4",label:"Supprimer",class:"btn-flat-danger-pph"})])),_:1})])])),_:1},8,["modelValue"])])])),_:1})}var Dk={data(){return{step:1,vpph:[],profils:[],competences:[],situations:[],personnas:[]}},computed:{...(0,u.aH)("chatGPT",["profil"]),...(0,u.L8)("chatGPT",["allProfils","getVpph"])},created(){this.loadVpph(),this.vpph=this.getVpph,console.log("vpphload",this.getVpph);const e=this.vpph.find((e=>1===e.id));this.profils=e.profil,console.log("profils",this.profils)},methods:{...(0,u.i0)("chatGPT",["ajouterProfil","modifierProfil","loadVpph","saveVpph"]),addLine(){this.profils.push({nom:"",description:""})},removeLine(e){this.profils.splice(e,1)},addLineCompetences(){this.competences.push({nom:"",description:""})},removeLineCompetences(e){this.competences.splice(e,1)},validProfils(){this.profils.forEach((e=>{const t=this.allProfils.find((t=>t.nom===e.nom));t?(this.modifierProfil({index:this.allProfils.indexOf(t),profil:e}),console.log("profilModif",e)):(this.ajouterProfil(e),console.log("profilAjout",e))})),console.log("profils",this.allProfils)},postVpph(){const e={profil:this.profils,competences:this.competences};console.log("vpph",e),console.log("getvpph",this.getVpph);const t=1;this.saveVpph({id:t,formData:e})}}};const Rk=(0,m.A)(Dk,[["render",Wk]]);var Uk=Rk;E()(Dk,"components",{QPage:Qe.A,QStepper:Nl.A,QStep:Xl.A,QList:F.A,QItem:w.A,QItemSection:C.A,QInput:Ae.A,QBtn:v.A,QStepperNavigation:Ol.A,QBtnGroup:Y.A});const Nk=[{path:"/cgu/",name:"CdtGalUtl",component:oi},{path:"/mentions/",name:"MentionsLegales",component:js},{path:"/home/",name:"Home",component:br,beforeEnter:async(e,t,o)=>{await ca.dispatch("auth/checkAuthentication"),ca.state.auth.isLoggedIn?o():(await ca.dispatch("notifications/showNotification",{message:"Vous devez vous connecter pour accéder à cette page !",type:"info"},{root:!0}),o("/login"))}},{path:"/register",name:"Register",component:Ra,beforeEnter:async(e,t,o)=>{await ca.dispatch("auth/checkAuthentication"),ca.state.auth.isLoggedIn?(await ca.dispatch("notifications/showNotification",{message:"Vous devez vous déconnecter pour accéder à cette page !",type:"info"},{root:!0}),o("/home")):o()}},{path:"/login",name:"Login",component:cl,beforeEnter:async(e,t,o)=>{await ca.dispatch("auth/checkAuthentication"),ca.state.auth.isLoggedIn?(await ca.dispatch("notifications/showNotification",{message:"Vous devez vous déconnecter pour accéder à cette page !",type:"info"},{root:!0}),o("/home")):o()}},{path:"/password-reset",name:"PasswordReset",component:El,beforeEnter:async(e,t,o)=>{await ca.dispatch("auth/checkAuthentication"),ca.state.auth.isLoggedIn?(await ca.dispatch("notifications/showNotification",{message:"Vous devez vous déconnecter pour accéder à cette page !",type:"info"},{root:!0}),o("/home")):o()}},{path:"/user/:id",name:"UserAccount",component:Cs},{path:"/user",name:"User",component:Cs},{path:"/user/:id",name:"User",component:Cs,props:!0},{path:"/users",name:"UsersCards",component:Ws},{path:"/supplier",name:"CreateSupplier",component:$l},{path:"/supplier/:id",component:$l,name:"supplier-form",props:!0},{path:"/suppliers",name:"SuppliersCards",component:ds},{path:"/matieres-premieres",name:"MatieresCards",component:cn},{path:"/materiel",name:"MaterielCards",component:ec},{path:"/catalogue",name:"MatieresCatalogueCards",component:xu},{path:"/nouvelle-formule",name:"CreateFormula",component:$d},{path:"/nouvelle-formule/:id",name:"UpdateFormula",component:$d,props:!0},{path:"/formules",name:"FormulaCards",component:Hh},{path:"/demande",name:"CreateDemande",component:Yf},{path:"/demandes",name:"DemandesCards",component:Ch},{path:"/fiches",name:"CreateFiche",component:dp},{path:"/fiches/:demandeId",name:"GenerateFiche",component:jp,props:!0},{path:"/fiche/:ficheId",name:"CompoFiche",component:jp,props:!0},{path:"/fiche/:id",name:"details-fiche",component:jp,props:!0},{path:"/controles",name:"ControlesCards",component:cm},{path:"/controles/:id",name:"updateControles",component:rf,props:!0},{path:"/controles",name:"CreateControles",component:rf,props:!0},{path:"/controle-fiche",name:"ControleFiche",component:zm,props:!0},{path:"/archives",name:"FichesArchivesCards",component:xf},{path:"/creation-matiere-premiere",name:"CreateMatiere",component:wb},{path:"/reception",name:"MatieresCardsReception",component:rg},{path:"/commande",name:"MatieresCardsCommande",component:Ag},{path:"/appareils",name:"AppareilsCards",component:Og},{path:"/suppliers/appareils",name:"CreateAppareilsSupplier",component:$l},{path:"/creer-appareils",name:"CreateAppareils",component:yk,props:!0},{path:"/modifier-appareils/:id",name:"updateAppareil",component:yk,props:!0},{path:"/gpt4-api",name:"chatGpt",component:Sk,props:!0},{path:"/vpph-settings",name:"settingsAI",component:Uk,props:!0}],Xk=(0,We.aE)({history:(0,We.LA)("/"),routes:Nk});var Ok=Xk,jk=o(1519),$k=o(2279),Bk=o.n($k),Hk=o(7999),zk={plugins:{Loading:Hk.A,Notify:lt.A},config:{loading:{spinner:cs.A,spinnerColor:"red"}},lang:Bk()},Gk=o(7107),Kk=o(6188),Yk=o(1278);(0,Yk.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),Gk.Yv.add(Kk.urI,Kk.sv0,Kk.SJK,Kk.rIc,Kk.Qz3,Kk.$UM,Kk.bMI,Kk.cIb,Kk.W93,Kk.z4C,Kk.jHn,Kk.unW,Kk.qkc,Kk.Wkq,Kk.JAe,Kk.$3n,Kk.woZ);const Jk=(0,a.Ef)(Te).use(jk.A,zk).use(Ok).use(ca);function Zk(e){let t=null;if(document.cookie&&""!==document.cookie){let o=document.cookie.split(";");for(let a=0;a<o.length;a++){let l=o[a].trim();if(l.substring(0,e.length+1)===e+"="){t=decodeURIComponent(l.substring(e.length+1));break}}}return t}Jk.component("font-awesome-icon",sn.gc),Jk.config.errorHandler=(e,t,o)=>{console.log("Captured in app.config.errorHandler: ",e,t,o)},Jk.mount("#app");let e_=Zk("csrftoken");De.A.defaults.xsrfCookieName="csrftoken",De.A.defaults.xsrfHeaderName="X-CSRFTOKEN",De.A.defaults.headers.post["X-CSRFToken"]=e_},3949:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function getCalculatedQty(formula,params,qte,unitMeasureString){for(let t of params){let e=t.parametre.nom+" - "+t.parametre.unite;formula=formula.replace(new RegExp(e,"g"),t.valeur_parametre);let o="Quantité - "+unitMeasureString;formula=formula.replace(new RegExp(o,"g"),qte)}try{let result=eval(formula);return isNaN(result)?result:Number(result).toFixed(2)}catch(e){return"Erreur"}}function toInteger(e){return e%1===0?Number.parseInt(e,10):e}function formatDate(e){var t=String(e.getDate()).padStart(2,"0"),o=String(e.getMonth()+1).padStart(2,"0"),a=e.getFullYear();return t+"/"+o+"/"+a}__webpack_require__.d(__webpack_exports__,{Yq:function(){return formatDate},lE:function(){return getCalculatedQty}})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.m=__webpack_modules__,function(){var e=[];__webpack_require__.O=function(t,o,a,l){if(!o){var s=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],l=e[c][2];for(var i=!0,r=0;r<o.length;r++)(!1&l||s>=l)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](o[r])}))?o.splice(r--,1):(i=!1,l<s&&(s=l));if(i){e.splice(c--,1);var n=a();void 0!==n&&(t=n)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[o,a,l]}}(),function(){__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return __webpack_require__.d(t,{a:t}),t}}(),function(){__webpack_require__.d=function(e,t){for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){__webpack_require__.p="/"}(),function(){var e={524:0};__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,l,s=o[0],i=o[1],r=o[2],n=0;if(s.some((function(t){return 0!==e[t]}))){for(a in i)__webpack_require__.o(i,a)&&(__webpack_require__.m[a]=i[a]);if(r)var c=r(__webpack_require__)}for(t&&t(o);n<s.length;n++)l=s[n],__webpack_require__.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return __webpack_require__.O(c)},o=self["webpackChunkPPH"]=self["webpackChunkPPH"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var __webpack_exports__=__webpack_require__.O(void 0,[504],(function(){return __webpack_require__(8094)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=app.fbe0e872.js.map